import { genHues } from './hues.js';
import { limits } from './limits.js';
import { convert } from './conversion-index.js';
import { genAllColorValues } from '../utils/conversion-utils.js';
import { config } from '../config/constants.js';
import { defaults } from '../config/defaults.js';
import { database } from '../database/database.js';
import { colorUtils } from '../utils/color-utils.js';
import { core } from '../utils/core-utils.js';
import { paletteUtils } from '../utils/palette-utils.js';
import { randomHSL, randomSL } from '../utils/random-color-utils.js';
export async function genPalette() {
    function createPaletteItem(color, enableAlpha) {
        const clonedColor = core.clone(color);
        clonedColor.value.alpha = enableAlpha ? Math.random() : 1;
        return {
            id: `${color.format}_${database.getNextPaletteID()}`,
            colors: {
                cmyk: convert.hslToCMYK(clonedColor).value,
                hex: convert.hslToHex(clonedColor).value,
                hsl: clonedColor.value,
                hsv: convert.hslToHSV(clonedColor).value,
                lab: convert.hslToLAB(clonedColor).value,
                rgb: convert.hslToRGB(clonedColor).value,
                xyz: convert.hslToXYZ(clonedColor).value
            },
            colorStrings: {
                cmykString: colorUtils.colorToColorString(convert.hslToCMYK(clonedColor)).value,
                hexString: colorUtils.colorToColorString(convert.hslToHex(clonedColor)).value,
                hslString: colorUtils.colorToColorString(clonedColor).value,
                hsvString: colorUtils.colorToColorString(convert.hslToHSV(clonedColor)).value,
                labString: colorUtils.colorToColorString(convert.hslToLAB(clonedColor)).value,
                rgbString: colorUtils.colorToColorString(convert.hslToRGB(clonedColor)).value,
                xyzString: colorUtils.colorToColorString(convert.hslToXYZ(clonedColor)).value
            },
            cssStrings: {
                cmykCSSString: colorUtils.getCSSColorString(convert.hslToCMYK(clonedColor)),
                hexCSSString: convert.hslToHex(clonedColor).value.hex,
                hslCSSString: colorUtils.getCSSColorString(clonedColor),
                hsvCSSString: colorUtils.getCSSColorString(convert.hslToHSV(clonedColor)),
                labCSSString: colorUtils.getCSSColorString(convert.hslToLAB(clonedColor)),
                rgbCSSString: colorUtils.getCSSColorString(convert.hslToRGB(clonedColor)),
                xyzCSSString: colorUtils.getCSSColorString(convert.hslToXYZ(clonedColor))
            }
        };
    }
    function generatePaletteItems(baseColor, hues, enableAlpha, limitDark, limitGray, limitBright) {
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha)
        ];
        hues.forEach((hue, i) => {
            let newColor = null;
            do {
                const sl = randomSL(enableAlpha);
                newColor = genAllColorValues({
                    value: { hue, ...sl.value },
                    format: 'hsl'
                }).hsl;
            } while (newColor &&
                ((limitGray && limits.isTooGray(newColor)) ||
                    (limitDark && limits.isTooDark(newColor)) ||
                    (limitBright && limits.isTooBright(newColor))));
            if (newColor) {
                paletteItems.push(createPaletteItem(newColor, enableAlpha));
                updateColorBox(newColor, i + 1);
            }
        });
        return paletteItems;
    }
    function getBaseColor(customColor, enableAlpha) {
        const color = core.clone(customColor ?? randomHSL(enableAlpha));
        return color;
    }
    function updateColorBox(color, index) {
        const colorBox = document.getElementById(`color-box-${index + 1}`);
        if (colorBox) {
            const colorValues = genAllColorValues(color);
            const selectedColor = colorValues;
            if (selectedColor) {
                const hslColor = colorValues.hsl;
                const hslCSSString = colorUtils.getCSSColorString(hslColor);
                colorBox.style.backgroundColor = hslCSSString;
                paletteUtils.populateColorTextOutputBox(selectedColor, index + 1);
            }
        }
    }
    async function analogous(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentAnalogousPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 2) {
            console.warn('Analogous palette requires at least 2 swatches.');
            return paletteUtils.createPaletteObject('analogous', [], defaults.hsl, 0, currentAnalogousPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const hues = genHues.analogous(baseColor, numBoxes);
        const paletteItems = hues.map((hue, i) => {
            const newColor = {
                value: {
                    hue,
                    saturation: Math.min(100, Math.max(0, baseColor.value.saturation +
                        (Math.random() - 0.5) * 10)),
                    lightness: Math.min(100, Math.max(0, baseColor.value.lightness + (i % 2 === 0 ? 5 : -5))),
                    alpha: enableAlpha ? Math.random() : 1
                },
                format: 'hsl'
            };
            return createPaletteItem(newColor, enableAlpha);
        });
        return await database.savePaletteToDB('analogous', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function complementary(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentComplementaryPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 2) {
            console.warn('Complementary palette requires at least 2 swatches.');
            return paletteUtils.createPaletteObject('complementary', [], defaults.hsl, 0, currentComplementaryPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const complementaryHue = (baseColor.value.hue + 180) % 360;
        const hues = Array.from({ length: numBoxes - 1 }, (_, _i) => (complementaryHue +
            (Math.random() * config.complementaryHueShiftRange -
                config.complementaryHueShiftRange / 2)) %
            360);
        const paletteItems = hues.map((hue, i) => {
            const saturation = Math.min(100, Math.max(0, baseColor.value.saturation + (Math.random() - 0.5) * 15));
            const lightness = Math.min(100, Math.max(0, baseColor.value.lightness + (i % 2 === 0 ? -10 : 10)));
            const alpha = enableAlpha ? Math.random() : 1;
            const newColor = {
                value: { hue, saturation, lightness, alpha },
                format: 'hsl'
            };
            return createPaletteItem(newColor, enableAlpha);
        });
        paletteItems.unshift(createPaletteItem(baseColor, enableAlpha));
        return await database.savePaletteToDB('complementary', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function diadic(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentDiadicPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 2) {
            console.warn('Diadic palette requires at least 2 swatches.');
            return paletteUtils.createPaletteObject('diadic', [], defaults.hsl, 0, currentDiadicPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const hues = genHues.diadic(baseColor.value.hue);
        const paletteItems = Array.from({ length: numBoxes }, (_, i) => {
            const saturationShift = Math.random() * config.diadicSaturationShiftRange -
                config.diadicSaturationShiftRange / 2;
            const lightnessShift = Math.random() * config.diadicLightnessShiftRange -
                config.diadicLightnessShiftRange / 2;
            const newColor = {
                value: {
                    hue: hues[i % hues.length],
                    saturation: Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift)),
                    lightness: Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)),
                    alpha: enableAlpha ? Math.random() : 1
                },
                format: 'hsl'
            };
            return createPaletteItem(newColor, enableAlpha);
        });
        return await database.savePaletteToDB('diadic', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function hexadic(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentHexadicPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 6) {
            console.warn('Hexadic palette requires at least 6 swatches.');
            return paletteUtils.createPaletteObject('hexadic', [], defaults.hsl, 0, currentHexadicPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const hues = genHues.hexadic(baseColor);
        const paletteItems = hues.map((hue, _i) => {
            const saturationShift = Math.random() * config.hexadicSaturationShiftRange -
                config.hexadicSaturationShiftRange / 2;
            const lightnessShift = Math.random() * config.hexadicLightnessShiftRange -
                config.hexadicLightnessShiftRange / 2;
            const newColor = {
                value: {
                    hue,
                    saturation: Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift)),
                    lightness: Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)),
                    alpha: enableAlpha ? Math.random() : 1
                },
                format: 'hsl'
            };
            return createPaletteItem(newColor, enableAlpha);
        });
        return await database.savePaletteToDB('hexadic', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function monochromatic(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentMonochromaticPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 2) {
            console.warn('Monochromatic palette requires at least 2 swatches.');
            return paletteUtils.createPaletteObject('monochromatic', [], defaults.hsl, 0, currentMonochromaticPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha)
        ];
        for (let i = 1; i < numBoxes; i++) {
            const hueShift = Math.random() * 10 - 5;
            const newColor = genAllColorValues({
                value: {
                    hue: (baseColor.value.hue + hueShift + 360) % 360,
                    saturation: Math.min(100, Math.max(0, baseColor.value.saturation - i * 5)),
                    lightness: Math.min(100, Math.max(0, baseColor.value.lightness + (i * 10 - 20))),
                    alpha: enableAlpha ? Math.random() : 1
                },
                format: 'hsl'
            }).hsl;
            if (newColor) {
                paletteItems.push(createPaletteItem(newColor, enableAlpha));
            }
        }
        return await database.savePaletteToDB('monochromatic', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function random(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const baseColor = getBaseColor(customColor, enableAlpha);
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha)
        ];
        for (let i = 1; i < numBoxes; i++) {
            const randomColor = randomHSL(enableAlpha);
            paletteItems.push(createPaletteItem(randomColor, enableAlpha));
            updateColorBox(randomColor, i);
        }
        return await database.savePaletteToDB('random', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function splitComplementary(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentSplitComplementaryPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 3) {
            console.warn('Split complementary palette requires at least 3 swatches.');
            return paletteUtils.createPaletteObject('splitComplementary', [], defaults.hsl, 0, currentSplitComplementaryPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const [hue1, hue2] = genHues.splitComplementary(baseColor.value.hue);
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha),
            ...[hue1, hue2].map((hue, index) => {
                const adjustedHSL = {
                    value: {
                        hue,
                        saturation: Math.max(0, Math.min(baseColor.value.saturation +
                            (index === 0
                                ? -config.splitComplementarySaturationShiftRange
                                : config.splitComplementarySaturationShiftRange), 100)),
                        lightness: Math.max(0, Math.min(baseColor.value.lightness +
                            (index === 0
                                ? -config.splitComplementaryLightnessShiftRange
                                : config.splitComplementaryLightnessShiftRange), 100)),
                        alpha: enableAlpha ? Math.random() : 1
                    },
                    format: 'hsl'
                };
                const adjustedColor = genAllColorValues(adjustedHSL);
                return createPaletteItem(adjustedColor, enableAlpha);
            })
        ];
        return await database.savePaletteToDB('splitComplementary', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function tetradic(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentTetradicPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 4) {
            console.warn('Tetradic palette requires at least 4 swatches.');
            return paletteUtils.createPaletteObject('tetradic', [], defaults.hsl, 0, currentTetradicPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const tetradicHues = genHues.tetradic(baseColor.value.hue);
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha),
            ...tetradicHues.map((hue, index) => {
                const adjustedHSL = {
                    value: {
                        hue,
                        saturation: Math.max(0, Math.min(baseColor.value.saturation +
                            (index % 2 === 0
                                ? -config.tetradicSaturationShiftRange
                                : config.tetradicSaturationShiftRange), 100)),
                        lightness: Math.max(0, Math.min(baseColor.value.lightness +
                            (index % 2 === 0
                                ? -config.tetradicLightnessShiftRange
                                : config.tetradicLightnessShiftRange), 100)),
                        alpha: enableAlpha ? Math.random() : 1
                    },
                    format: 'hsl'
                };
                const adjustedColor = genAllColorValues(adjustedHSL);
                return createPaletteItem(adjustedColor.hsl, enableAlpha);
            })
        ];
        return await database.savePaletteToDB('tetradic', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    async function triadic(numBoxes, customColor, enableAlpha, limitBright, limitDark, limitGray) {
        const currentTriadicPaletteID = await database.getCurrentPaletteID();
        if (numBoxes < 3) {
            console.warn('Triadic palette requires at least 3 swatches.');
            return paletteUtils.createPaletteObject('triadic', [], defaults.hsl, 0, currentTriadicPaletteID, enableAlpha, limitBright, limitDark, limitGray);
        }
        const baseColor = getBaseColor(customColor, enableAlpha);
        const hues = genHues.triadic(baseColor.value.hue);
        const paletteItems = [
            createPaletteItem(baseColor, enableAlpha),
            ...hues.map((hue, index) => {
                const adjustedHSL = {
                    value: {
                        hue,
                        saturation: Math.max(0, Math.min(baseColor.value.saturation +
                            (index % 2 === 0
                                ? -config.triadicSaturationShiftRange
                                : config.triadicSaturationShiftRange), 100)),
                        lightness: Math.max(0, Math.min(baseColor.value.lightness +
                            (index % 2 === 0
                                ? -config.triadicLightnessShiftRange
                                : config.triadicLightnessShiftRange), 100)),
                        alpha: enableAlpha ? Math.random() : 1
                    },
                    format: 'hsl'
                };
                const adjustedColor = genAllColorValues(adjustedHSL);
                return createPaletteItem(adjustedColor, enableAlpha);
            })
        ];
        return await database.savePaletteToDB('triadic', paletteItems, baseColor, numBoxes, enableAlpha, limitBright, limitDark, limitGray);
    }
    return {
        createPaletteItem,
        generatePaletteItems,
        getBaseColor,
        updateColorBox,
        analogous,
        complementary,
        diadic,
        hexadic,
        monochromatic,
        random,
        splitComplementary,
        tetradic,
        triadic
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFsZXR0ZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvcGFsZXR0ZS1nZW4vcGFsZXR0ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUNqQyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ2xDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM3QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDN0MsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUloRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbEQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUN0RCxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBRWxFLE1BQU0sQ0FBQyxLQUFLLFVBQVUsVUFBVTtJQUMvQixTQUFTLGlCQUFpQixDQUN6QixLQUFpQixFQUNqQixXQUFvQjtRQUVwQixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBZSxDQUFDO1FBRXBELFdBQVcsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFMUQsT0FBTztZQUNOLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxNQUFNLElBQUksUUFBUSxDQUFDLGdCQUFn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Q0FBQztTQUNGLENBQUM7UUFFRixPQUFPLE1BQU0sUUFBUSxDQUFDLGVBQWUsQ0FDcEMsU0FBUyxFQUNULFlBQVksRUFDWixTQUFTLEVBQ1QsUUFBUSxFQUNSLFdBQVcsRUFDWCxXQUFXLEVBQ1gsU0FBUyxFQUNULFNBQVMsQ0FDVCxDQUFDO0lBQ0gsQ0FBQztJQUVELE9BQU87UUFDTixpQkFBaUI7UUFDakIsb0JBQW9CO1FBQ3BCLFlBQVk7UUFDWixjQUFjO1FBQ2QsU0FBUztRQUNULGFBQWE7UUFDYixNQUFNO1FBQ04sT0FBTztRQUNQLGFBQWE7UUFDYixNQUFNO1FBQ04sa0JBQWtCO1FBQ2xCLFFBQVE7UUFDUixPQUFPO0tBQ1AsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZW5IdWVzIH0gZnJvbSAnLi9odWVzJztcbmltcG9ydCB7IGxpbWl0cyB9IGZyb20gJy4vbGltaXRzJztcbmltcG9ydCB7IGNvbnZlcnQgfSBmcm9tICcuL2NvbnZlcnNpb24taW5kZXgnO1xuaW1wb3J0IHsgZ2VuQWxsQ29sb3JWYWx1ZXMgfSBmcm9tICcuLi91dGlscy9jb252ZXJzaW9uLXV0aWxzJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4uL2NvbmZpZy9jb25zdGFudHMnO1xuaW1wb3J0IHsgZGVmYXVsdHMgfSBmcm9tICcuLi9jb25maWcvZGVmYXVsdHMnO1xuaW1wb3J0IHsgZGF0YWJhc2UgfSBmcm9tICcuLi9kYXRhYmFzZS9kYXRhYmFzZSc7XG5pbXBvcnQgKiBhcyBjb2xvcnMgZnJvbSAnLi4vaW5kZXgvY29sb3JzJztcbmltcG9ydCAqIGFzIHBhbGV0dGUgZnJvbSAnLi4vaW5kZXgvcGFsZXR0ZSc7XG5pbXBvcnQgKiBhcyBmbk9iamVjdHMgZnJvbSAnLi4vaW5kZXgvZm4tb2JqZWN0cyc7XG5pbXBvcnQgeyBjb2xvclV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvY29sb3ItdXRpbHMnO1xuaW1wb3J0IHsgY29yZSB9IGZyb20gJy4uL3V0aWxzL2NvcmUtdXRpbHMnO1xuaW1wb3J0IHsgcGFsZXR0ZVV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvcGFsZXR0ZS11dGlscyc7XG5pbXBvcnQgeyByYW5kb21IU0wsIHJhbmRvbVNMIH0gZnJvbSAnLi4vdXRpbHMvcmFuZG9tLWNvbG9yLXV0aWxzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlblBhbGV0dGUoKTogUHJvbWlzZTxmbk9iamVjdHMuR2VuUGFsZXR0ZT4ge1xuXHRmdW5jdGlvbiBjcmVhdGVQYWxldHRlSXRlbShcblx0XHRjb2xvcjogY29sb3JzLkhTTCxcblx0XHRlbmFibGVBbHBoYTogYm9vbGVhblxuXHQpOiBwYWxldHRlLlBhbGV0dGVJdGVtIHtcblx0XHRjb25zdCBjbG9uZWRDb2xvciA9IGNvcmUuY2xvbmUoY29sb3IpIGFzIGNvbG9ycy5IU0w7XG5cblx0XHRjbG9uZWRDb2xvci52YWx1ZS5hbHBoYSA9IGVuYWJsZUFscGhhID8gTWF0aC5yYW5kb20oKSA6IDE7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0aWQ6IGAke2NvbG9yLmZvcm1hdH1fJHtkYXRhYmFzZS5nZXROZXh0UGFsZXR0ZUlEKCl9YCxcblx0XHRcdGNvbG9yczoge1xuXHRcdFx0XHRjbXlrOiAoY29udmVydC5oc2xUb0NNWUsoY2xvbmVkQ29sb3IpIGFzIGNvbG9ycy5DTVlLKS52YWx1ZSxcblx0XHRcdFx0aGV4OiAoY29udmVydC5oc2xUb0hleChjbG9uZWRDb2xvcikgYXMgY29sb3JzLkhleCkudmFsdWUsXG5cdFx0XHRcdGhzbDogY2xvbmVkQ29sb3IudmFsdWUsXG5cdFx0XHRcdGhzdjogKGNvbnZlcnQuaHNsVG9IU1YoY2xvbmVkQ29sb3IpIGFzIGNvbG9ycy5IU1YpLnZhbHVlLFxuXHRcdFx0XHRsYWI6IChjb252ZXJ0LmhzbFRvTEFCKGNsb25lZENvbG9yKSBhcyBjb2xvcnMuTEFCKS52YWx1ZSxcblx0XHRcdFx0cmdiOiAoY29udmVydC5oc2xUb1JHQihjbG9uZWRDb2xvcikgYXMgY29sb3JzLlJHQikudmFsdWUsXG5cdFx0XHRcdHh5ejogKGNvbnZlcnQuaHNsVG9YWVooY2xvbmVkQ29sb3IpIGFzIGNvbG9ycy5YWVopLnZhbHVlXG5cdFx0XHR9LFxuXHRcdFx0Y29sb3JTdHJpbmdzOiB7XG5cdFx0XHRcdGNteWtTdHJpbmc6IChcblx0XHRcdFx0XHRjb2xvclV0aWxzLmNvbG9yVG9Db2xvclN0cmluZyhcblx0XHRcdFx0XHRcdGNvbnZlcnQuaHNsVG9DTVlLKGNsb25lZENvbG9yKVxuXHRcdFx0XHRcdCkgYXMgY29sb3JzLkNNWUtTdHJpbmdcblx0XHRcdFx0KS52YWx1ZSxcblx0XHRcdFx0aGV4U3RyaW5nOiAoXG5cdFx0XHRcdFx0Y29sb3JVdGlscy5jb2xvclRvQ29sb3JTdHJpbmcoXG5cdFx0XHRcdFx0XHRjb252ZXJ0LmhzbFRvSGV4KGNsb25lZENvbG9yKVxuXHRcdFx0XHRcdCkgYXMgY29sb3JzLkhleFN0cmluZ1xuXHRcdFx0XHQpLnZhbHVlLFxuXHRcdFx0XHRoc2xTdHJpbmc6IChcblx0XHRcdFx0XHRjb2xvclV0aWxzLmNvbG9yVG9Db2xvclN0cmluZyhcblx0XHRcdFx0XHRcdGNsb25lZENvbG9yXG5cdFx0XHRcdFx0KSBhcyBjb2xvcnMuSFNMU3RyaW5nXG5cdFx0XHRcdCkudmFsdWUsXG5cdFx0XHRcdGhzdlN0cmluZzogKFxuXHRcdFx0XHRcdGNvbG9yVXRpbHMuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdFx0Y29udmVydC5oc2xUb0hTVihjbG9uZWRDb2xvcilcblx0XHRcdFx0XHQpIGFzIGNvbG9ycy5IU1ZTdHJpbmdcblx0XHRcdFx0KS52YWx1ZSxcblx0XHRcdFx0bGFiU3RyaW5nOiAoXG5cdFx0XHRcdFx0Y29sb3JVdGlscy5jb2xvclRvQ29sb3JTdHJpbmcoXG5cdFx0XHRcdFx0XHRjb252ZXJ0LmhzbFRvTEFCKGNsb25lZENvbG9yKVxuXHRcdFx0XHRcdCkgYXMgY29sb3JzLkxBQlN0cmluZ1xuXHRcdFx0XHQpLnZhbHVlLFxuXHRcdFx0XHRyZ2JTdHJpbmc6IChcblx0XHRcdFx0XHRjb2xvclV0aWxzLmNvbG9yVG9Db2xvclN0cmluZyhcblx0XHRcdFx0XHRcdGNvbnZlcnQuaHNsVG9SR0IoY2xvbmVkQ29sb3IpXG5cdFx0XHRcdFx0KSBhcyBjb2xvcnMuUkdCU3RyaW5nXG5cdFx0XHRcdCkudmFsdWUsXG5cdFx0XHRcdHh5elN0cmluZzogKFxuXHRcdFx0XHRcdGNvbG9yVXRpbHMuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdFx0Y29udmVydC5oc2xUb1hZWihjbG9uZWRDb2xvcilcblx0XHRcdFx0XHQpIGFzIGNvbG9ycy5YWVpTdHJpbmdcblx0XHRcdFx0KS52YWx1ZVxuXHRcdFx0fSxcblx0XHRcdGNzc1N0cmluZ3M6IHtcblx0XHRcdFx0Y215a0NTU1N0cmluZzogY29sb3JVdGlscy5nZXRDU1NDb2xvclN0cmluZyhcblx0XHRcdFx0XHRjb252ZXJ0LmhzbFRvQ01ZSyhjbG9uZWRDb2xvcilcblx0XHRcdFx0KSxcblx0XHRcdFx0aGV4Q1NTU3RyaW5nOiBjb252ZXJ0LmhzbFRvSGV4KGNsb25lZENvbG9yKS52YWx1ZS5oZXgsXG5cdFx0XHRcdGhzbENTU1N0cmluZzogY29sb3JVdGlscy5nZXRDU1NDb2xvclN0cmluZyhjbG9uZWRDb2xvciksXG5cdFx0XHRcdGhzdkNTU1N0cmluZzogY29sb3JVdGlscy5nZXRDU1NDb2xvclN0cmluZyhcblx0XHRcdFx0XHRjb252ZXJ0LmhzbFRvSFNWKGNsb25lZENvbG9yKVxuXHRcdFx0XHQpLFxuXHRcdFx0XHRsYWJDU1NTdHJpbmc6IGNvbG9yVXRpbHMuZ2V0Q1NTQ29sb3JTdHJpbmcoXG5cdFx0XHRcdFx0Y29udmVydC5oc2xUb0xBQihjbG9uZWRDb2xvcilcblx0XHRcdFx0KSxcblx0XHRcdFx0cmdiQ1NTU3RyaW5nOiBjb2xvclV0aWxzLmdldENTU0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGNvbnZlcnQuaHNsVG9SR0IoY2xvbmVkQ29sb3IpXG5cdFx0XHRcdCksXG5cdFx0XHRcdHh5ekNTU1N0cmluZzogY29sb3JVdGlscy5nZXRDU1NDb2xvclN0cmluZyhcblx0XHRcdFx0XHRjb252ZXJ0LmhzbFRvWFlaKGNsb25lZENvbG9yKVxuXHRcdFx0XHQpXG5cdFx0XHR9XG5cdFx0fTtcblx0fVxuXG5cdGZ1bmN0aW9uIGdlbmVyYXRlUGFsZXR0ZUl0ZW1zKFxuXHRcdGJhc2VDb2xvcjogY29sb3JzLkhTTCxcblx0XHRodWVzOiBudW1iZXJbXSxcblx0XHRlbmFibGVBbHBoYTogYm9vbGVhbixcblx0XHRsaW1pdERhcms6IGJvb2xlYW4sXG5cdFx0bGltaXRHcmF5OiBib29sZWFuLFxuXHRcdGxpbWl0QnJpZ2h0OiBib29sZWFuXG5cdCk6IHBhbGV0dGUuUGFsZXR0ZUl0ZW1bXSB7XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBwYWxldHRlLlBhbGV0dGVJdGVtW10gPSBbXG5cdFx0XHRjcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIGVuYWJsZUFscGhhKVxuXHRcdF07XG5cblx0XHRodWVzLmZvckVhY2goKGh1ZSwgaSkgPT4ge1xuXHRcdFx0bGV0IG5ld0NvbG9yOiBjb2xvcnMuSFNMIHwgbnVsbCA9IG51bGw7XG5cblx0XHRcdGRvIHtcblx0XHRcdFx0Y29uc3Qgc2wgPSByYW5kb21TTChlbmFibGVBbHBoYSkgYXMgY29sb3JzLlNMO1xuXHRcdFx0XHRuZXdDb2xvciA9IGdlbkFsbENvbG9yVmFsdWVzKHtcblx0XHRcdFx0XHR2YWx1ZTogeyBodWUsIC4uLnNsLnZhbHVlIH0sXG5cdFx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0XHR9KS5oc2wgYXMgY29sb3JzLkhTTDtcblx0XHRcdH0gd2hpbGUgKFxuXHRcdFx0XHRuZXdDb2xvciAmJlxuXHRcdFx0XHQoKGxpbWl0R3JheSAmJiBsaW1pdHMuaXNUb29HcmF5KG5ld0NvbG9yKSkgfHxcblx0XHRcdFx0XHQobGltaXREYXJrICYmIGxpbWl0cy5pc1Rvb0RhcmsobmV3Q29sb3IpKSB8fFxuXHRcdFx0XHRcdChsaW1pdEJyaWdodCAmJiBsaW1pdHMuaXNUb29CcmlnaHQobmV3Q29sb3IpKSlcblx0XHRcdCk7XG5cblx0XHRcdGlmIChuZXdDb2xvcikge1xuXHRcdFx0XHRwYWxldHRlSXRlbXMucHVzaChjcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgZW5hYmxlQWxwaGEpKTtcblxuXHRcdFx0XHR1cGRhdGVDb2xvckJveChuZXdDb2xvciwgaSArIDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHBhbGV0dGVJdGVtcztcblx0fVxuXG5cdGZ1bmN0aW9uIGdldEJhc2VDb2xvcihcblx0XHRjdXN0b21Db2xvcjogY29sb3JzLkhTTCB8IG51bGwsXG5cdFx0ZW5hYmxlQWxwaGE6IGJvb2xlYW5cblx0KTogY29sb3JzLkhTTCB7XG5cdFx0Y29uc3QgY29sb3IgPSBjb3JlLmNsb25lKGN1c3RvbUNvbG9yID8/IHJhbmRvbUhTTChlbmFibGVBbHBoYSkpO1xuXG5cdFx0cmV0dXJuIGNvbG9yIGFzIGNvbG9ycy5IU0w7XG5cdH1cblxuXHRmdW5jdGlvbiB1cGRhdGVDb2xvckJveChjb2xvcjogY29sb3JzLkhTTCwgaW5kZXg6IG51bWJlcik6IHZvaWQge1xuXHRcdGNvbnN0IGNvbG9yQm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNvbG9yLWJveC0ke2luZGV4ICsgMX1gKTtcblxuXHRcdGlmIChjb2xvckJveCkge1xuXHRcdFx0Y29uc3QgY29sb3JWYWx1ZXMgPSBnZW5BbGxDb2xvclZhbHVlcyhjb2xvcik7XG5cdFx0XHRjb25zdCBzZWxlY3RlZENvbG9yID0gY29sb3JWYWx1ZXMgYXMgY29sb3JzLkNvbG9yO1xuXG5cdFx0XHRpZiAoc2VsZWN0ZWRDb2xvcikge1xuXHRcdFx0XHRjb25zdCBoc2xDb2xvciA9IGNvbG9yVmFsdWVzLmhzbCBhcyBjb2xvcnMuSFNMO1xuXHRcdFx0XHRjb25zdCBoc2xDU1NTdHJpbmcgPSBjb2xvclV0aWxzLmdldENTU0NvbG9yU3RyaW5nKGhzbENvbG9yKTtcblxuXHRcdFx0XHRjb2xvckJveC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoc2xDU1NTdHJpbmc7XG5cblx0XHRcdFx0cGFsZXR0ZVV0aWxzLnBvcHVsYXRlQ29sb3JUZXh0T3V0cHV0Qm94KFxuXHRcdFx0XHRcdHNlbGVjdGVkQ29sb3IsXG5cdFx0XHRcdFx0aW5kZXggKyAxXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgZnVuY3Rpb24gYW5hbG9nb3VzKFxuXHRcdG51bUJveGVzOiBudW1iZXIsXG5cdFx0Y3VzdG9tQ29sb3I6IGNvbG9ycy5IU0wgfCBudWxsLFxuXHRcdGVuYWJsZUFscGhhOiBib29sZWFuLFxuXHRcdGxpbWl0QnJpZ2h0OiBib29sZWFuLFxuXHRcdGxpbWl0RGFyazogYm9vbGVhbixcblx0XHRsaW1pdEdyYXk6IGJvb2xlYW5cblx0KTogUHJvbWlzZTxwYWxldHRlLlBhbGV0dGU+IHtcblx0XHRjb25zdCBjdXJyZW50QW5hbG9nb3VzUGFsZXR0ZUlEID0gYXdhaXQgZGF0YWJhc2UuZ2V0Q3VycmVudFBhbGV0dGVJRCgpO1xuXG5cdFx0aWYgKG51bUJveGVzIDwgMikge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBbmFsb2dvdXMgcGFsZXR0ZSByZXF1aXJlcyBhdCBsZWFzdCAyIHN3YXRjaGVzLicpO1xuXG5cdFx0XHRyZXR1cm4gcGFsZXR0ZVV0aWxzLmNyZWF0ZVBhbGV0dGVPYmplY3QoXG5cdFx0XHRcdCdhbmFsb2dvdXMnLFxuXHRcdFx0XHRbXSxcblx0XHRcdFx0ZGVmYXVsdHMuaHNsLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHRjdXJyZW50QW5hbG9nb3VzUGFsZXR0ZUlELFxuXHRcdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRcdGxpbWl0RGFyayxcblx0XHRcdFx0bGltaXRHcmF5XG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IGh1ZXMgPSBnZW5IdWVzLmFuYWxvZ291cyhiYXNlQ29sb3IsIG51bUJveGVzKTtcblx0XHRjb25zdCBwYWxldHRlSXRlbXM6IHBhbGV0dGUuUGFsZXR0ZUl0ZW1bXSA9IGh1ZXMubWFwKChodWUsIGkpID0+IHtcblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBjb2xvcnMuSFNMID0ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiBNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArXG5cdFx0XHRcdFx0XHRcdFx0KE1hdGgucmFuZG9tKCkgLSAwLjUpICogMTBcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGxpZ2h0bmVzczogTWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIChpICUgMiA9PT0gMCA/IDUgOiAtNSlcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGFscGhhOiBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdH07XG5cblx0XHRcdHJldHVybiBjcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGF3YWl0IGRhdGFiYXNlLnNhdmVQYWxldHRlVG9EQihcblx0XHRcdCdhbmFsb2dvdXMnLFxuXHRcdFx0cGFsZXR0ZUl0ZW1zLFxuXHRcdFx0YmFzZUNvbG9yLFxuXHRcdFx0bnVtQm94ZXMsXG5cdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdGxpbWl0QnJpZ2h0LFxuXHRcdFx0bGltaXREYXJrLFxuXHRcdFx0bGltaXRHcmF5XG5cdFx0KTtcblx0fVxuXG5cdGFzeW5jIGZ1bmN0aW9uIGNvbXBsZW1lbnRhcnkoXG5cdFx0bnVtQm94ZXM6IG51bWJlcixcblx0XHRjdXN0b21Db2xvcjogY29sb3JzLkhTTCB8IG51bGwsXG5cdFx0ZW5hYmxlQWxwaGE6IGJvb2xlYW4sXG5cdFx0bGltaXRCcmlnaHQ6IGJvb2xlYW4sXG5cdFx0bGltaXREYXJrOiBib29sZWFuLFxuXHRcdGxpbWl0R3JheTogYm9vbGVhblxuXHQpOiBQcm9taXNlPHBhbGV0dGUuUGFsZXR0ZT4ge1xuXHRcdGNvbnN0IGN1cnJlbnRDb21wbGVtZW50YXJ5UGFsZXR0ZUlEID1cblx0XHRcdGF3YWl0IGRhdGFiYXNlLmdldEN1cnJlbnRQYWxldHRlSUQoKTtcblxuXHRcdGlmIChudW1Cb3hlcyA8IDIpIHtcblx0XHRcdGNvbnNvbGUud2FybignQ29tcGxlbWVudGFyeSBwYWxldHRlIHJlcXVpcmVzIGF0IGxlYXN0IDIgc3dhdGNoZXMuJyk7XG5cblx0XHRcdHJldHVybiBwYWxldHRlVXRpbHMuY3JlYXRlUGFsZXR0ZU9iamVjdChcblx0XHRcdFx0J2NvbXBsZW1lbnRhcnknLFxuXHRcdFx0XHRbXSxcblx0XHRcdFx0ZGVmYXVsdHMuaHNsLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHRjdXJyZW50Q29tcGxlbWVudGFyeVBhbGV0dGVJRCxcblx0XHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRcdGxpbWl0QnJpZ2h0LFxuXHRcdFx0XHRsaW1pdERhcmssXG5cdFx0XHRcdGxpbWl0R3JheVxuXHRcdFx0KTtcblx0XHR9XG5cblx0XHRjb25zdCBiYXNlQ29sb3IgPSBnZXRCYXNlQ29sb3IoY3VzdG9tQ29sb3IsIGVuYWJsZUFscGhhKTtcblx0XHRjb25zdCBjb21wbGVtZW50YXJ5SHVlID0gKGJhc2VDb2xvci52YWx1ZS5odWUgKyAxODApICUgMzYwO1xuXHRcdGNvbnN0IGh1ZXMgPSBBcnJheS5mcm9tKFxuXHRcdFx0eyBsZW5ndGg6IG51bUJveGVzIC0gMSB9LFxuXHRcdFx0KF8sIF9pKSA9PlxuXHRcdFx0XHQoY29tcGxlbWVudGFyeUh1ZSArXG5cdFx0XHRcdFx0KE1hdGgucmFuZG9tKCkgKiBjb25maWcuY29tcGxlbWVudGFyeUh1ZVNoaWZ0UmFuZ2UgLVxuXHRcdFx0XHRcdFx0Y29uZmlnLmNvbXBsZW1lbnRhcnlIdWVTaGlmdFJhbmdlIC8gMikpICVcblx0XHRcdFx0MzYwXG5cdFx0KTtcblx0XHRjb25zdCBwYWxldHRlSXRlbXM6IHBhbGV0dGUuUGFsZXR0ZUl0ZW1bXSA9IGh1ZXMubWFwKChodWUsIGkpID0+IHtcblx0XHRcdGNvbnN0IHNhdHVyYXRpb24gPSBNYXRoLm1pbihcblx0XHRcdFx0MTAwLFxuXHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMTVcblx0XHRcdFx0KVxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IGxpZ2h0bmVzcyA9IE1hdGgubWluKFxuXHRcdFx0XHQxMDAsXG5cdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIChpICUgMiA9PT0gMCA/IC0xMCA6IDEwKVxuXHRcdFx0XHQpXG5cdFx0XHQpO1xuXHRcdFx0Y29uc3QgYWxwaGEgPSBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxO1xuXHRcdFx0Y29uc3QgbmV3Q29sb3I6IGNvbG9ycy5IU0wgPSB7XG5cdFx0XHRcdHZhbHVlOiB7IGh1ZSwgc2F0dXJhdGlvbiwgbGlnaHRuZXNzLCBhbHBoYSB9LFxuXHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGVuYWJsZUFscGhhKTtcblx0XHR9KTtcblxuXHRcdHBhbGV0dGVJdGVtcy51bnNoaWZ0KGNyZWF0ZVBhbGV0dGVJdGVtKGJhc2VDb2xvciwgZW5hYmxlQWxwaGEpKTtcblxuXHRcdHJldHVybiBhd2FpdCBkYXRhYmFzZS5zYXZlUGFsZXR0ZVRvREIoXG5cdFx0XHQnY29tcGxlbWVudGFyeScsXG5cdFx0XHRwYWxldHRlSXRlbXMsXG5cdFx0XHRiYXNlQ29sb3IsXG5cdFx0XHRudW1Cb3hlcyxcblx0XHRcdGVuYWJsZUFscGhhLFxuXHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRsaW1pdERhcmssXG5cdFx0XHRsaW1pdEdyYXlcblx0XHQpO1xuXHR9XG5cblx0YXN5bmMgZnVuY3Rpb24gZGlhZGljKFxuXHRcdG51bUJveGVzOiBudW1iZXIsXG5cdFx0Y3VzdG9tQ29sb3I6IGNvbG9ycy5IU0wgfCBudWxsLFxuXHRcdGVuYWJsZUFscGhhOiBib29sZWFuLFxuXHRcdGxpbWl0QnJpZ2h0OiBib29sZWFuLFxuXHRcdGxpbWl0RGFyazogYm9vbGVhbixcblx0XHRsaW1pdEdyYXk6IGJvb2xlYW5cblx0KTogUHJvbWlzZTxwYWxldHRlLlBhbGV0dGU+IHtcblx0XHRjb25zdCBjdXJyZW50RGlhZGljUGFsZXR0ZUlEID0gYXdhaXQgZGF0YWJhc2UuZ2V0Q3VycmVudFBhbGV0dGVJRCgpO1xuXG5cdFx0aWYgKG51bUJveGVzIDwgMikge1xuXHRcdFx0Y29uc29sZS53YXJuKCdEaWFkaWMgcGFsZXR0ZSByZXF1aXJlcyBhdCBsZWFzdCAyIHN3YXRjaGVzLicpO1xuXG5cdFx0XHRyZXR1cm4gcGFsZXR0ZVV0aWxzLmNyZWF0ZVBhbGV0dGVPYmplY3QoXG5cdFx0XHRcdCdkaWFkaWMnLFxuXHRcdFx0XHRbXSxcblx0XHRcdFx0ZGVmYXVsdHMuaHNsLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHRjdXJyZW50RGlhZGljUGFsZXR0ZUlELFxuXHRcdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRcdGxpbWl0RGFyayxcblx0XHRcdFx0bGltaXRHcmF5XG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IGh1ZXMgPSBnZW5IdWVzLmRpYWRpYyhiYXNlQ29sb3IudmFsdWUuaHVlKTtcblx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBudW1Cb3hlcyB9LCAoXywgaSkgPT4ge1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIGNvbmZpZy5kaWFkaWNTYXR1cmF0aW9uU2hpZnRSYW5nZSAtXG5cdFx0XHRcdGNvbmZpZy5kaWFkaWNTYXR1cmF0aW9uU2hpZnRSYW5nZSAvIDI7XG5cdFx0XHRjb25zdCBsaWdodG5lc3NTaGlmdCA9XG5cdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBjb25maWcuZGlhZGljTGlnaHRuZXNzU2hpZnRSYW5nZSAtXG5cdFx0XHRcdGNvbmZpZy5kaWFkaWNMaWdodG5lc3NTaGlmdFJhbmdlIC8gMjtcblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBjb2xvcnMuSFNMID0ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZTogaHVlc1tpICUgaHVlcy5sZW5ndGhdLFxuXHRcdFx0XHRcdHNhdHVyYXRpb246IE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvblNoaWZ0XG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRsaWdodG5lc3M6IE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgYmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0KVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0YWxwaGE6IGVuYWJsZUFscGhhID8gTWF0aC5yYW5kb20oKSA6IDFcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0fTtcblxuXHRcdFx0cmV0dXJuIGNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBlbmFibGVBbHBoYSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gYXdhaXQgZGF0YWJhc2Uuc2F2ZVBhbGV0dGVUb0RCKFxuXHRcdFx0J2RpYWRpYycsXG5cdFx0XHRwYWxldHRlSXRlbXMsXG5cdFx0XHRiYXNlQ29sb3IsXG5cdFx0XHRudW1Cb3hlcyxcblx0XHRcdGVuYWJsZUFscGhhLFxuXHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRsaW1pdERhcmssXG5cdFx0XHRsaW1pdEdyYXlcblx0XHQpO1xuXHR9XG5cblx0YXN5bmMgZnVuY3Rpb24gaGV4YWRpYyhcblx0XHRudW1Cb3hlczogbnVtYmVyLFxuXHRcdGN1c3RvbUNvbG9yOiBjb2xvcnMuSFNMIHwgbnVsbCxcblx0XHRlbmFibGVBbHBoYTogYm9vbGVhbixcblx0XHRsaW1pdEJyaWdodDogYm9vbGVhbixcblx0XHRsaW1pdERhcms6IGJvb2xlYW4sXG5cdFx0bGltaXRHcmF5OiBib29sZWFuXG5cdCk6IFByb21pc2U8cGFsZXR0ZS5QYWxldHRlPiB7XG5cdFx0Y29uc3QgY3VycmVudEhleGFkaWNQYWxldHRlSUQgPSBhd2FpdCBkYXRhYmFzZS5nZXRDdXJyZW50UGFsZXR0ZUlEKCk7XG5cblx0XHRpZiAobnVtQm94ZXMgPCA2KSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0hleGFkaWMgcGFsZXR0ZSByZXF1aXJlcyBhdCBsZWFzdCA2IHN3YXRjaGVzLicpO1xuXG5cdFx0XHRyZXR1cm4gcGFsZXR0ZVV0aWxzLmNyZWF0ZVBhbGV0dGVPYmplY3QoXG5cdFx0XHRcdCdoZXhhZGljJyxcblx0XHRcdFx0W10sXG5cdFx0XHRcdGRlZmF1bHRzLmhzbCxcblx0XHRcdFx0MCxcblx0XHRcdFx0Y3VycmVudEhleGFkaWNQYWxldHRlSUQsXG5cdFx0XHRcdGVuYWJsZUFscGhhLFxuXHRcdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdFx0bGltaXREYXJrLFxuXHRcdFx0XHRsaW1pdEdyYXlcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gZ2V0QmFzZUNvbG9yKGN1c3RvbUNvbG9yLCBlbmFibGVBbHBoYSk7XG5cdFx0Y29uc3QgaHVlcyA9IGdlbkh1ZXMuaGV4YWRpYyhiYXNlQ29sb3IpO1xuXHRcdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIF9pKSA9PiB7XG5cdFx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPVxuXHRcdFx0XHRNYXRoLnJhbmRvbSgpICogY29uZmlnLmhleGFkaWNTYXR1cmF0aW9uU2hpZnRSYW5nZSAtXG5cdFx0XHRcdGNvbmZpZy5oZXhhZGljU2F0dXJhdGlvblNoaWZ0UmFuZ2UgLyAyO1xuXHRcdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPVxuXHRcdFx0XHRNYXRoLnJhbmRvbSgpICogY29uZmlnLmhleGFkaWNMaWdodG5lc3NTaGlmdFJhbmdlIC1cblx0XHRcdFx0Y29uZmlnLmhleGFkaWNMaWdodG5lc3NTaGlmdFJhbmdlIC8gMjtcblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBjb2xvcnMuSFNMID0ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiBNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0bGlnaHRuZXNzOiBNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGFscGhhOiBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdH07XG5cblx0XHRcdHJldHVybiBjcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGF3YWl0IGRhdGFiYXNlLnNhdmVQYWxldHRlVG9EQihcblx0XHRcdCdoZXhhZGljJyxcblx0XHRcdHBhbGV0dGVJdGVtcyxcblx0XHRcdGJhc2VDb2xvcixcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBmdW5jdGlvbiBtb25vY2hyb21hdGljKFxuXHRcdG51bUJveGVzOiBudW1iZXIsXG5cdFx0Y3VzdG9tQ29sb3I6IGNvbG9ycy5IU0wgfCBudWxsLFxuXHRcdGVuYWJsZUFscGhhOiBib29sZWFuLFxuXHRcdGxpbWl0QnJpZ2h0OiBib29sZWFuLFxuXHRcdGxpbWl0RGFyazogYm9vbGVhbixcblx0XHRsaW1pdEdyYXk6IGJvb2xlYW5cblx0KTogUHJvbWlzZTxwYWxldHRlLlBhbGV0dGU+IHtcblx0XHRjb25zdCBjdXJyZW50TW9ub2Nocm9tYXRpY1BhbGV0dGVJRCA9XG5cdFx0XHRhd2FpdCBkYXRhYmFzZS5nZXRDdXJyZW50UGFsZXR0ZUlEKCk7XG5cblx0XHRpZiAobnVtQm94ZXMgPCAyKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ01vbm9jaHJvbWF0aWMgcGFsZXR0ZSByZXF1aXJlcyBhdCBsZWFzdCAyIHN3YXRjaGVzLicpO1xuXG5cdFx0XHRyZXR1cm4gcGFsZXR0ZVV0aWxzLmNyZWF0ZVBhbGV0dGVPYmplY3QoXG5cdFx0XHRcdCdtb25vY2hyb21hdGljJyxcblx0XHRcdFx0W10sXG5cdFx0XHRcdGRlZmF1bHRzLmhzbCxcblx0XHRcdFx0MCxcblx0XHRcdFx0Y3VycmVudE1vbm9jaHJvbWF0aWNQYWxldHRlSUQsXG5cdFx0XHRcdGVuYWJsZUFscGhhLFxuXHRcdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdFx0bGltaXREYXJrLFxuXHRcdFx0XHRsaW1pdEdyYXlcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gZ2V0QmFzZUNvbG9yKGN1c3RvbUNvbG9yLCBlbmFibGVBbHBoYSk7XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBwYWxldHRlLlBhbGV0dGVJdGVtW10gPSBbXG5cdFx0XHRjcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIGVuYWJsZUFscGhhKVxuXHRcdF07XG5cblx0XHRmb3IgKGxldCBpID0gMTsgaSA8IG51bUJveGVzOyBpKyspIHtcblx0XHRcdGNvbnN0IGh1ZVNoaWZ0ID0gTWF0aC5yYW5kb20oKSAqIDEwIC0gNTtcblx0XHRcdGNvbnN0IG5ld0NvbG9yID0gZ2VuQWxsQ29sb3JWYWx1ZXMoe1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZTogKGJhc2VDb2xvci52YWx1ZS5odWUgKyBodWVTaGlmdCArIDM2MCkgJSAzNjAsXG5cdFx0XHRcdFx0c2F0dXJhdGlvbjogTWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heCgwLCBiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiAtIGkgKiA1KVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0bGlnaHRuZXNzOiBNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyAoaSAqIDEwIC0gMjApKVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0YWxwaGE6IGVuYWJsZUFscGhhID8gTWF0aC5yYW5kb20oKSA6IDFcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0fSkuaHNsO1xuXG5cdFx0XHRpZiAobmV3Q29sb3IpIHtcblx0XHRcdFx0cGFsZXR0ZUl0ZW1zLnB1c2goY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGVuYWJsZUFscGhhKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGF3YWl0IGRhdGFiYXNlLnNhdmVQYWxldHRlVG9EQihcblx0XHRcdCdtb25vY2hyb21hdGljJyxcblx0XHRcdHBhbGV0dGVJdGVtcyxcblx0XHRcdGJhc2VDb2xvcixcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBmdW5jdGlvbiByYW5kb20oXG5cdFx0bnVtQm94ZXM6IG51bWJlcixcblx0XHRjdXN0b21Db2xvcjogY29sb3JzLkhTTCB8IG51bGwsXG5cdFx0ZW5hYmxlQWxwaGE6IGJvb2xlYW4sXG5cdFx0bGltaXRCcmlnaHQ6IGJvb2xlYW4sXG5cdFx0bGltaXREYXJrOiBib29sZWFuLFxuXHRcdGxpbWl0R3JheTogYm9vbGVhblxuXHQpOiBQcm9taXNlPHBhbGV0dGUuUGFsZXR0ZT4ge1xuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IHBhbGV0dGVJdGVtczogcGFsZXR0ZS5QYWxldHRlSXRlbVtdID0gW1xuXHRcdFx0Y3JlYXRlUGFsZXR0ZUl0ZW0oYmFzZUNvbG9yLCBlbmFibGVBbHBoYSlcblx0XHRdO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCBudW1Cb3hlczsgaSsrKSB7XG5cdFx0XHRjb25zdCByYW5kb21Db2xvciA9IHJhbmRvbUhTTChlbmFibGVBbHBoYSk7XG5cblx0XHRcdHBhbGV0dGVJdGVtcy5wdXNoKGNyZWF0ZVBhbGV0dGVJdGVtKHJhbmRvbUNvbG9yLCBlbmFibGVBbHBoYSkpO1xuXG5cdFx0XHR1cGRhdGVDb2xvckJveChyYW5kb21Db2xvciwgaSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGF3YWl0IGRhdGFiYXNlLnNhdmVQYWxldHRlVG9EQihcblx0XHRcdCdyYW5kb20nLFxuXHRcdFx0cGFsZXR0ZUl0ZW1zLFxuXHRcdFx0YmFzZUNvbG9yLFxuXHRcdFx0bnVtQm94ZXMsXG5cdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdGxpbWl0QnJpZ2h0LFxuXHRcdFx0bGltaXREYXJrLFxuXHRcdFx0bGltaXRHcmF5XG5cdFx0KTtcblx0fVxuXG5cdGFzeW5jIGZ1bmN0aW9uIHNwbGl0Q29tcGxlbWVudGFyeShcblx0XHRudW1Cb3hlczogbnVtYmVyLFxuXHRcdGN1c3RvbUNvbG9yOiBjb2xvcnMuSFNMIHwgbnVsbCxcblx0XHRlbmFibGVBbHBoYTogYm9vbGVhbixcblx0XHRsaW1pdEJyaWdodDogYm9vbGVhbixcblx0XHRsaW1pdERhcms6IGJvb2xlYW4sXG5cdFx0bGltaXRHcmF5OiBib29sZWFuXG5cdCk6IFByb21pc2U8cGFsZXR0ZS5QYWxldHRlPiB7XG5cdFx0Y29uc3QgY3VycmVudFNwbGl0Q29tcGxlbWVudGFyeVBhbGV0dGVJRCA9XG5cdFx0XHRhd2FpdCBkYXRhYmFzZS5nZXRDdXJyZW50UGFsZXR0ZUlEKCk7XG5cblx0XHRpZiAobnVtQm94ZXMgPCAzKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXG5cdFx0XHRcdCdTcGxpdCBjb21wbGVtZW50YXJ5IHBhbGV0dGUgcmVxdWlyZXMgYXQgbGVhc3QgMyBzd2F0Y2hlcy4nXG5cdFx0XHQpO1xuXG5cdFx0XHRyZXR1cm4gcGFsZXR0ZVV0aWxzLmNyZWF0ZVBhbGV0dGVPYmplY3QoXG5cdFx0XHRcdCdzcGxpdENvbXBsZW1lbnRhcnknLFxuXHRcdFx0XHRbXSxcblx0XHRcdFx0ZGVmYXVsdHMuaHNsLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHRjdXJyZW50U3BsaXRDb21wbGVtZW50YXJ5UGFsZXR0ZUlELFxuXHRcdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRcdGxpbWl0RGFyayxcblx0XHRcdFx0bGltaXRHcmF5XG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IFtodWUxLCBodWUyXSA9IGdlbkh1ZXMuc3BsaXRDb21wbGVtZW50YXJ5KGJhc2VDb2xvci52YWx1ZS5odWUpO1xuXHRcdGNvbnN0IHBhbGV0dGVJdGVtczogcGFsZXR0ZS5QYWxldHRlSXRlbVtdID0gW1xuXHRcdFx0Y3JlYXRlUGFsZXR0ZUl0ZW0oYmFzZUNvbG9yLCBlbmFibGVBbHBoYSksXG5cdFx0XHQuLi5baHVlMSwgaHVlMl0ubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGFkanVzdGVkSFNMOiBjb2xvcnMuSFNMID0ge1xuXHRcdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0XHRodWUsXG5cdFx0XHRcdFx0XHRzYXR1cmF0aW9uOiBNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gK1xuXHRcdFx0XHRcdFx0XHRcdFx0KGluZGV4ID09PSAwXG5cdFx0XHRcdFx0XHRcdFx0XHRcdD8gLWNvbmZpZy5zcGxpdENvbXBsZW1lbnRhcnlTYXR1cmF0aW9uU2hpZnRSYW5nZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ6IGNvbmZpZy5zcGxpdENvbXBsZW1lbnRhcnlTYXR1cmF0aW9uU2hpZnRSYW5nZSksXG5cdFx0XHRcdFx0XHRcdFx0MTAwXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICtcblx0XHRcdFx0XHRcdFx0XHRcdChpbmRleCA9PT0gMFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ/IC1jb25maWcuc3BsaXRDb21wbGVtZW50YXJ5TGlnaHRuZXNzU2hpZnRSYW5nZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ6IGNvbmZpZy5zcGxpdENvbXBsZW1lbnRhcnlMaWdodG5lc3NTaGlmdFJhbmdlKSxcblx0XHRcdFx0XHRcdFx0XHQxMDBcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGFscGhhOiBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHRcdH07XG5cdFx0XHRcdGNvbnN0IGFkanVzdGVkQ29sb3IgPSBnZW5BbGxDb2xvclZhbHVlcyhcblx0XHRcdFx0XHRhZGp1c3RlZEhTTFxuXHRcdFx0XHQpIGFzIGNvbG9ycy5IU0w7XG5cblx0XHRcdFx0cmV0dXJuIGNyZWF0ZVBhbGV0dGVJdGVtKGFkanVzdGVkQ29sb3IsIGVuYWJsZUFscGhhKTtcblx0XHRcdH0pXG5cdFx0XTtcblxuXHRcdHJldHVybiBhd2FpdCBkYXRhYmFzZS5zYXZlUGFsZXR0ZVRvREIoXG5cdFx0XHQnc3BsaXRDb21wbGVtZW50YXJ5Jyxcblx0XHRcdHBhbGV0dGVJdGVtcyxcblx0XHRcdGJhc2VDb2xvcixcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBmdW5jdGlvbiB0ZXRyYWRpYyhcblx0XHRudW1Cb3hlczogbnVtYmVyLFxuXHRcdGN1c3RvbUNvbG9yOiBjb2xvcnMuSFNMIHwgbnVsbCxcblx0XHRlbmFibGVBbHBoYTogYm9vbGVhbixcblx0XHRsaW1pdEJyaWdodDogYm9vbGVhbixcblx0XHRsaW1pdERhcms6IGJvb2xlYW4sXG5cdFx0bGltaXRHcmF5OiBib29sZWFuXG5cdCk6IFByb21pc2U8cGFsZXR0ZS5QYWxldHRlPiB7XG5cdFx0Y29uc3QgY3VycmVudFRldHJhZGljUGFsZXR0ZUlEID0gYXdhaXQgZGF0YWJhc2UuZ2V0Q3VycmVudFBhbGV0dGVJRCgpO1xuXG5cdFx0aWYgKG51bUJveGVzIDwgNCkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdUZXRyYWRpYyBwYWxldHRlIHJlcXVpcmVzIGF0IGxlYXN0IDQgc3dhdGNoZXMuJyk7XG5cblx0XHRcdHJldHVybiBwYWxldHRlVXRpbHMuY3JlYXRlUGFsZXR0ZU9iamVjdChcblx0XHRcdFx0J3RldHJhZGljJyxcblx0XHRcdFx0W10sXG5cdFx0XHRcdGRlZmF1bHRzLmhzbCxcblx0XHRcdFx0MCxcblx0XHRcdFx0Y3VycmVudFRldHJhZGljUGFsZXR0ZUlELFxuXHRcdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRcdGxpbWl0RGFyayxcblx0XHRcdFx0bGltaXRHcmF5XG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IHRldHJhZGljSHVlcyA9IGdlbkh1ZXMudGV0cmFkaWMoYmFzZUNvbG9yLnZhbHVlLmh1ZSk7XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBwYWxldHRlLlBhbGV0dGVJdGVtW10gPSBbXG5cdFx0XHRjcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIGVuYWJsZUFscGhhKSxcblx0XHRcdC4uLnRldHJhZGljSHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgYWRqdXN0ZWRIU0w6IGNvbG9ycy5IU0wgPSB7XG5cdFx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRcdGh1ZSxcblx0XHRcdFx0XHRcdHNhdHVyYXRpb246IE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArXG5cdFx0XHRcdFx0XHRcdFx0XHQoaW5kZXggJSAyID09PSAwXG5cdFx0XHRcdFx0XHRcdFx0XHRcdD8gLWNvbmZpZy50ZXRyYWRpY1NhdHVyYXRpb25TaGlmdFJhbmdlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDogY29uZmlnLnRldHJhZGljU2F0dXJhdGlvblNoaWZ0UmFuZ2UpLFxuXHRcdFx0XHRcdFx0XHRcdDEwMFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bGlnaHRuZXNzOiBNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArXG5cdFx0XHRcdFx0XHRcdFx0XHQoaW5kZXggJSAyID09PSAwXG5cdFx0XHRcdFx0XHRcdFx0XHRcdD8gLWNvbmZpZy50ZXRyYWRpY0xpZ2h0bmVzc1NoaWZ0UmFuZ2Vcblx0XHRcdFx0XHRcdFx0XHRcdFx0OiBjb25maWcudGV0cmFkaWNMaWdodG5lc3NTaGlmdFJhbmdlKSxcblx0XHRcdFx0XHRcdFx0XHQxMDBcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGFscGhhOiBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHRcdH07XG5cdFx0XHRcdGNvbnN0IGFkanVzdGVkQ29sb3IgPSBnZW5BbGxDb2xvclZhbHVlcyhhZGp1c3RlZEhTTCk7XG5cblx0XHRcdFx0cmV0dXJuIGNyZWF0ZVBhbGV0dGVJdGVtKFxuXHRcdFx0XHRcdGFkanVzdGVkQ29sb3IuaHNsIGFzIGNvbG9ycy5IU0wsXG5cdFx0XHRcdFx0ZW5hYmxlQWxwaGFcblx0XHRcdFx0KTtcblx0XHRcdH0pXG5cdFx0XTtcblxuXHRcdHJldHVybiBhd2FpdCBkYXRhYmFzZS5zYXZlUGFsZXR0ZVRvREIoXG5cdFx0XHQndGV0cmFkaWMnLFxuXHRcdFx0cGFsZXR0ZUl0ZW1zLFxuXHRcdFx0YmFzZUNvbG9yLFxuXHRcdFx0bnVtQm94ZXMsXG5cdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdGxpbWl0QnJpZ2h0LFxuXHRcdFx0bGltaXREYXJrLFxuXHRcdFx0bGltaXRHcmF5XG5cdFx0KTtcblx0fVxuXG5cdGFzeW5jIGZ1bmN0aW9uIHRyaWFkaWMoXG5cdFx0bnVtQm94ZXM6IG51bWJlcixcblx0XHRjdXN0b21Db2xvcjogY29sb3JzLkhTTCB8IG51bGwsXG5cdFx0ZW5hYmxlQWxwaGE6IGJvb2xlYW4sXG5cdFx0bGltaXRCcmlnaHQ6IGJvb2xlYW4sXG5cdFx0bGltaXREYXJrOiBib29sZWFuLFxuXHRcdGxpbWl0R3JheTogYm9vbGVhblxuXHQpOiBQcm9taXNlPHBhbGV0dGUuUGFsZXR0ZT4ge1xuXHRcdGNvbnN0IGN1cnJlbnRUcmlhZGljUGFsZXR0ZUlEID0gYXdhaXQgZGF0YWJhc2UuZ2V0Q3VycmVudFBhbGV0dGVJRCgpO1xuXG5cdFx0aWYgKG51bUJveGVzIDwgMykge1xuXHRcdFx0Y29uc29sZS53YXJuKCdUcmlhZGljIHBhbGV0dGUgcmVxdWlyZXMgYXQgbGVhc3QgMyBzd2F0Y2hlcy4nKTtcblxuXHRcdFx0cmV0dXJuIHBhbGV0dGVVdGlscy5jcmVhdGVQYWxldHRlT2JqZWN0KFxuXHRcdFx0XHQndHJpYWRpYycsXG5cdFx0XHRcdFtdLFxuXHRcdFx0XHRkZWZhdWx0cy5oc2wsXG5cdFx0XHRcdDAsXG5cdFx0XHRcdGN1cnJlbnRUcmlhZGljUGFsZXR0ZUlELFxuXHRcdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdFx0bGltaXRCcmlnaHQsXG5cdFx0XHRcdGxpbWl0RGFyayxcblx0XHRcdFx0bGltaXRHcmF5XG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IGdldEJhc2VDb2xvcihjdXN0b21Db2xvciwgZW5hYmxlQWxwaGEpO1xuXHRcdGNvbnN0IGh1ZXMgPSBnZW5IdWVzLnRyaWFkaWMoYmFzZUNvbG9yLnZhbHVlLmh1ZSk7XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBwYWxldHRlLlBhbGV0dGVJdGVtW10gPSBbXG5cdFx0XHRjcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIGVuYWJsZUFscGhhKSxcblx0XHRcdC4uLmh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGFkanVzdGVkSFNMOiBjb2xvcnMuSFNMID0ge1xuXHRcdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0XHRodWUsXG5cdFx0XHRcdFx0XHRzYXR1cmF0aW9uOiBNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gK1xuXHRcdFx0XHRcdFx0XHRcdFx0KGluZGV4ICUgMiA9PT0gMFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ/IC1jb25maWcudHJpYWRpY1NhdHVyYXRpb25TaGlmdFJhbmdlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDogY29uZmlnLnRyaWFkaWNTYXR1cmF0aW9uU2hpZnRSYW5nZSksXG5cdFx0XHRcdFx0XHRcdFx0MTAwXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICtcblx0XHRcdFx0XHRcdFx0XHRcdChpbmRleCAlIDIgPT09IDBcblx0XHRcdFx0XHRcdFx0XHRcdFx0PyAtY29uZmlnLnRyaWFkaWNMaWdodG5lc3NTaGlmdFJhbmdlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDogY29uZmlnLnRyaWFkaWNMaWdodG5lc3NTaGlmdFJhbmdlKSxcblx0XHRcdFx0XHRcdFx0XHQxMDBcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGFscGhhOiBlbmFibGVBbHBoYSA/IE1hdGgucmFuZG9tKCkgOiAxXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHRcdH07XG5cdFx0XHRcdGNvbnN0IGFkanVzdGVkQ29sb3IgPSBnZW5BbGxDb2xvclZhbHVlcyhhZGp1c3RlZEhTTCk7XG5cblx0XHRcdFx0cmV0dXJuIGNyZWF0ZVBhbGV0dGVJdGVtKFxuXHRcdFx0XHRcdGFkanVzdGVkQ29sb3IgYXMgY29sb3JzLkhTTCxcblx0XHRcdFx0XHRlbmFibGVBbHBoYVxuXHRcdFx0XHQpO1xuXHRcdFx0fSlcblx0XHRdO1xuXG5cdFx0cmV0dXJuIGF3YWl0IGRhdGFiYXNlLnNhdmVQYWxldHRlVG9EQihcblx0XHRcdCd0cmlhZGljJyxcblx0XHRcdHBhbGV0dGVJdGVtcyxcblx0XHRcdGJhc2VDb2xvcixcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdCk7XG5cdH1cblxuXHRyZXR1cm4ge1xuXHRcdGNyZWF0ZVBhbGV0dGVJdGVtLFxuXHRcdGdlbmVyYXRlUGFsZXR0ZUl0ZW1zLFxuXHRcdGdldEJhc2VDb2xvcixcblx0XHR1cGRhdGVDb2xvckJveCxcblx0XHRhbmFsb2dvdXMsXG5cdFx0Y29tcGxlbWVudGFyeSxcblx0XHRkaWFkaWMsXG5cdFx0aGV4YWRpYyxcblx0XHRtb25vY2hyb21hdGljLFxuXHRcdHJhbmRvbSxcblx0XHRzcGxpdENvbXBsZW1lbnRhcnksXG5cdFx0dGV0cmFkaWMsXG5cdFx0dHJpYWRpY1xuXHR9O1xufVxuIl19