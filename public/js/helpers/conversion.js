import { convert } from '../color-conversion/conversion-index.js';
import { defaults } from '../utils/defaults.js';
function applyGammaCorrection(value) {
    try {
        return value > 0.0031308
            ? 1.055 * Math.pow(value, 1 / 2.4) - 0.055
            : 12.92 * value;
    }
    catch (error) {
        console.error(`Error applying gamma correction: ${error}`);
        return value;
    }
}
function clampRGB(rgb) {
    try {
        return {
            value: {
                red: Math.round(Math.min(Math.max(0, rgb.value.red), 1) * 255),
                green: Math.round(Math.min(Math.max(0, rgb.value.green), 1) * 255),
                blue: Math.round(Math.min(Math.max(0, rgb.value.blue), 1) * 255)
            },
            format: 'rgb'
        };
    }
    catch (error) {
        console.error(`Error clamping RGB values: ${error}`);
        return rgb;
    }
}
function cmykToXYZHelper(cmyk) {
    try {
        const rgb = convert.cmykToRGB(cmyk);
        return convert.rgbToXYZ(rgb);
    }
    catch (error) {
        console.error(`Error converting CMYK to XYZ: ${error}`);
        return defaults.defaultXYZ();
    }
}
function convertColorToHex(color) {
    try {
        switch (color.format) {
            case 'cmyk':
                return convert.cmykToHex(color);
            case 'hex':
                return color;
            case 'hsl':
                return convert.hslToHex(color);
            case 'hsv':
                return convert.hsvToHex(color);
            case 'lab':
                return convert.labToHex(color);
            case 'rgb':
                return convert.rgbToHex(color);
            case 'xyz':
                return convert.xyzToHex(color);
            default:
                console.error('Unsupported color format');
                return null;
        }
    }
    catch (error) {
        console.error(`Error converting color to hex: ${error}`);
        return null;
    }
}
function convertColorToHSL(color) {
    try {
        switch (color.format) {
            case 'cmyk':
                return convert.cmykToHSL(color);
            case 'hex':
                return convert.hexToHSL(color);
            case 'hsl':
                return color;
            case 'hsv':
                return convert.hsvToHSL(color);
            case 'lab':
                return convert.labToHSL(color);
            case 'rgb':
                return convert.rgbToHSL(color);
            case 'xyz':
                return convert.xyzToHSL(color);
            default:
                console.error('Unsupported color format');
                return null;
        }
    }
    catch (error) {
        console.error(`Error converting color to HSL: ${error}`);
        return null;
    }
}
function hexToCMYKHelper(hex) {
    try {
        const rgb = convert.hexToRGB(hex);
        return convert.rgbToCMYK(rgb);
    }
    catch (error) {
        console.error(`Error converting hex to CMYK: ${error}`);
        return defaults.defaultCMYK();
    }
}
function hexToXYZHelper(hex) {
    try {
        const lab = convert.hexToLAB(hex);
        const xyz = convert.labToXYZ(lab);
        return xyz;
    }
    catch (error) {
        console.error(`Error converting hex to XYZ: ${error}`);
        return defaults.defaultXYZ();
    }
}
export function hueToRGB(p, q, t) {
    try {
        if (t < 0)
            t += 1;
        if (t > 1)
            t -= 1;
        if (t < 1 / 6)
            return p + (q - p) * 6 * t;
        if (t < 1 / 2)
            return q;
        if (t < 2 / 3)
            return p + (q - p) * (2 / 3 - t) * 6;
        return p;
    }
    catch (error) {
        console.error(`Error converting hue to RGB: ${error}`);
        return 0;
    }
}
function hslAddFormat(value) {
    try {
        return { value: value, format: 'hsl' };
    }
    catch (error) {
        console.error(`Error adding HSL format: ${error}`);
        return defaults.defaultHSL();
    }
}
function hslToCMYKHelper(hsl) {
    try {
        const rgb = convert.hslToRGB(hsl);
        return convert.rgbToCMYK(rgb);
    }
    catch (error) {
        console.error(`Error converting HSL to CMYK: ${error}`);
        return defaults.defaultCMYK();
    }
}
function hslToHexHelper(hsl) {
    try {
        const rgb = convert.hslToRGB(hsl);
        return convert.rgbToHex(rgb);
    }
    catch (error) {
        console.error(`Error converting HSL to hex: ${error}`);
        return defaults.defaultHex();
    }
}
function hslToXYZHelper(hsl) {
    try {
        const lab = convert.hslToLAB(hsl);
        return convert.labToXYZ(lab);
    }
    catch (error) {
        console.error(`Error converting HSL to XYZ: ${error}`);
        return defaults.defaultXYZ();
    }
}
function hsvToCMYKHelper(hsv) {
    try {
        const rgb = convert.hsvToRGB(hsv);
        return convert.rgbToCMYK(rgb);
    }
    catch (error) {
        console.error(`Error converting HSV to CMYK: ${error}`);
        return defaults.defaultCMYK();
    }
}
function hsvToXYZHelper(hsv) {
    try {
        const rgb = convert.hsvToRGB(hsv);
        return convert.rgbToXYZ(rgb);
    }
    catch (error) {
        console.error(`Error converting HSV to XYZ: ${error}`);
        return defaults.defaultXYZ();
    }
}
function labToCMYKHelper(lab) {
    try {
        const rgb = convert.labToRGB(lab);
        return convert.rgbToCMYK(rgb);
    }
    catch (error) {
        console.error(`Error converting LAB to CMYK: ${error}`);
        return defaults.defaultCMYK();
    }
}
function labToXYZHelper(lab) {
    try {
        return convert.labToXYZ(lab);
    }
    catch (error) {
        console.error(`Error converting LAB to XYZ: ${error}`);
        return defaults.defaultXYZ();
    }
}
function xyzToCMYKHelper(xyz) {
    try {
        const lab = convert.xyzToLAB(xyz);
        return convert.labToCMYK(lab);
    }
    catch (error) {
        console.error(`Error converting XYZ to CMYK: ${error}`);
        return defaults.defaultCMYK();
    }
}
function xyzToHexHelper(xyz) {
    try {
        const lab = convert.xyzToLAB(xyz);
        return convert.labToHex(lab);
    }
    catch (error) {
        console.error(`Error converting XYZ to hex: ${error}`);
        return defaults.defaultHex();
    }
}
function xyzToHSLHelper(xyz) {
    try {
        const lab = convert.xyzToLAB(xyz);
        return convert.labToHSL(lab);
    }
    catch (error) {
        console.error(`Error converting XYZ to HSL: ${error}`);
        return defaults.defaultHSL();
    }
}
function xyzToHSVHelper(xyz) {
    try {
        const lab = convert.xyzToLAB(xyz);
        return convert.labToHSV(lab);
    }
    catch (error) {
        console.error(`Error converting XYZ to HSV: ${error}`);
        return defaults.defaultHSV();
    }
}
export const conversionHelpers = {
    applyGammaCorrection,
    clampRGB,
    cmykToXYZHelper,
    convertColorToHex,
    convertColorToHSL,
    hexToCMYKHelper,
    hexToXYZHelper,
    hslAddFormat,
    hslToCMYKHelper,
    hslToHexHelper,
    hslToXYZHelper,
    hsvToCMYKHelper,
    hsvToXYZHelper,
    hueToRGB,
    labToCMYKHelper,
    labToXYZHelper,
    xyzToCMYKHelper,
    xyzToHexHelper,
    xyzToHSLHelper,
    xyzToHSVHelper
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVyc2lvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9oZWxwZXJzL2NvbnZlcnNpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBRy9ELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUU3QyxTQUFTLG9CQUFvQixDQUFDLEtBQWE7SUFDMUMsSUFBSSxDQUFDO1FBQ0osT0FBTyxLQUFLLEdBQUcsU0FBUztZQUN2QixDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxLQUFLO1lBQzFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ2xCLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2hCLE9BQU8sQ0FBQyxLQUFLLENBQUMsb0NBQW9DLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDM0QsT0FBTyxLQUFLLENBQUM7SUFDZCxDQUFDO0FBQ0YsQ0FBQztBQUVELFNBQVMsUUFBUSxDQUFDLEdBQWM7SUFDL0IsSUFBSSxDQUFDO1FBQ0osT0FBTztZQUNOLEtBQUssRUFBRTtnQkFDTixHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO2dCQUM5RCxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FDaEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FDL0M7Z0JBQ0QsSUFB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QUFTLGNBQWMsQ0FBQyxHQUFjO0lBQ3JDLElBQUksQ0FBQztRQUNKLE1BQU0sR0FBRyxHQUFjLE9BQU8sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDN0MsT0FBTyxPQUFPLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2hCLE9BQU8sQ0FBQyxLQUFLLENBQUMsZ0NBQWdDLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDdkQsT0FBTyxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDOUIsQ0FBQztBQUNGLENBQUM7QUFFRCxNQUFNLENBQUMsTUFBTSxpQkFBaUIsR0FBZ0M7SUFDN0Qsb0JBQW9CO0lBQ3BCLFFBQVE7SUFDUixlQUFlO0lBQ2YsaUJBQWlCO0lBQ2pCLGlCQUFpQjtJQUNqQixlQUFlO0lBQ2YsY0FBYztJQUNkLFlBQVk7SUFDWixlQUFlO0lBQ2YsY0FBYztJQUNkLGNBQWM7SUFDZCxlQUFlO0lBQ2YsY0FBYztJQUNkLFFBQVE7SUFDUixlQUFlO0lBQ2YsY0FBYztJQUNkLGVBQWU7SUFDZixjQUFjO0lBQ2QsY0FBYztJQUNkLGNBQWM7Q0FDZCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29udmVydCB9IGZyb20gJy4uL2NvbG9yLWNvbnZlcnNpb24vY29udmVyc2lvbi1pbmRleCc7XG5pbXBvcnQgKiBhcyBmbk9iamVjdHMgZnJvbSAnLi4vaW5kZXgvZm4tb2JqZWN0cyc7XG5pbXBvcnQgKiBhcyB0eXBlcyBmcm9tICcuLi9pbmRleC90eXBlcyc7XG5pbXBvcnQgeyBkZWZhdWx0cyB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRzJztcblxuZnVuY3Rpb24gYXBwbHlHYW1tYUNvcnJlY3Rpb24odmFsdWU6IG51bWJlcik6IG51bWJlciB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHZhbHVlID4gMC4wMDMxMzA4XG5cdFx0XHQ/IDEuMDU1ICogTWF0aC5wb3codmFsdWUsIDEgLyAyLjQpIC0gMC4wNTVcblx0XHRcdDogMTIuOTIgKiB2YWx1ZTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBhcHBseWluZyBnYW1tYSBjb3JyZWN0aW9uOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiB2YWx1ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBjbGFtcFJHQihyZ2I6IHR5cGVzLlJHQik6IHR5cGVzLlJHQiB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdHJlZDogTWF0aC5yb3VuZChNYXRoLm1pbihNYXRoLm1heCgwLCByZ2IudmFsdWUucmVkKSwgMSkgKiAyNTUpLFxuXHRcdFx0XHRncmVlbjogTWF0aC5yb3VuZChcblx0XHRcdFx0XHRNYXRoLm1pbihNYXRoLm1heCgwLCByZ2IudmFsdWUuZ3JlZW4pLCAxKSAqIDI1NVxuXHRcdFx0XHQpLFxuXHRcdFx0XHRibHVlOiBNYXRoLnJvdW5kKE1hdGgubWluKE1hdGgubWF4KDAsIHJnYi52YWx1ZS5ibHVlKSwgMSkgKiAyNTUpXG5cdFx0XHR9LFxuXHRcdFx0Zm9ybWF0OiAncmdiJ1xuXHRcdH07XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY2xhbXBpbmcgUkdCIHZhbHVlczogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gcmdiO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNteWtUb1hZWkhlbHBlcihjbXlrOiB0eXBlcy5DTVlLKTogdHlwZXMuWFlaIHtcblx0dHJ5IHtcblx0XHRjb25zdCByZ2I6IHR5cGVzLlJHQiA9IGNvbnZlcnQuY215a1RvUkdCKGNteWspO1xuXHRcdHJldHVybiBjb252ZXJ0LnJnYlRvWFlaKHJnYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBDTVlLIHRvIFhZWjogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZGVmYXVsdHMuZGVmYXVsdFhZWigpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnRDb2xvclRvSGV4KGNvbG9yOiB0eXBlcy5Db2xvcik6IHR5cGVzLkhleCB8IG51bGwge1xuXHR0cnkge1xuXHRcdHN3aXRjaCAoY29sb3IuZm9ybWF0KSB7XG5cdFx0XHRjYXNlICdjbXlrJzpcblx0XHRcdFx0cmV0dXJuIGNvbnZlcnQuY215a1RvSGV4KGNvbG9yIGFzIHR5cGVzLkNNWUspO1xuXHRcdFx0Y2FzZSAnaGV4Jzpcblx0XHRcdFx0cmV0dXJuIGNvbG9yIGFzIHR5cGVzLkhleDtcblx0XHRcdGNhc2UgJ2hzbCc6XG5cdFx0XHRcdHJldHVybiBjb252ZXJ0LmhzbFRvSGV4KGNvbG9yIGFzIHR5cGVzLkhTTCk7XG5cdFx0XHRjYXNlICdoc3YnOlxuXHRcdFx0XHRyZXR1cm4gY29udmVydC5oc3ZUb0hleChjb2xvciBhcyB0eXBlcy5IU1YpO1xuXHRcdFx0Y2FzZSAnbGFiJzpcblx0XHRcdFx0cmV0dXJuIGNvbnZlcnQubGFiVG9IZXgoY29sb3IgYXMgdHlwZXMuTEFCKTtcblx0XHRcdGNhc2UgJ3JnYic6XG5cdFx0XHRcdHJldHVybiBjb252ZXJ0LnJnYlRvSGV4KGNvbG9yIGFzIHR5cGVzLlJHQik7XG5cdFx0XHRjYXNlICd4eXonOlxuXHRcdFx0XHRyZXR1cm4gY29udmVydC54eXpUb0hleChjb2xvciBhcyB0eXBlcy5YWVopO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y29uc29sZS5lcnJvcignVW5zdXBwb3J0ZWQgY29sb3IgZm9ybWF0Jyk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBjb252ZXJ0aW5nIGNvbG9yIHRvIGhleDogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxufVxuXG5mdW5jdGlvbiBjb252ZXJ0Q29sb3JUb0hTTChjb2xvcjogdHlwZXMuQ29sb3IpOiB0eXBlcy5IU0wgfCBudWxsIHtcblx0dHJ5IHtcblx0XHRzd2l0Y2ggKGNvbG9yLmZvcm1hdCkge1xuXHRcdFx0Y2FzZSAnY215ayc6XG5cdFx0XHRcdHJldHVybiBjb252ZXJ0LmNteWtUb0hTTChjb2xvciBhcyB0eXBlcy5DTVlLKTtcblx0XHRcdGNhc2UgJ2hleCc6XG5cdFx0XHRcdHJldHVybiBjb252ZXJ0LmhleFRvSFNMKGNvbG9yIGFzIHR5cGVzLkhleCk7XG5cdFx0XHRjYXNlICdoc2wnOlxuXHRcdFx0XHRyZXR1cm4gY29sb3IgYXMgdHlwZXMuSFNMO1xuXHRcdFx0Y2FzZSAnaHN2Jzpcblx0XHRcdFx0cmV0dXJuIGNvbnZlcnQuaHN2VG9IU0woY29sb3IgYXMgdHlwZXMuSFNWKTtcblx0XHRcdGNhc2UgJ2xhYic6XG5cdFx0XHRcdHJldHVybiBjb252ZXJ0LmxhYlRvSFNMKGNvbG9yIGFzIHR5cGVzLkxBQik7XG5cdFx0XHRjYXNlICdyZ2InOlxuXHRcdFx0XHRyZXR1cm4gY29udmVydC5yZ2JUb0hTTChjb2xvciBhcyB0eXBlcy5SR0IpO1xuXHRcdFx0Y2FzZSAneHl6Jzpcblx0XHRcdFx0cmV0dXJuIGNvbnZlcnQueHl6VG9IU0woY29sb3IgYXMgdHlwZXMuWFlaKTtcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ1Vuc3VwcG9ydGVkIGNvbG9yIGZvcm1hdCcpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBjb2xvciB0byBIU0w6ICR7ZXJyb3J9YCk7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cbn1cblxuZnVuY3Rpb24gaGV4VG9DTVlLSGVscGVyKGhleDogdHlwZXMuSGV4KTogdHlwZXMuQ01ZSyB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmdiOiB0eXBlcy5SR0IgPSBjb252ZXJ0LmhleFRvUkdCKGhleCk7XG5cdFx0cmV0dXJuIGNvbnZlcnQucmdiVG9DTVlLKHJnYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBoZXggdG8gQ01ZSzogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZGVmYXVsdHMuZGVmYXVsdENNWUsoKTtcblx0fVxufVxuXG5mdW5jdGlvbiBoZXhUb1hZWkhlbHBlcihoZXg6IHR5cGVzLkhleCk6IHR5cGVzLlhZWiB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgbGFiOiB0eXBlcy5MQUIgPSBjb252ZXJ0LmhleFRvTEFCKGhleCk7XG5cdFx0Y29uc3QgeHl6OiB0eXBlcy5YWVogPSBjb252ZXJ0LmxhYlRvWFlaKGxhYik7XG5cdFx0cmV0dXJuIHh5ejtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBjb252ZXJ0aW5nIGhleCB0byBYWVo6ICR7ZXJyb3J9YCk7XG5cdFx0cmV0dXJuIGRlZmF1bHRzLmRlZmF1bHRYWVooKTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaHVlVG9SR0IocDogbnVtYmVyLCBxOiBudW1iZXIsIHQ6IG51bWJlcik6IG51bWJlciB7XG5cdHRyeSB7XG5cdFx0aWYgKHQgPCAwKSB0ICs9IDE7XG5cdFx0aWYgKHQgPiAxKSB0IC09IDE7XG5cdFx0aWYgKHQgPCAxIC8gNikgcmV0dXJuIHAgKyAocSAtIHApICogNiAqIHQ7XG5cdFx0aWYgKHQgPCAxIC8gMikgcmV0dXJuIHE7XG5cdFx0aWYgKHQgPCAyIC8gMykgcmV0dXJuIHAgKyAocSAtIHApICogKDIgLyAzIC0gdCkgKiA2O1xuXG5cdFx0cmV0dXJuIHA7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBodWUgdG8gUkdCOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiAwO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGhzbEFkZEZvcm1hdCh2YWx1ZTogdHlwZXMuSFNMVmFsdWUpOiB0eXBlcy5IU0wge1xuXHR0cnkge1xuXHRcdHJldHVybiB7IHZhbHVlOiB2YWx1ZSwgZm9ybWF0OiAnaHNsJyB9IGFzIHR5cGVzLkhTTDtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBhZGRpbmcgSFNMIGZvcm1hdDogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZGVmYXVsdHMuZGVmYXVsdEhTTCgpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGhzbFRvQ01ZS0hlbHBlcihoc2w6IHR5cGVzLkhTTCk6IHR5cGVzLkNNWUsge1xuXHR0cnkge1xuXHRcdGNvbnN0IHJnYjogdHlwZXMuUkdCID0gY29udmVydC5oc2xUb1JHQihoc2wpO1xuXHRcdHJldHVybiBjb252ZXJ0LnJnYlRvQ01ZSyhyZ2IpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoYEVycm9yIGNvbnZlcnRpbmcgSFNMIHRvIENNWUs6ICR7ZXJyb3J9YCk7XG5cdFx0cmV0dXJuIGRlZmF1bHRzLmRlZmF1bHRDTVlLKCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gaHNsVG9IZXhIZWxwZXIoaHNsOiB0eXBlcy5IU0wpOiB0eXBlcy5IZXgge1xuXHR0cnkge1xuXHRcdGNvbnN0IHJnYjogdHlwZXMuUkdCID0gY29udmVydC5oc2xUb1JHQihoc2wpO1xuXHRcdHJldHVybiBjb252ZXJ0LnJnYlRvSGV4KHJnYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBIU0wgdG8gaGV4OiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0SGV4KCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gaHNsVG9YWVpIZWxwZXIoaHNsOiB0eXBlcy5IU0wpOiB0eXBlcy5YWVoge1xuXHR0cnkge1xuXHRcdGNvbnN0IGxhYjogdHlwZXMuTEFCID0gY29udmVydC5oc2xUb0xBQihoc2wpO1xuXHRcdHJldHVybiBjb252ZXJ0LmxhYlRvWFlaKGxhYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBIU0wgdG8gWFlaOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0WFlaKCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gaHN2VG9DTVlLSGVscGVyKGhzdjogdHlwZXMuSFNWKTogdHlwZXMuQ01ZSyB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmdiOiB0eXBlcy5SR0IgPSBjb252ZXJ0LmhzdlRvUkdCKGhzdik7XG5cdFx0cmV0dXJuIGNvbnZlcnQucmdiVG9DTVlLKHJnYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBIU1YgdG8gQ01ZSzogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZGVmYXVsdHMuZGVmYXVsdENNWUsoKTtcblx0fVxufVxuXG5mdW5jdGlvbiBoc3ZUb1hZWkhlbHBlcihoc3Y6IHR5cGVzLkhTVik6IHR5cGVzLlhZWiB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmdiOiB0eXBlcy5SR0IgPSBjb252ZXJ0LmhzdlRvUkdCKGhzdik7XG5cdFx0cmV0dXJuIGNvbnZlcnQucmdiVG9YWVoocmdiKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBjb252ZXJ0aW5nIEhTViB0byBYWVo6ICR7ZXJyb3J9YCk7XG5cdFx0cmV0dXJuIGRlZmF1bHRzLmRlZmF1bHRYWVooKTtcblx0fVxufVxuXG5mdW5jdGlvbiBsYWJUb0NNWUtIZWxwZXIobGFiOiB0eXBlcy5MQUIpOiB0eXBlcy5DTVlLIHtcblx0dHJ5IHtcblx0XHRjb25zdCByZ2I6IHR5cGVzLlJHQiA9IGNvbnZlcnQubGFiVG9SR0IobGFiKTtcblx0XHRyZXR1cm4gY29udmVydC5yZ2JUb0NNWUsocmdiKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBjb252ZXJ0aW5nIExBQiB0byBDTVlLOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0Q01ZSygpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGxhYlRvWFlaSGVscGVyKGxhYjogdHlwZXMuTEFCKTogdHlwZXMuWFlaIHtcblx0dHJ5IHtcblx0XHRyZXR1cm4gY29udmVydC5sYWJUb1hZWihsYWIpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoYEVycm9yIGNvbnZlcnRpbmcgTEFCIHRvIFhZWjogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZGVmYXVsdHMuZGVmYXVsdFhZWigpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHh5elRvQ01ZS0hlbHBlcih4eXo6IHR5cGVzLlhZWik6IHR5cGVzLkNNWUsge1xuXHR0cnkge1xuXHRcdGNvbnN0IGxhYjogdHlwZXMuTEFCID0gY29udmVydC54eXpUb0xBQih4eXopO1xuXHRcdHJldHVybiBjb252ZXJ0LmxhYlRvQ01ZSyhsYWIpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoYEVycm9yIGNvbnZlcnRpbmcgWFlaIHRvIENNWUs6ICR7ZXJyb3J9YCk7XG5cdFx0cmV0dXJuIGRlZmF1bHRzLmRlZmF1bHRDTVlLKCk7XG5cdH1cbn1cblxuZnVuY3Rpb24geHl6VG9IZXhIZWxwZXIoeHl6OiB0eXBlcy5YWVopOiB0eXBlcy5IZXgge1xuXHR0cnkge1xuXHRcdGNvbnN0IGxhYjogdHlwZXMuTEFCID0gY29udmVydC54eXpUb0xBQih4eXopO1xuXHRcdHJldHVybiBjb252ZXJ0LmxhYlRvSGV4KGxhYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBYWVogdG8gaGV4OiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0SGV4KCk7XG5cdH1cbn1cblxuZnVuY3Rpb24geHl6VG9IU0xIZWxwZXIoeHl6OiB0eXBlcy5YWVopOiB0eXBlcy5IU0wge1xuXHR0cnkge1xuXHRcdGNvbnN0IGxhYjogdHlwZXMuTEFCID0gY29udmVydC54eXpUb0xBQih4eXopO1xuXHRcdHJldHVybiBjb252ZXJ0LmxhYlRvSFNMKGxhYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBYWVogdG8gSFNMOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0SFNMKCk7XG5cdH1cbn1cblxuZnVuY3Rpb24geHl6VG9IU1ZIZWxwZXIoeHl6OiB0eXBlcy5YWVopOiB0eXBlcy5IU1Yge1xuXHR0cnkge1xuXHRcdGNvbnN0IGxhYjogdHlwZXMuTEFCID0gY29udmVydC54eXpUb0xBQih4eXopO1xuXHRcdHJldHVybiBjb252ZXJ0LmxhYlRvSFNWKGxhYik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgY29udmVydGluZyBYWVogdG8gSFNWOiAke2Vycm9yfWApO1xuXHRcdHJldHVybiBkZWZhdWx0cy5kZWZhdWx0SFNWKCk7XG5cdH1cbn1cblxuZXhwb3J0IGNvbnN0IGNvbnZlcnNpb25IZWxwZXJzOiBmbk9iamVjdHMuQ29udmVyc2lvbkhlbHBlcnMgPSB7XG5cdGFwcGx5R2FtbWFDb3JyZWN0aW9uLFxuXHRjbGFtcFJHQixcblx0Y215a1RvWFlaSGVscGVyLFxuXHRjb252ZXJ0Q29sb3JUb0hleCxcblx0Y29udmVydENvbG9yVG9IU0wsXG5cdGhleFRvQ01ZS0hlbHBlcixcblx0aGV4VG9YWVpIZWxwZXIsXG5cdGhzbEFkZEZvcm1hdCxcblx0aHNsVG9DTVlLSGVscGVyLFxuXHRoc2xUb0hleEhlbHBlcixcblx0aHNsVG9YWVpIZWxwZXIsXG5cdGhzdlRvQ01ZS0hlbHBlcixcblx0aHN2VG9YWVpIZWxwZXIsXG5cdGh1ZVRvUkdCLFxuXHRsYWJUb0NNWUtIZWxwZXIsXG5cdGxhYlRvWFlaSGVscGVyLFxuXHR4eXpUb0NNWUtIZWxwZXIsXG5cdHh5elRvSGV4SGVscGVyLFxuXHR4eXpUb0hTTEhlbHBlcixcblx0eHl6VG9IU1ZIZWxwZXJcbn07XG4iXX0=