function asCSS(palette, colorSpace = 'hsl') {
    const css = palette.items
        .map(item => {
        const colorValue = (() => {
            switch (colorSpace) {
                case 'cmyk':
                    return item.cssStrings.cmykCSSString;
                case 'hex':
                    return item.cssStrings.hexCSSString;
                case 'hsl':
                    return item.cssStrings.hslCSSString;
                case 'hsv':
                    return item.cssStrings.hsvCSSString;
                case 'lab':
                    return item.cssStrings.labCSSString;
                case 'rgb':
                    return item.cssStrings.rgbCSSString;
                case 'xyz':
                    return item.cssStrings.xyzCSSString;
                default:
                    return item.cssStrings.hslCSSString;
            }
        })();
        return `
            /* Palette Item: ${item.id} */
            .color-${item.id} {
                cmyk-color: ${item.cssStrings.cmykCSSString};
                hex-color: ${item.cssStrings.hexCSSString};
                hsl-color: ${item.cssStrings.hslCSSString};
                hsv-color: ${item.cssStrings.hsvCSSString};
                lab-color: ${item.cssStrings.labCSSString};
                rgb-color: ${item.cssStrings.rgbCSSString};
                xyz-color: ${item.cssStrings.xyzCSSString};
                background-color: ${colorValue}; /* Use selected color space */
            }
        `;
    })
        .join('\n');
    const blob = new Blob([css], { type: 'text/css' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.css`;
    a.click();
    URL.revokeObjectURL(url);
}
function asJSON(palette) {
    const json = JSON.stringify(palette, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.json`;
    a.click();
    URL.revokeObjectURL(url);
}
function asPNG(palette, colorSpace = 'hsl', paletteName) {
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    const swatchSize = 100;
    const padding = 20;
    const labelHeight = 40;
    const titleHeight = paletteName ? 60 : 0;
    canvas.width = (swatchSize + padding) * palette.items.length + padding;
    canvas.height = swatchSize + labelHeight + titleHeight + 2 * padding;
    if (!context)
        throw new Error('Could not get 2d context');
    context.fillStyle = '#f0f0f0ff';
    context.fillRect(0, 0, canvas.width, canvas.height);
    if (paletteName) {
        context.font = '22px Arial';
        context.fillStyle = '#1e1e1eff';
        context.textAlign = 'center';
        context.fillText(paletteName, canvas.width / 2, padding + titleHeight / 2);
    }
    palette.items.forEach((item, index) => {
        const x = padding + index * (swatchSize + padding);
        const y = padding + titleHeight;
        const fillColor = (() => {
            switch (colorSpace) {
                case 'cmyk':
                    return item.cssStrings.cmykCSSString;
                case 'hex':
                    return item.cssStrings.hexCSSString;
                case 'hsl':
                    return item.cssStrings.hslCSSString;
                case 'hsv':
                    return item.cssStrings.hsvCSSString;
                case 'lab':
                    return item.cssStrings.labCSSString;
                case 'rgb':
                    return item.cssStrings.rgbCSSString;
                case 'xyz':
                    return item.cssStrings.xyzCSSString;
                default:
                    return item.cssStrings.hslCSSString;
            }
        })();
        const colorLabel = fillColor;
        context.fillStyle = fillColor;
        context.fillRect(x, y, swatchSize, swatchSize);
        context.font = '12px Arial';
        context.fillStyle = '#0a0a0aff';
        context.textAlign = 'center';
        context.fillText(colorLabel, x + swatchSize / 2, y + swatchSize + labelHeight - 5);
    });
    canvas.toBlob(blob => {
        if (blob) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `palette_${palette.id}.png`;
            a.click();
            URL.revokeObjectURL(url);
        }
        else {
            console.error('Failed to create PNG blob.');
        }
    }, 'image/png');
}
function asXML(palette) {
    const xmlItems = palette.items
        .map(item => `
		<PaletteItem "${item.id}>
			<Colors>
				<CMYK>${item.colors.cmyk}</CMYK>
				<Hex>${item.colors.hex}</Hex>
				<HSL>${item.colors.hsl}</HSL>
				<HSV>${item.colors.hsv}</HSV>
				<LAB>${item.colors.lab}</LAB>
				<RGB>${item.colors.rgb}</RGB>
				<XYZ>${item.colors.xyz}</XYZ>
			</Colors>
		</PaletteItem>
	`)
        .join('');
    const xml = `
		<Palette ${palette.id}>
			<Flags>
				<EnableAlpha>${palette.flags.enableAlpha}</EnableAlpha>
				<LimitDark>${palette.flags.limitDark}</LimitDark>
				<LimitGray>${palette.flags.limitGray}</LimitGray>
				<LimitLight>${palette.flags.limitLight}</LimitLight>
			</Flags>
			<Metadata>
				<CustomColor>
					<HSLColor>${palette.metadata.customColor ? palette.metadata.customColor.hslColor : null}</HSLColor>
					<ConvertedColors>${palette.metadata.customColor ? palette.metadata.customColor.convertedColors : null}</ConvertedColors>
				</CustomColor>
				<NumBoxes>${palette.metadata.numBoxes}</NumBoxes>
				<PaletteType>${palette.metadata.paletteType}</PaletteType>
			</Metadata>
			${xmlItems}
		</Palette>
	`;
    const blob = new Blob([xml], { type: 'application/xml' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.xml`;
    a.click();
    URL.revokeObjectURL(url);
}
export const exportPalette = {
    asCSS,
    asJSON,
    asPNG,
    asXML
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2RvbS9leHBvcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUEsU0FBUyxLQUFLLENBQ2IsT0FBd0IsRUFDeEIsYUFBZ0MsS0FBSztJQUVyQyxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsS0FBSztTQUN2QixHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDWCxNQUFNLFVBQVUsR0FBRyxDQUFDLEdBQUcsRUFBRTtZQUN4QixRQUFRLFVBQVUsRUFBRSxDQUFDO2dCQUNwQixLQUFLLE1BQU07b0JBQ1YsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQztnQkFDdEMsS0FBSyxLQUFLO29CQUNULE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3JDLEtBQUssS0FBSztvQkFDVCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDO2dCQUNyQyxLQUFLLEtBQUs7b0JBQ1QsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztnQkFDckMsS0FBSyxLQUFLO29CQUNULE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3JDLEtBQUssS0FBSztvQkFDVCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDO2dCQUNyQyxLQUFLLEtBQUs7b0JBQ1QsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztnQkFDckM7b0JBQ0MsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztZQUN0QyxDQUFDO1FBQ0YsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUVMLE9BQU87K0JBQ3FCLElBQUksQ0FBQyxFQUFFO3FCQUNqQixJQUFJLENBQUMsRUFBRTs4QkFDRSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWE7NkJBQzlCLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWTs2QkFDNUIsSUFB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QUFDO0lBQzFELE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEMsTUFBTSxDQUFDLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUV0QyxDQUFDLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztJQUNiLENBQUMsQ0FBQyxRQUFRLEdBQUcsV0FBVyxPQUFPLENBQUMsRUFBRSxNQUFNLENBQUM7SUFDekMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBRVYsR0FBRyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMxQixDQUFDO0FBRUQsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUE0QjtJQUNyRCxLQUFLO0lBQ0wsTUFBTTtJQUNOLEtBQUs7SUFDTCxLQUFLO0NBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNvbG9ycyBmcm9tICcuLi9pbmRleC9jb2xvcnMnO1xuaW1wb3J0ICogYXMgZm5PYmplY3RzIGZyb20gJy4uL2luZGV4L2ZuLW9iamVjdHMnO1xuaW1wb3J0ICogYXMgcGFsZXR0ZSBmcm9tICcuLi9pbmRleC9wYWxldHRlJztcblxuZnVuY3Rpb24gYXNDU1MoXG5cdHBhbGV0dGU6IHBhbGV0dGUuUGFsZXR0ZSxcblx0Y29sb3JTcGFjZTogY29sb3JzLkNvbG9yU3BhY2UgPSAnaHNsJ1xuKTogdm9pZCB7XG5cdGNvbnN0IGNzcyA9IHBhbGV0dGUuaXRlbXNcblx0XHQubWFwKGl0ZW0gPT4ge1xuXHRcdFx0Y29uc3QgY29sb3JWYWx1ZSA9ICgoKSA9PiB7XG5cdFx0XHRcdHN3aXRjaCAoY29sb3JTcGFjZSkge1xuXHRcdFx0XHRcdGNhc2UgJ2NteWsnOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5jbXlrQ1NTU3RyaW5nO1xuXHRcdFx0XHRcdGNhc2UgJ2hleCc6XG5cdFx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLmhleENTU1N0cmluZztcblx0XHRcdFx0XHRjYXNlICdoc2wnOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oc2xDU1NTdHJpbmc7XG5cdFx0XHRcdFx0Y2FzZSAnaHN2Jzpcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaHN2Q1NTU3RyaW5nO1xuXHRcdFx0XHRcdGNhc2UgJ2xhYic6XG5cdFx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLmxhYkNTU1N0cmluZztcblx0XHRcdFx0XHRjYXNlICdyZ2InOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5yZ2JDU1NTdHJpbmc7XG5cdFx0XHRcdFx0Y2FzZSAneHl6Jzpcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MueHl6Q1NTU3RyaW5nO1xuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLmhzbENTU1N0cmluZztcblx0XHRcdFx0fVxuXHRcdFx0fSkoKTtcblxuXHRcdFx0cmV0dXJuIGBcbiAgICAgICAgICAgIC8qIFBhbGV0dGUgSXRlbTogJHtpdGVtLmlkfSAqL1xuICAgICAgICAgICAgLmNvbG9yLSR7aXRlbS5pZH0ge1xuICAgICAgICAgICAgICAgIGNteWstY29sb3I6ICR7aXRlbS5jc3NTdHJpbmdzLmNteWtDU1NTdHJpbmd9O1xuICAgICAgICAgICAgICAgIGhleC1jb2xvcjogJHtpdGVtLmNzc1N0cmluZ3MuaGV4Q1NTU3RyaW5nfTtcbiAgICAgICAgICAgICAgICBoc2wtY29sb3I6ICR7aXRlbS5jc3NTdHJpbmdzLmhzbENTU1N0cmluZ307XG4gICAgICAgICAgICAgICAgaHN2LWNvbG9yOiAke2l0ZW0uY3NzU3RyaW5ncy5oc3ZDU1NTdHJpbmd9O1xuICAgICAgICAgICAgICAgIGxhYi1jb2xvcjogJHtpdGVtLmNzc1N0cmluZ3MubGFiQ1NTU3RyaW5nfTtcbiAgICAgICAgICAgICAgICByZ2ItY29sb3I6ICR7aXRlbS5jc3NTdHJpbmdzLnJnYkNTU1N0cmluZ307XG4gICAgICAgICAgICAgICAgeHl6LWNvbG9yOiAke2l0ZW0uY3NzU3RyaW5ncy54eXpDU1NTdHJpbmd9O1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICR7Y29sb3JWYWx1ZX07IC8qIFVzZSBzZWxlY3RlZCBjb2xvciBzcGFjZSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICBgO1xuXHRcdH0pXG5cdFx0LmpvaW4oJ1xcbicpO1xuXG5cdGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbY3NzXSwgeyB0eXBlOiAndGV4dC9jc3MnIH0pO1xuXHRjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXHRjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXG5cdGEuaHJlZiA9IHVybDtcblx0YS5kb3dubG9hZCA9IGBwYWxldHRlXyR7cGFsZXR0ZS5pZH0uY3NzYDtcblx0YS5jbGljaygpO1xuXG5cdFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbn1cblxuZnVuY3Rpb24gYXNKU09OKHBhbGV0dGU6IHBhbGV0dGUuUGFsZXR0ZSk6IHZvaWQge1xuXHRjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkocGFsZXR0ZSwgbnVsbCwgMik7XG5cdGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbanNvbl0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pO1xuXHRjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXHRjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXG5cdGEuaHJlZiA9IHVybDtcblx0YS5kb3dubG9hZCA9IGBwYWxldHRlXyR7cGFsZXR0ZS5pZH0uanNvbmA7XG5cdGEuY2xpY2soKTtcblxuXHRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG59XG5cbmZ1bmN0aW9uIGFzUE5HKFxuXHRwYWxldHRlOiBwYWxldHRlLlBhbGV0dGUsXG5cdGNvbG9yU3BhY2U6IGNvbG9ycy5Db2xvclNwYWNlID0gJ2hzbCcsXG5cdHBhbGV0dGVOYW1lPzogc3RyaW5nXG4pOiB2b2lkIHtcblx0Y29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cdGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuXHRjb25zdCBzd2F0Y2hTaXplID0gMTAwO1xuXHRjb25zdCBwYWRkaW5nID0gMjA7XG5cdGNvbnN0IGxhYmVsSGVpZ2h0ID0gNDA7XG5cdGNvbnN0IHRpdGxlSGVpZ2h0ID0gcGFsZXR0ZU5hbWUgPyA2MCA6IDA7XG5cblx0Y2FudmFzLndpZHRoID0gKHN3YXRjaFNpemUgKyBwYWRkaW5nKSAqIHBhbGV0dGUuaXRlbXMubGVuZ3RoICsgcGFkZGluZztcblx0Y2FudmFzLmhlaWdodCA9IHN3YXRjaFNpemUgKyBsYWJlbEhlaWdodCArIHRpdGxlSGVpZ2h0ICsgMiAqIHBhZGRpbmc7XG5cblx0aWYgKCFjb250ZXh0KSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBnZXQgMmQgY29udGV4dCcpO1xuXG5cdGNvbnRleHQuZmlsbFN0eWxlID0gJyNmMGYwZjBmZic7XG5cdGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblxuXHRpZiAocGFsZXR0ZU5hbWUpIHtcblx0XHRjb250ZXh0LmZvbnQgPSAnMjJweCBBcmlhbCc7XG5cdFx0Y29udGV4dC5maWxsU3R5bGUgPSAnIzFlMWUxZWZmJztcblx0XHRjb250ZXh0LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuXHRcdGNvbnRleHQuZmlsbFRleHQoXG5cdFx0XHRwYWxldHRlTmFtZSxcblx0XHRcdGNhbnZhcy53aWR0aCAvIDIsXG5cdFx0XHRwYWRkaW5nICsgdGl0bGVIZWlnaHQgLyAyXG5cdFx0KTtcblx0fVxuXG5cdHBhbGV0dGUuaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcblx0XHRjb25zdCB4ID0gcGFkZGluZyArIGluZGV4ICogKHN3YXRjaFNpemUgKyBwYWRkaW5nKTtcblx0XHRjb25zdCB5ID0gcGFkZGluZyArIHRpdGxlSGVpZ2h0O1xuXG5cdFx0Y29uc3QgZmlsbENvbG9yID0gKCgpID0+IHtcblx0XHRcdHN3aXRjaCAoY29sb3JTcGFjZSkge1xuXHRcdFx0XHRjYXNlICdjbXlrJzpcblx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLmNteWtDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ2hleCc6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oZXhDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ2hzbCc6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oc2xDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ2hzdic6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oc3ZDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ2xhYic6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5sYWJDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ3JnYic6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5yZ2JDU1NTdHJpbmc7XG5cdFx0XHRcdGNhc2UgJ3h5eic6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy54eXpDU1NTdHJpbmc7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oc2xDU1NTdHJpbmc7XG5cdFx0XHR9XG5cdFx0fSkoKTtcblxuXHRcdGNvbnN0IGNvbG9yTGFiZWwgPSBmaWxsQ29sb3I7XG5cblx0XHRjb250ZXh0LmZpbGxTdHlsZSA9IGZpbGxDb2xvcjtcblx0XHRjb250ZXh0LmZpbGxSZWN0KHgsIHksIHN3YXRjaFNpemUsIHN3YXRjaFNpemUpO1xuXG5cdFx0Y29udGV4dC5mb250ID0gJzEycHggQXJpYWwnO1xuXHRcdGNvbnRleHQuZmlsbFN0eWxlID0gJyMwYTBhMGFmZic7XG5cdFx0Y29udGV4dC50ZXh0QWxpZ24gPSAnY2VudGVyJztcblx0XHRjb250ZXh0LmZpbGxUZXh0KFxuXHRcdFx0Y29sb3JMYWJlbCxcblx0XHRcdHggKyBzd2F0Y2hTaXplIC8gMixcblx0XHRcdHkgKyBzd2F0Y2hTaXplICsgbGFiZWxIZWlnaHQgLSA1XG5cdFx0KTtcblx0fSk7XG5cblx0Y2FudmFzLnRvQmxvYihibG9iID0+IHtcblx0XHRpZiAoYmxvYikge1xuXHRcdFx0Y29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblx0XHRcdGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cblx0XHRcdGEuaHJlZiA9IHVybDtcblx0XHRcdGEuZG93bmxvYWQgPSBgcGFsZXR0ZV8ke3BhbGV0dGUuaWR9LnBuZ2A7XG5cdFx0XHRhLmNsaWNrKCk7XG5cblx0XHRcdFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBQTkcgYmxvYi4nKTtcblx0XHR9XG5cdH0sICdpbWFnZS9wbmcnKTtcbn1cblxuZnVuY3Rpb24gYXNYTUwocGFsZXR0ZTogcGFsZXR0ZS5QYWxldHRlKTogdm9pZCB7XG5cdGNvbnN0IHhtbEl0ZW1zID0gcGFsZXR0ZS5pdGVtc1xuXHRcdC5tYXAoXG5cdFx0XHRpdGVtID0+IGBcblx0XHQ8UGFsZXR0ZUl0ZW0gXCIke2l0ZW0uaWR9PlxuXHRcdFx0PENvbG9ycz5cblx0XHRcdFx0PENNWUs+JHtpdGVtLmNvbG9ycy5jbXlrfTwvQ01ZSz5cblx0XHRcdFx0PEhleD4ke2l0ZW0uY29sb3JzLmhleH08L0hleD5cblx0XHRcdFx0PEhTTD4ke2l0ZW0uY29sb3JzLmhzbH08L0hTTD5cblx0XHRcdFx0PEhTVj4ke2l0ZW0uY29sb3JzLmhzdn08L0hTVj5cblx0XHRcdFx0PExBQj4ke2l0ZW0uY29sb3JzLmxhYn08L0xBQj5cblx0XHRcdFx0PFJHQj4ke2l0ZW0uY29sb3JzLnJnYn08L1JHQj5cblx0XHRcdFx0PFhZWj4ke2l0ZW0uY29sb3JzLnh5en08L1hZWj5cblx0XHRcdDwvQ29sb3JzPlxuXHRcdDwvUGFsZXR0ZUl0ZW0+XG5cdGBcblx0XHQpXG5cdFx0LmpvaW4oJycpO1xuXHRjb25zdCB4bWwgPSBgXG5cdFx0PFBhbGV0dGUgJHtwYWxldHRlLmlkfT5cblx0XHRcdDxGbGFncz5cblx0XHRcdFx0PEVuYWJsZUFscGhhPiR7cGFsZXR0ZS5mbGFncy5lbmFibGVBbHBoYX08L0VuYWJsZUFscGhhPlxuXHRcdFx0XHQ8TGltaXREYXJrPiR7cGFsZXR0ZS5mbGFncy5saW1pdERhcmt9PC9MaW1pdERhcms+XG5cdFx0XHRcdDxMaW1pdEdyYXk+JHtwYWxldHRlLmZsYWdzLmxpbWl0R3JheX08L0xpbWl0R3JheT5cblx0XHRcdFx0PExpbWl0TGlnaHQ+JHtwYWxldHRlLmZsYWdzLmxpbWl0TGlnaHR9PC9MaW1pdExpZ2h0PlxuXHRcdFx0PC9GbGFncz5cblx0XHRcdDxNZXRhZGF0YT5cblx0XHRcdFx0PEN1c3RvbUNvbG9yPlxuXHRcdFx0XHRcdDxIU0xDb2xvcj4ke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IgPyBwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yLmhzbENvbG9yIDogbnVsbH08L0hTTENvbG9yPlxuXHRcdFx0XHRcdDxDb252ZXJ0ZWRDb2xvcnM+JHtwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yID8gcGFsZXR0ZS5tZXRhZGF0YS5jdXN0b21Db2xvci5jb252ZXJ0ZWRDb2xvcnMgOiBudWxsfTwvQ29udmVydGVkQ29sb3JzPlxuXHRcdFx0XHQ8L0N1c3RvbUNvbG9yPlxuXHRcdFx0XHQ8TnVtQm94ZXM+JHtwYWxldHRlLm1ldGFkYXRhLm51bUJveGVzfTwvTnVtQm94ZXM+XG5cdFx0XHRcdDxQYWxldHRlVHlwZT4ke3BhbGV0dGUubWV0YWRhdGEucGFsZXR0ZVR5cGV9PC9QYWxldHRlVHlwZT5cblx0XHRcdDwvTWV0YWRhdGE+XG5cdFx0XHQke3htbEl0ZW1zfVxuXHRcdDwvUGFsZXR0ZT5cblx0YDtcblxuXHRjb25zdCBibG9iID0gbmV3IEJsb2IoW3htbF0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3htbCcgfSk7XG5cdGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cdGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cblx0YS5ocmVmID0gdXJsO1xuXHRhLmRvd25sb2FkID0gYHBhbGV0dGVfJHtwYWxldHRlLmlkfS54bWxgO1xuXHRhLmNsaWNrKCk7XG5cblx0VVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xufVxuXG5leHBvcnQgY29uc3QgZXhwb3J0UGFsZXR0ZTogZm5PYmplY3RzLkV4cG9ydFBhbGV0dGUgPSB7XG5cdGFzQ1NTLFxuXHRhc0pTT04sXG5cdGFzUE5HLFxuXHRhc1hNTFxufTtcbiJdfQ==