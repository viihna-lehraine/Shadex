export function asCSS(palette, colorSpace = 'hsl') {
    const css = palette.items
        .map(item => {
        const colorValue = (() => {
            switch (colorSpace) {
                case 'cmyk':
                    return item.cssStrings.cmykCSSString;
                case 'hex':
                    return item.cssStrings.hexCSSString;
                case 'hsl':
                    return item.cssStrings.hslCSSString;
                case 'hsv':
                    return item.cssStrings.hsvCSSString;
                case 'lab':
                    return item.cssStrings.labCSSString;
                case 'rgb':
                    return item.cssStrings.rgbCSSString;
                case 'xyz':
                    return item.cssStrings.xyzCSSString;
                default:
                    return item.cssStrings.hslCSSString;
            }
        })();
        return `
            /* Palette Item: ${item.id} */
            .color-${item.id} {
                cmyk-color: ${item.cssStrings.cmykCSSString};
                hex-color: ${item.cssStrings.hexCSSString};
                hsl-color: ${item.cssStrings.hslCSSString};
                hsv-color: ${item.cssStrings.hsvCSSString};
                lab-color: ${item.cssStrings.labCSSString};
                rgb-color: ${item.cssStrings.rgbCSSString};
                xyz-color: ${item.cssStrings.xyzCSSString};
                background-color: ${colorValue}; /* Use selected color space */
            }
        `;
    })
        .join('\n');
    const blob = new Blob([css], { type: 'text/css' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.css`;
    a.click();
    URL.revokeObjectURL(url);
}
export function asJSON(palette) {
    const json = JSON.stringify(palette, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.json`;
    a.click();
    URL.revokeObjectURL(url);
}
export function asPNG(palette, colorSpace = 'hsl', paletteName) {
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    const swatchSize = 100;
    const padding = 20;
    const labelHeight = 40;
    const titleHeight = paletteName ? 60 : 0;
    canvas.width = (swatchSize + padding) * palette.items.length + padding;
    canvas.height = swatchSize + labelHeight + titleHeight + 2 * padding;
    if (!context)
        throw new Error('Could not get 2d context');
    context.fillStyle = '#f0f0f0ff';
    context.fillRect(0, 0, canvas.width, canvas.height);
    if (paletteName) {
        context.font = '22px Arial';
        context.fillStyle = '#1e1e1eff';
        context.textAlign = 'center';
        context.fillText(paletteName, canvas.width / 2, padding + titleHeight / 2);
    }
    palette.items.forEach((item, index) => {
        const x = padding + index * (swatchSize + padding);
        const y = padding + titleHeight;
        const fillColor = (() => {
            switch (colorSpace) {
                case 'cmyk':
                    return item.cssStrings.cmykCSSString;
                case 'hex':
                    return item.cssStrings.hexCSSString;
                case 'hsl':
                    return item.cssStrings.hslCSSString;
                case 'hsv':
                    return item.cssStrings.hsvCSSString;
                case 'lab':
                    return item.cssStrings.labCSSString;
                case 'rgb':
                    return item.cssStrings.rgbCSSString;
                case 'xyz':
                    return item.cssStrings.xyzCSSString;
                default:
                    return item.cssStrings.hslCSSString;
            }
        })();
        const colorLabel = fillColor;
        context.fillStyle = fillColor;
        context.fillRect(x, y, swatchSize, swatchSize);
        context.font = '12px Arial';
        context.fillStyle = '#0a0a0aff';
        context.textAlign = 'center';
        context.fillText(colorLabel, x + swatchSize / 2, y + swatchSize + labelHeight - 5);
    });
    canvas.toBlob(blob => {
        if (blob) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `palette_${palette.id}.png`;
            a.click();
            URL.revokeObjectURL(url);
        }
        else {
            console.error('Failed to create PNG blob.');
        }
    }, 'image/png');
}
export function asXML(palette) {
    const xmlItems = palette.items
        .map(item => `
		<PaletteItem "${item.id}>
			<Colors>
				<CMYK>${item.colors.cmyk}</CMYK>
				<Hex>${item.colors.hex}</Hex>
				<HSL>${item.colors.hsl}</HSL>
				<HSV>${item.colors.hsv}</HSV>
				<LAB>${item.colors.lab}</LAB>
				<RGB>${item.colors.rgb}</RGB>
				<XYZ>${item.colors.xyz}</XYZ>
			</Colors>
		</PaletteItem>
	`)
        .join('');
    const xml = `
		<Palette ${palette.id}>
			<Flags>
				<EnableAlpha>${palette.flags.enableAlpha}</EnableAlpha>
				<LimitDark>${palette.flags.limitDark}</LimitDark>
				<LimitGray>${palette.flags.limitGray}</LimitGray>
				<LimitLight>${palette.flags.limitLight}</LimitLight>
			</Flags>
			<Metadata>
				<CustomColor>
					<HSLColor>${palette.metadata.customColor ? palette.metadata.customColor.hslColor : null}</HSLColor>
					<ConvertedColors>${palette.metadata.customColor ? palette.metadata.customColor.convertedColors : null}</ConvertedColors>
				</CustomColor>
				<NumBoxes>${palette.metadata.numBoxes}</NumBoxes>
				<PaletteType>${palette.metadata.paletteType}</PaletteType>
			</Metadata>
			${xmlItems}
		</Palette>
	`;
    const blob = new Blob([xml], { type: 'application/xml' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `palette_${palette.id}.xml`;
    a.click();
    URL.revokeObjectURL(url);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2RvbS9leHBvcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsTUFBTSxVQUFVLEtBQUssQ0FBQyxPQUFnQixFQUFFLGFBQXlCLEtBQUs7SUFDckUsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEtBQUs7U0FDdkIsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ1gsTUFBTSxVQUFVLEdBQUcsQ0FBQyxHQUFHLEVBQUU7WUFDeEIsUUFBUSxVQUFVLEVBQUUsQ0FBQztnQkFDcEIsS0FBSyxNQUFNO29CQUNWLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUM7Z0JBQ3RDLEtBQUssS0FBSztvQkFDVCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDO2dCQUNyQyxLQUFLLEtBQUs7b0JBQ1QsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztnQkFDckMsS0FBSyxLQUFLO29CQUNULE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3JDLEtBQUssS0FBSztvQkFDVCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDO2dCQUNyQyxLQUFLLEtBQUs7b0JBQ1QsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztnQkFDckMsS0FBSyxLQUFLO29CQUNULE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3JDO29CQUNDLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUM7WUFDdEMsQ0FBQztRQUNGLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFFTCxPQUFPOytCQUNxQixJQUFJLENBQUMsRUFBRTtxQkFDakIsSUFBSSxDQUFDLEVBQUU7OEJBQ0UsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhOzZCQUM5QixJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVk7NkJBQzVC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RSxpQkFBaUIsRUFBRSxDQUFDLENBQUM7SUFDMUQsTUFBTSxHQUFHLEdBQUcsR0FBRyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN0QyxNQUFNLENBQUMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRXRDLENBQUMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO0lBQ2IsQ0FBQyxDQUFDLFFBQVEsR0FBRyxXQUFXLE9BQU8sQ0FBQyxFQUFFLE1BQU0sQ0FBQztJQUN6QyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFFVixHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2xvclNwYWNlIH0gZnJvbSAnLi4vaW5kZXgvY29sb3JzJztcbmltcG9ydCB7IFBhbGV0dGUgfSBmcm9tICcuLi9pbmRleC9wYWxldHRlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFzQ1NTKHBhbGV0dGU6IFBhbGV0dGUsIGNvbG9yU3BhY2U6IENvbG9yU3BhY2UgPSAnaHNsJyk6IHZvaWQge1xuXHRjb25zdCBjc3MgPSBwYWxldHRlLml0ZW1zXG5cdFx0Lm1hcChpdGVtID0+IHtcblx0XHRcdGNvbnN0IGNvbG9yVmFsdWUgPSAoKCkgPT4ge1xuXHRcdFx0XHRzd2l0Y2ggKGNvbG9yU3BhY2UpIHtcblx0XHRcdFx0XHRjYXNlICdjbXlrJzpcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuY215a0NTU1N0cmluZztcblx0XHRcdFx0XHRjYXNlICdoZXgnOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oZXhDU1NTdHJpbmc7XG5cdFx0XHRcdFx0Y2FzZSAnaHNsJzpcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaHNsQ1NTU3RyaW5nO1xuXHRcdFx0XHRcdGNhc2UgJ2hzdic6XG5cdFx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLmhzdkNTU1N0cmluZztcblx0XHRcdFx0XHRjYXNlICdsYWInOlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5sYWJDU1NTdHJpbmc7XG5cdFx0XHRcdFx0Y2FzZSAncmdiJzpcblx0XHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MucmdiQ1NTU3RyaW5nO1xuXHRcdFx0XHRcdGNhc2UgJ3h5eic6XG5cdFx0XHRcdFx0XHRyZXR1cm4gaXRlbS5jc3NTdHJpbmdzLnh5ekNTU1N0cmluZztcblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5oc2xDU1NTdHJpbmc7XG5cdFx0XHRcdH1cblx0XHRcdH0pKCk7XG5cblx0XHRcdHJldHVybiBgXG4gICAgICAgICAgICAvKiBQYWxldHRlIEl0ZW06ICR7aXRlbS5pZH0gKi9cbiAgICAgICAgICAgIC5jb2xvci0ke2l0ZW0uaWR9IHtcbiAgICAgICAgICAgICAgICBjbXlrLWNvbG9yOiAke2l0ZW0uY3NzU3RyaW5ncy5jbXlrQ1NTU3RyaW5nfTtcbiAgICAgICAgICAgICAgICBoZXgtY29sb3I6ICR7aXRlbS5jc3NTdHJpbmdzLmhleENTU1N0cmluZ307XG4gICAgICAgICAgICAgICAgaHNsLWNvbG9yOiAke2l0ZW0uY3NzU3RyaW5ncy5oc2xDU1NTdHJpbmd9O1xuICAgICAgICAgICAgICAgIGhzdi1jb2xvcjogJHtpdGVtLmNzc1N0cmluZ3MuaHN2Q1NTU3RyaW5nfTtcbiAgICAgICAgICAgICAgICBsYWItY29sb3I6ICR7aXRlbS5jc3NTdHJpbmdzLmxhYkNTU1N0cmluZ307XG4gICAgICAgICAgICAgICAgcmdiLWNvbG9yOiAke2l0ZW0uY3NzU3RyaW5ncy5yZ2JDU1NTdHJpbmd9O1xuICAgICAgICAgICAgICAgIHh5ei1jb2xvcjogJHtpdGVtLmNzc1N0cmluZ3MueHl6Q1NTU3RyaW5nfTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke2NvbG9yVmFsdWV9OyAvKiBVc2Ugc2VsZWN0ZWQgY29sb3Igc3BhY2UgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgYDtcblx0XHR9KVxuXHRcdC5qb2luKCdcXG4nKTtcblxuXHRjb25zdCBibG9iID0gbmV3IEJsb2IoW2Nzc10sIHsgdHlwZTogJ3RleHQvY3NzJyB9KTtcblx0Y29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblx0Y29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcblxuXHRhLmhyZWYgPSB1cmw7XG5cdGEuZG93bmxvYWQgPSBgcGFsZXR0ZV8ke3BhbGV0dGUuaWR9LmNzc2A7XG5cdGEuY2xpY2soKTtcblxuXHRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc0pTT04ocGFsZXR0ZTogUGFsZXR0ZSk6IHZvaWQge1xuXHRjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkocGFsZXR0ZSwgbnVsbCwgMik7XG5cdGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbanNvbl0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pO1xuXHRjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXHRjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXG5cdGEuaHJlZiA9IHVybDtcblx0YS5kb3dubG9hZCA9IGBwYWxldHRlXyR7cGFsZXR0ZS5pZH0uanNvbmA7XG5cdGEuY2xpY2soKTtcblxuXHRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc1BORyhcblx0cGFsZXR0ZTogUGFsZXR0ZSxcblx0Y29sb3JTcGFjZTogQ29sb3JTcGFjZSA9ICdoc2wnLFxuXHRwYWxldHRlTmFtZT86IHN0cmluZ1xuKTogdm9pZCB7XG5cdGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cblx0Y29uc3Qgc3dhdGNoU2l6ZSA9IDEwMDtcblx0Y29uc3QgcGFkZGluZyA9IDIwO1xuXHRjb25zdCBsYWJlbEhlaWdodCA9IDQwO1xuXHRjb25zdCB0aXRsZUhlaWdodCA9IHBhbGV0dGVOYW1lID8gNjAgOiAwO1xuXG5cdGNhbnZhcy53aWR0aCA9IChzd2F0Y2hTaXplICsgcGFkZGluZykgKiBwYWxldHRlLml0ZW1zLmxlbmd0aCArIHBhZGRpbmc7XG5cdGNhbnZhcy5oZWlnaHQgPSBzd2F0Y2hTaXplICsgbGFiZWxIZWlnaHQgKyB0aXRsZUhlaWdodCArIDIgKiBwYWRkaW5nO1xuXG5cdGlmICghY29udGV4dCkgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgZ2V0IDJkIGNvbnRleHQnKTtcblxuXHRjb250ZXh0LmZpbGxTdHlsZSA9ICcjZjBmMGYwZmYnO1xuXHRjb250ZXh0LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cblx0aWYgKHBhbGV0dGVOYW1lKSB7XG5cdFx0Y29udGV4dC5mb250ID0gJzIycHggQXJpYWwnO1xuXHRcdGNvbnRleHQuZmlsbFN0eWxlID0gJyMxZTFlMWVmZic7XG5cdFx0Y29udGV4dC50ZXh0QWxpZ24gPSAnY2VudGVyJztcblx0XHRjb250ZXh0LmZpbGxUZXh0KFxuXHRcdFx0cGFsZXR0ZU5hbWUsXG5cdFx0XHRjYW52YXMud2lkdGggLyAyLFxuXHRcdFx0cGFkZGluZyArIHRpdGxlSGVpZ2h0IC8gMlxuXHRcdCk7XG5cdH1cblxuXHRwYWxldHRlLml0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG5cdFx0Y29uc3QgeCA9IHBhZGRpbmcgKyBpbmRleCAqIChzd2F0Y2hTaXplICsgcGFkZGluZyk7XG5cdFx0Y29uc3QgeSA9IHBhZGRpbmcgKyB0aXRsZUhlaWdodDtcblxuXHRcdGNvbnN0IGZpbGxDb2xvciA9ICgoKSA9PiB7XG5cdFx0XHRzd2l0Y2ggKGNvbG9yU3BhY2UpIHtcblx0XHRcdFx0Y2FzZSAnY215ayc6XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW0uY3NzU3RyaW5ncy5jbXlrQ1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICdoZXgnOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaGV4Q1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICdoc2wnOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaHNsQ1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICdoc3YnOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaHN2Q1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICdsYWInOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MubGFiQ1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICdyZ2InOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MucmdiQ1NTU3RyaW5nO1xuXHRcdFx0XHRjYXNlICd4eXonOlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MueHl6Q1NTU3RyaW5nO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHJldHVybiBpdGVtLmNzc1N0cmluZ3MuaHNsQ1NTU3RyaW5nO1xuXHRcdFx0fVxuXHRcdH0pKCk7XG5cblx0XHRjb25zdCBjb2xvckxhYmVsID0gZmlsbENvbG9yO1xuXG5cdFx0Y29udGV4dC5maWxsU3R5bGUgPSBmaWxsQ29sb3I7XG5cdFx0Y29udGV4dC5maWxsUmVjdCh4LCB5LCBzd2F0Y2hTaXplLCBzd2F0Y2hTaXplKTtcblxuXHRcdGNvbnRleHQuZm9udCA9ICcxMnB4IEFyaWFsJztcblx0XHRjb250ZXh0LmZpbGxTdHlsZSA9ICcjMGEwYTBhZmYnO1xuXHRcdGNvbnRleHQudGV4dEFsaWduID0gJ2NlbnRlcic7XG5cdFx0Y29udGV4dC5maWxsVGV4dChcblx0XHRcdGNvbG9yTGFiZWwsXG5cdFx0XHR4ICsgc3dhdGNoU2l6ZSAvIDIsXG5cdFx0XHR5ICsgc3dhdGNoU2l6ZSArIGxhYmVsSGVpZ2h0IC0gNVxuXHRcdCk7XG5cdH0pO1xuXG5cdGNhbnZhcy50b0Jsb2IoYmxvYiA9PiB7XG5cdFx0aWYgKGJsb2IpIHtcblx0XHRcdGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cdFx0XHRjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXG5cdFx0XHRhLmhyZWYgPSB1cmw7XG5cdFx0XHRhLmRvd25sb2FkID0gYHBhbGV0dGVfJHtwYWxldHRlLmlkfS5wbmdgO1xuXHRcdFx0YS5jbGljaygpO1xuXG5cdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgUE5HIGJsb2IuJyk7XG5cdFx0fVxuXHR9LCAnaW1hZ2UvcG5nJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc1hNTChwYWxldHRlOiBQYWxldHRlKTogdm9pZCB7XG5cdGNvbnN0IHhtbEl0ZW1zID0gcGFsZXR0ZS5pdGVtc1xuXHRcdC5tYXAoXG5cdFx0XHRpdGVtID0+IGBcblx0XHQ8UGFsZXR0ZUl0ZW0gXCIke2l0ZW0uaWR9PlxuXHRcdFx0PENvbG9ycz5cblx0XHRcdFx0PENNWUs+JHtpdGVtLmNvbG9ycy5jbXlrfTwvQ01ZSz5cblx0XHRcdFx0PEhleD4ke2l0ZW0uY29sb3JzLmhleH08L0hleD5cblx0XHRcdFx0PEhTTD4ke2l0ZW0uY29sb3JzLmhzbH08L0hTTD5cblx0XHRcdFx0PEhTVj4ke2l0ZW0uY29sb3JzLmhzdn08L0hTVj5cblx0XHRcdFx0PExBQj4ke2l0ZW0uY29sb3JzLmxhYn08L0xBQj5cblx0XHRcdFx0PFJHQj4ke2l0ZW0uY29sb3JzLnJnYn08L1JHQj5cblx0XHRcdFx0PFhZWj4ke2l0ZW0uY29sb3JzLnh5en08L1hZWj5cblx0XHRcdDwvQ29sb3JzPlxuXHRcdDwvUGFsZXR0ZUl0ZW0+XG5cdGBcblx0XHQpXG5cdFx0LmpvaW4oJycpO1xuXHRjb25zdCB4bWwgPSBgXG5cdFx0PFBhbGV0dGUgJHtwYWxldHRlLmlkfT5cblx0XHRcdDxGbGFncz5cblx0XHRcdFx0PEVuYWJsZUFscGhhPiR7cGFsZXR0ZS5mbGFncy5lbmFibGVBbHBoYX08L0VuYWJsZUFscGhhPlxuXHRcdFx0XHQ8TGltaXREYXJrPiR7cGFsZXR0ZS5mbGFncy5saW1pdERhcmt9PC9MaW1pdERhcms+XG5cdFx0XHRcdDxMaW1pdEdyYXk+JHtwYWxldHRlLmZsYWdzLmxpbWl0R3JheX08L0xpbWl0R3JheT5cblx0XHRcdFx0PExpbWl0TGlnaHQ+JHtwYWxldHRlLmZsYWdzLmxpbWl0TGlnaHR9PC9MaW1pdExpZ2h0PlxuXHRcdFx0PC9GbGFncz5cblx0XHRcdDxNZXRhZGF0YT5cblx0XHRcdFx0PEN1c3RvbUNvbG9yPlxuXHRcdFx0XHRcdDxIU0xDb2xvcj4ke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IgPyBwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yLmhzbENvbG9yIDogbnVsbH08L0hTTENvbG9yPlxuXHRcdFx0XHRcdDxDb252ZXJ0ZWRDb2xvcnM+JHtwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yID8gcGFsZXR0ZS5tZXRhZGF0YS5jdXN0b21Db2xvci5jb252ZXJ0ZWRDb2xvcnMgOiBudWxsfTwvQ29udmVydGVkQ29sb3JzPlxuXHRcdFx0XHQ8L0N1c3RvbUNvbG9yPlxuXHRcdFx0XHQ8TnVtQm94ZXM+JHtwYWxldHRlLm1ldGFkYXRhLm51bUJveGVzfTwvTnVtQm94ZXM+XG5cdFx0XHRcdDxQYWxldHRlVHlwZT4ke3BhbGV0dGUubWV0YWRhdGEucGFsZXR0ZVR5cGV9PC9QYWxldHRlVHlwZT5cblx0XHRcdDwvTWV0YWRhdGE+XG5cdFx0XHQke3htbEl0ZW1zfVxuXHRcdDwvUGFsZXR0ZT5cblx0YDtcblxuXHRjb25zdCBibG9iID0gbmV3IEJsb2IoW3htbF0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3htbCcgfSk7XG5cdGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cdGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cblx0YS5ocmVmID0gdXJsO1xuXHRhLmRvd25sb2FkID0gYHBhbGV0dGVfJHtwYWxldHRlLmlkfS54bWxgO1xuXHRhLmNsaWNrKCk7XG5cblx0VVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xufVxuIl19