import { convert } from '../../color-conversion/conversion-index.js';
import { config } from '../../config/constants.js';
function isCMYKTooBright(cmyk) {
    return (cmyk.value.cyan < config.cmykBrightnessThreshold &&
        cmyk.value.magenta < config.cmykBrightnessThreshold &&
        cmyk.value.yellow < config.cmykBrightnessThreshold);
}
export function isCMYKTooDark(cmyk) {
    return cmyk.value.key > config.cmykDarknessThreshold;
}
function isCMYKTooGray(cmyk) {
    return (Math.abs(cmyk.value.cyan - cmyk.value.magenta) <
        config.cmykGrayThreshold &&
        Math.abs(cmyk.value.magenta - cmyk.value.yellow) <
            config.cmykGrayThreshold);
}
function isHexTooBright(hex) {
    const rgb = convert.hexToRGB(hex);
    return isRGBTooBright(rgb);
}
function isHexTooDark(hex) {
    const rgb = convert.hexToRGB(hex);
    return isRGBTooDark(rgb);
}
function isHexTooGray(hex) {
    const rgb = convert.hexToRGB(hex);
    return isRGBTooGray(rgb);
}
function isHSLTooBright(hsl) {
    return hsl.value.lightness > config.hslBrightnessThreshold;
}
function isHSLTooDark(hsl) {
    return hsl.value.lightness < config.hslDarknessThreshold;
}
function isHSLTooGray(hsl) {
    return hsl.value.saturation < config.hslGrayThreshold;
}
function isHSVTooBright(hsv) {
    return (hsv.value.value > config.hsvBrightnessValueThreshold &&
        hsv.value.saturation < config.hsvBrightnessSaturationThreshold);
}
function isHSVTooDark(hsv) {
    return hsv.value.value < config.hsvDarknessThreshold;
}
function isHSVTooGray(hsv) {
    return hsv.value.saturation < config.hsvGrayThreshold;
}
function isLABTooBright(lab) {
    return lab.value.l > config.labBrightnessThreshold;
}
function isLABTooDark(lab) {
    return lab.value.l < config.labDarknessThreshold;
}
function isLABTooGray(lab) {
    return (Math.abs(lab.value.a) < config.labGrayThreshold &&
        Math.abs(lab.value.b) < config.labGrayThreshold);
}
function isRGBTooBright(rgb) {
    return ((rgb.value.red + rgb.value.green + rgb.value.blue) / 3 >
        config.rgbMaxBrightness);
}
function isRGBTooDark(rgb) {
    return ((rgb.value.red + rgb.value.green + rgb.value.blue) / 3 <
        config.rgbMinBrightness);
}
function isRGBTooGray(rgb) {
    return (Math.abs(rgb.value.red - rgb.value.green) < config.rgbGrayThreshold &&
        Math.abs(rgb.value.green - rgb.value.blue) < config.rgbGrayThreshold &&
        Math.abs(rgb.value.red - rgb.value.blue) < config.rgbGrayThreshold);
}
function getLimitChecker(limit) {
    return colorLimits[limit];
}
function isColorInBounds(colors) {
    try {
        return Object.entries(colors).some(([key, color]) => {
            if (!color)
                return false;
            const format = key.toUpperCase();
            const isTooGray = getLimitChecker(`is${format}TooGray`);
            const isTooDark = getLimitChecker(`is${format}TooDark`);
            const isTooBright = getLimitChecker(`is${format}TooBright`);
            return isTooGray(color) || isTooDark(color) || isTooBright(color);
        });
    }
    catch (error) {
        console.error(`Error validating color bounds: ${error}`);
        return false;
    }
}
export const colorLimits = {
    getLimitChecker,
    isCMYKTooBright,
    isCMYKTooDark,
    isCMYKTooGray,
    isColorInBounds,
    isHexTooBright,
    isHexTooDark,
    isHexTooGray,
    isHSLTooBright,
    isHSLTooDark,
    isHSLTooGray,
    isHSVTooBright,
    isHSVTooDark,
    isHSVTooGray,
    isLABTooBright,
    isLABTooDark,
    isLABTooGray,
    isRGBTooBright,
    isRGBTooDark,
    isRGBTooGray
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGltaXRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2RvbS91c2VyLXBhcmFtcy9saW1pdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUtoRCxTQUFTLGVBQWUsQ0FBQyxJQUFnQjtJQUN4QyxPQUFPLENBQ04sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLHVCQUF1QjtRQUNoRCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsdUJBQXVCO1FBQ25ELElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyx1QkFBdUIsQ0FDbEQsQ0FBQztBQUNILENBQUM7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUFDLElBQWdCO0lBQzdDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsTUFBTSxDQUFDLHFCQUFxQixDQUFDO0FBQ3RELENBQUM7QUFFRCxTQUFTLGFBQWEsQ0FBQyxJQUFnQjtJQUN0QyxPQUFPLENBQ04sSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQztRQUM3QyxNQUFNLENBQUMsaUJBQWlCO1FBQ3pCLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7WUFDL0MsTUFBTSxDQUFDLGlCQUFpQixDQUN6QixDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLEdBQWM7SUFDckMsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNsQyxPQUFPLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM1QixDQUFDO0FBRUQsU0FBUyxZQUFZLENBQUMsR0FBYztJQUNuQyxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLENBQUM7QUFFRCxTQUFTLFlBQVksQ0FBQyxHQUFjO0lBQ25DLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEMsT0FBTyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLEdBQWM7SUFDckMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsc0JBQXNCLENBQUM7QUFDNUQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUM7QUFDMUQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsZ0JBQWdCLENBQUM7QUFDdkQsQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLEdBQWM7SUFDckMsT0FBTyxDQUNOLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQywyQkFBMkI7UUFDcEQsR0FBRyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLGdDQUFnQyxDQUM5RCxDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUM7QUFDdEQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsZ0JBQWdCLENBQUM7QUFDdkQsQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLEdBQWM7SUFDckMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsc0JBQXNCLENBQUM7QUFDcEQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUM7QUFDbEQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxDQUNOLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsZ0JBQWdCO1FBQy9DLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsZ0JBQWdCLENBQy9DLENBQUM7QUFDSCxDQUFDO0FBRUQsU0FBUyxjQUFjLENBQUMsR0FBYztJQUNyQyxPQUFPLENBQ04sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7UUFDdEQsTUFBTSxDQUFDLGdCQUFnQixDQUN2QixDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLEdBQWM7SUFDbkMsT0FBTyxDQUNOLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1FBQ3RELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FDdkIsQ0FBQztBQUNILENBQUM7QUFFRCxTQUFTLFlBQVksQ0FBQyxHQUFjO0lBQ25DLE9BQU8sQ0FDTixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsTUFBTSxDQUFDLGdCQUFnQjtRQUNuRSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLGdCQUFnQjtRQUNwRSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixDQUNsRSxDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsZUFBZSxDQUN2QixLQUFRO0lBRVIsT0FBTyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDM0IsQ0FBQztBQUVELFNBQVMsZUFBZSxDQUFDLE1BQWlDO0lBQ3pELElBQUksQ0FBQztRQUNKLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsRUFBRSxFQUFFO1lBQ25ELElBQUksQ0FBQyxLQUFLO2dCQUFFLE9BQU8sS0FBSyxDQUFDO1lBRXpCLE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUVqQyxNQUFNLFNBQVMsR0FBRyxlQUFlLENBQ2hDLEtBQUssTUFBTSxTQUF3QyxDQUNuRCxDQUFDO1lBQ0YsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUNoQyxLQUFLLE1BQU0sU0FBd0MsQ0FDbkQsQ0FBQztZQUNGLE1BQU0sV0FBVyxHQUFHLGVBQWUsQ0FDbEMsS0FBSyxNQUFNLFdBQTBDLENBQ3JELENBQUM7WUFFRixPQUFPLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25FLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDaEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxrQ0FBa0MsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUN6RCxPQUFPLEtBQUssQ0FBQztJQUNkLENBQUM7QUFDRixDQUFDO0FBRUQsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUEwQjtJQUNqRCxlQUFlO0lBQ2YsZUFBZTtJQUNmLGFBQWE7SUFDYixhQUFhO0lBQ2IsZUFBZTtJQUNmLGNBQWM7SUFDZCxZQUFZO0lBQ1osWUFBWTtJQUNaLGNBQWM7SUFDZCxZQUFZO0lBQ1osWUFBWTtJQUNaLGNBQWM7SUFDZCxZQUFZO0lBQ1osWUFBWTtJQUNaLGNBQWM7SUFDZCxZQUFZO0lBQ1osWUFBWTtJQUNaLGNBQWM7SUFDZCxZQUFZO0lBQ1osWUFBWTtDQUNaLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb252ZXJ0IH0gZnJvbSAnLi4vLi4vY29sb3ItY29udmVyc2lvbi9jb252ZXJzaW9uLWluZGV4JztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4uLy4uL2NvbmZpZy9jb25zdGFudHMnO1xuaW1wb3J0ICogYXMgZm5PYmplY3RzIGZyb20gJy4uLy4uL2luZGV4L2ZuLW9iamVjdHMnO1xuaW1wb3J0ICogYXMgaW50ZXJmYWNlcyBmcm9tICcuLi8uLi9pbmRleC9pbnRlcmZhY2VzJztcbmltcG9ydCAqIGFzIHR5cGVzIGZyb20gJy4uLy4uL2luZGV4L3R5cGVzJztcblxuZnVuY3Rpb24gaXNDTVlLVG9vQnJpZ2h0KGNteWs6IHR5cGVzLkNNWUspOiBib29sZWFuIHtcblx0cmV0dXJuIChcblx0XHRjbXlrLnZhbHVlLmN5YW4gPCBjb25maWcuY215a0JyaWdodG5lc3NUaHJlc2hvbGQgJiZcblx0XHRjbXlrLnZhbHVlLm1hZ2VudGEgPCBjb25maWcuY215a0JyaWdodG5lc3NUaHJlc2hvbGQgJiZcblx0XHRjbXlrLnZhbHVlLnllbGxvdyA8IGNvbmZpZy5jbXlrQnJpZ2h0bmVzc1RocmVzaG9sZFxuXHQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDTVlLVG9vRGFyayhjbXlrOiB0eXBlcy5DTVlLKTogYm9vbGVhbiB7XG5cdHJldHVybiBjbXlrLnZhbHVlLmtleSA+IGNvbmZpZy5jbXlrRGFya25lc3NUaHJlc2hvbGQ7XG59XG5cbmZ1bmN0aW9uIGlzQ01ZS1Rvb0dyYXkoY215azogdHlwZXMuQ01ZSyk6IGJvb2xlYW4ge1xuXHRyZXR1cm4gKFxuXHRcdE1hdGguYWJzKGNteWsudmFsdWUuY3lhbiAtIGNteWsudmFsdWUubWFnZW50YSkgPFxuXHRcdFx0Y29uZmlnLmNteWtHcmF5VGhyZXNob2xkICYmXG5cdFx0TWF0aC5hYnMoY215ay52YWx1ZS5tYWdlbnRhIC0gY215ay52YWx1ZS55ZWxsb3cpIDxcblx0XHRcdGNvbmZpZy5jbXlrR3JheVRocmVzaG9sZFxuXHQpO1xufVxuXG5mdW5jdGlvbiBpc0hleFRvb0JyaWdodChoZXg6IHR5cGVzLkhleCk6IGJvb2xlYW4ge1xuXHRjb25zdCByZ2IgPSBjb252ZXJ0LmhleFRvUkdCKGhleCk7XG5cdHJldHVybiBpc1JHQlRvb0JyaWdodChyZ2IpO1xufVxuXG5mdW5jdGlvbiBpc0hleFRvb0RhcmsoaGV4OiB0eXBlcy5IZXgpOiBib29sZWFuIHtcblx0Y29uc3QgcmdiID0gY29udmVydC5oZXhUb1JHQihoZXgpO1xuXHRyZXR1cm4gaXNSR0JUb29EYXJrKHJnYik7XG59XG5cbmZ1bmN0aW9uIGlzSGV4VG9vR3JheShoZXg6IHR5cGVzLkhleCk6IGJvb2xlYW4ge1xuXHRjb25zdCByZ2IgPSBjb252ZXJ0LmhleFRvUkdCKGhleCk7XG5cdHJldHVybiBpc1JHQlRvb0dyYXkocmdiKTtcbn1cblxuZnVuY3Rpb24gaXNIU0xUb29CcmlnaHQoaHNsOiB0eXBlcy5IU0wpOiBib29sZWFuIHtcblx0cmV0dXJuIGhzbC52YWx1ZS5saWdodG5lc3MgPiBjb25maWcuaHNsQnJpZ2h0bmVzc1RocmVzaG9sZDtcbn1cblxuZnVuY3Rpb24gaXNIU0xUb29EYXJrKGhzbDogdHlwZXMuSFNMKTogYm9vbGVhbiB7XG5cdHJldHVybiBoc2wudmFsdWUubGlnaHRuZXNzIDwgY29uZmlnLmhzbERhcmtuZXNzVGhyZXNob2xkO1xufVxuXG5mdW5jdGlvbiBpc0hTTFRvb0dyYXkoaHNsOiB0eXBlcy5IU0wpOiBib29sZWFuIHtcblx0cmV0dXJuIGhzbC52YWx1ZS5zYXR1cmF0aW9uIDwgY29uZmlnLmhzbEdyYXlUaHJlc2hvbGQ7XG59XG5cbmZ1bmN0aW9uIGlzSFNWVG9vQnJpZ2h0KGhzdjogdHlwZXMuSFNWKTogYm9vbGVhbiB7XG5cdHJldHVybiAoXG5cdFx0aHN2LnZhbHVlLnZhbHVlID4gY29uZmlnLmhzdkJyaWdodG5lc3NWYWx1ZVRocmVzaG9sZCAmJlxuXHRcdGhzdi52YWx1ZS5zYXR1cmF0aW9uIDwgY29uZmlnLmhzdkJyaWdodG5lc3NTYXR1cmF0aW9uVGhyZXNob2xkXG5cdCk7XG59XG5cbmZ1bmN0aW9uIGlzSFNWVG9vRGFyayhoc3Y6IHR5cGVzLkhTVik6IGJvb2xlYW4ge1xuXHRyZXR1cm4gaHN2LnZhbHVlLnZhbHVlIDwgY29uZmlnLmhzdkRhcmtuZXNzVGhyZXNob2xkO1xufVxuXG5mdW5jdGlvbiBpc0hTVlRvb0dyYXkoaHN2OiB0eXBlcy5IU1YpOiBib29sZWFuIHtcblx0cmV0dXJuIGhzdi52YWx1ZS5zYXR1cmF0aW9uIDwgY29uZmlnLmhzdkdyYXlUaHJlc2hvbGQ7XG59XG5cbmZ1bmN0aW9uIGlzTEFCVG9vQnJpZ2h0KGxhYjogdHlwZXMuTEFCKTogYm9vbGVhbiB7XG5cdHJldHVybiBsYWIudmFsdWUubCA+IGNvbmZpZy5sYWJCcmlnaHRuZXNzVGhyZXNob2xkO1xufVxuXG5mdW5jdGlvbiBpc0xBQlRvb0RhcmsobGFiOiB0eXBlcy5MQUIpOiBib29sZWFuIHtcblx0cmV0dXJuIGxhYi52YWx1ZS5sIDwgY29uZmlnLmxhYkRhcmtuZXNzVGhyZXNob2xkO1xufVxuXG5mdW5jdGlvbiBpc0xBQlRvb0dyYXkobGFiOiB0eXBlcy5MQUIpOiBib29sZWFuIHtcblx0cmV0dXJuIChcblx0XHRNYXRoLmFicyhsYWIudmFsdWUuYSkgPCBjb25maWcubGFiR3JheVRocmVzaG9sZCAmJlxuXHRcdE1hdGguYWJzKGxhYi52YWx1ZS5iKSA8IGNvbmZpZy5sYWJHcmF5VGhyZXNob2xkXG5cdCk7XG59XG5cbmZ1bmN0aW9uIGlzUkdCVG9vQnJpZ2h0KHJnYjogdHlwZXMuUkdCKTogYm9vbGVhbiB7XG5cdHJldHVybiAoXG5cdFx0KHJnYi52YWx1ZS5yZWQgKyByZ2IudmFsdWUuZ3JlZW4gKyByZ2IudmFsdWUuYmx1ZSkgLyAzID5cblx0XHRjb25maWcucmdiTWF4QnJpZ2h0bmVzc1xuXHQpO1xufVxuXG5mdW5jdGlvbiBpc1JHQlRvb0RhcmsocmdiOiB0eXBlcy5SR0IpOiBib29sZWFuIHtcblx0cmV0dXJuIChcblx0XHQocmdiLnZhbHVlLnJlZCArIHJnYi52YWx1ZS5ncmVlbiArIHJnYi52YWx1ZS5ibHVlKSAvIDMgPFxuXHRcdGNvbmZpZy5yZ2JNaW5CcmlnaHRuZXNzXG5cdCk7XG59XG5cbmZ1bmN0aW9uIGlzUkdCVG9vR3JheShyZ2I6IHR5cGVzLlJHQik6IGJvb2xlYW4ge1xuXHRyZXR1cm4gKFxuXHRcdE1hdGguYWJzKHJnYi52YWx1ZS5yZWQgLSByZ2IudmFsdWUuZ3JlZW4pIDwgY29uZmlnLnJnYkdyYXlUaHJlc2hvbGQgJiZcblx0XHRNYXRoLmFicyhyZ2IudmFsdWUuZ3JlZW4gLSByZ2IudmFsdWUuYmx1ZSkgPCBjb25maWcucmdiR3JheVRocmVzaG9sZCAmJlxuXHRcdE1hdGguYWJzKHJnYi52YWx1ZS5yZWQgLSByZ2IudmFsdWUuYmx1ZSkgPCBjb25maWcucmdiR3JheVRocmVzaG9sZFxuXHQpO1xufVxuXG5mdW5jdGlvbiBnZXRMaW1pdENoZWNrZXI8SyBleHRlbmRzIGtleW9mIGZuT2JqZWN0cy5Db2xvckxpbWl0cz4oXG5cdGxpbWl0OiBLXG4pOiBmbk9iamVjdHMuQ29sb3JMaW1pdHNbS10ge1xuXHRyZXR1cm4gY29sb3JMaW1pdHNbbGltaXRdO1xufVxuXG5mdW5jdGlvbiBpc0NvbG9ySW5Cb3VuZHMoY29sb3JzOiBpbnRlcmZhY2VzLkNvbnZlcnNpb25EYXRhKTogYm9vbGVhbiB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIE9iamVjdC5lbnRyaWVzKGNvbG9ycykuc29tZSgoW2tleSwgY29sb3JdKSA9PiB7XG5cdFx0XHRpZiAoIWNvbG9yKSByZXR1cm4gZmFsc2U7XG5cblx0XHRcdGNvbnN0IGZvcm1hdCA9IGtleS50b1VwcGVyQ2FzZSgpO1xuXG5cdFx0XHRjb25zdCBpc1Rvb0dyYXkgPSBnZXRMaW1pdENoZWNrZXIoXG5cdFx0XHRcdGBpcyR7Zm9ybWF0fVRvb0dyYXlgIGFzIGtleW9mIGZuT2JqZWN0cy5Db2xvckxpbWl0c1xuXHRcdFx0KTtcblx0XHRcdGNvbnN0IGlzVG9vRGFyayA9IGdldExpbWl0Q2hlY2tlcihcblx0XHRcdFx0YGlzJHtmb3JtYXR9VG9vRGFya2AgYXMga2V5b2YgZm5PYmplY3RzLkNvbG9yTGltaXRzXG5cdFx0XHQpO1xuXHRcdFx0Y29uc3QgaXNUb29CcmlnaHQgPSBnZXRMaW1pdENoZWNrZXIoXG5cdFx0XHRcdGBpcyR7Zm9ybWF0fVRvb0JyaWdodGAgYXMga2V5b2YgZm5PYmplY3RzLkNvbG9yTGltaXRzXG5cdFx0XHQpO1xuXG5cdFx0XHRyZXR1cm4gaXNUb29HcmF5KGNvbG9yKSB8fCBpc1Rvb0RhcmsoY29sb3IpIHx8IGlzVG9vQnJpZ2h0KGNvbG9yKTtcblx0XHR9KTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGBFcnJvciB2YWxpZGF0aW5nIGNvbG9yIGJvdW5kczogJHtlcnJvcn1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn1cblxuZXhwb3J0IGNvbnN0IGNvbG9yTGltaXRzOiBmbk9iamVjdHMuQ29sb3JMaW1pdHMgPSB7XG5cdGdldExpbWl0Q2hlY2tlcixcblx0aXNDTVlLVG9vQnJpZ2h0LFxuXHRpc0NNWUtUb29EYXJrLFxuXHRpc0NNWUtUb29HcmF5LFxuXHRpc0NvbG9ySW5Cb3VuZHMsXG5cdGlzSGV4VG9vQnJpZ2h0LFxuXHRpc0hleFRvb0RhcmssXG5cdGlzSGV4VG9vR3JheSxcblx0aXNIU0xUb29CcmlnaHQsXG5cdGlzSFNMVG9vRGFyayxcblx0aXNIU0xUb29HcmF5LFxuXHRpc0hTVlRvb0JyaWdodCxcblx0aXNIU1ZUb29EYXJrLFxuXHRpc0hTVlRvb0dyYXksXG5cdGlzTEFCVG9vQnJpZ2h0LFxuXHRpc0xBQlRvb0RhcmssXG5cdGlzTEFCVG9vR3JheSxcblx0aXNSR0JUb29CcmlnaHQsXG5cdGlzUkdCVG9vRGFyayxcblx0aXNSR0JUb29HcmF5XG59O1xuIl19