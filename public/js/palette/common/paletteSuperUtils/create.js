// File: src/palette/common/paletteSuperUtils/create.ts
import { core, utils } from '../../../common/index.js';
import { IDBManager } from '../../../idb/index.js';
import { paletteHelpers } from '../paletteHelpers/index.js';
import { paletteUtils } from '../paletteUtils/index.js';
const limits = paletteHelpers.limits;
const update = paletteHelpers.update;
const hslTo = paletteUtils.convert.hslTo;
const idb = IDBManager.getInstance();
function baseColor(customColor, enableAlpha) {
    const color = core.base.clone(customColor ?? utils.random.hsl(enableAlpha));
    return color;
}
function paletteItem(color, enableAlpha) {
    const clonedColor = core.base.clone(color);
    clonedColor.value.alpha = enableAlpha
        ? core.brand.asAlphaRange(Math.random())
        : core.brand.asAlphaRange(1);
    return {
        id: `${color.format}_${idb.getNextPaletteID()}`,
        colors: {
            cmyk: hslTo(clonedColor, 'cmyk').value,
            hex: hslTo(clonedColor, 'hex').value,
            hsl: clonedColor.value,
            hsv: hslTo(clonedColor, 'hsv').value,
            lab: hslTo(clonedColor, 'lab').value,
            rgb: hslTo(clonedColor, 'rgb').value,
            xyz: hslTo(clonedColor, 'xyz').value
        },
        colorStrings: {
            cmykString: utils.color.colorToColorString(hslTo(clonedColor, 'cmyk')).value,
            hexString: utils.color.colorToColorString(hslTo(clonedColor, 'hex')).value,
            hslString: utils.color.colorToColorString(clonedColor).value,
            hsvString: utils.color.colorToColorString(hslTo(clonedColor, 'hsv')).value,
            labString: utils.color.colorToColorString(hslTo(clonedColor, 'lab')).value,
            rgbString: utils.color.colorToColorString(hslTo(clonedColor, 'rgb')).value,
            xyzString: utils.color.colorToColorString(hslTo(clonedColor, 'xyz')).value
        },
        cssStrings: {
            cmykCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'cmyk')),
            hexCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'hex')),
            hslCSSString: core.convert.toCSSColorString(clonedColor),
            hsvCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'hsv')),
            labCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'lab')),
            rgbCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'rgb')),
            xyzCSSString: core.convert.toCSSColorString(hslTo(clonedColor, 'xyz'))
        }
    };
}
function paletteItemArray(baseColor, hues, enableAlpha, limitDark, limitGray, limitLight) {
    const paletteItems = [paletteItem(baseColor, enableAlpha)];
    hues.forEach((hue, i) => {
        let newColor = null;
        do {
            const sl = utils.random.sl(enableAlpha);
            newColor = utils.conversion.genAllColorValues({
                value: {
                    hue: core.brand.asRadial(hue),
                    ...sl.value
                },
                format: 'hsl'
            }).hsl;
        } while (newColor &&
            ((limitGray && limits.isTooGray(newColor)) ||
                (limitDark && limits.isTooDark(newColor)) ||
                (limitLight && limits.isTooLight(newColor))));
        if (newColor) {
            paletteItems.push(paletteItem(newColor, enableAlpha));
            update.colorBox(newColor, i + 1);
        }
    });
    return paletteItems;
}
export const create = {
    baseColor,
    paletteItem,
    paletteItemArray
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3BhbGV0dGUvY29tbW9uL3BhbGV0dGVTdXBlclV0aWxzL2NyZWF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx1REFBdUQ7QUFxQnZELE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ25ELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM1RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFeEQsTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLE1BQU0sQ0FBQztBQUNyQyxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsTUFBTSxDQUFDO0FBRXJDLE1BQU0sS0FBSyxHQUFHLFlBQVksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBRXpDLE1BQU0sR0FBRyxHQUFHLFVBQVUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUVyQyxTQUFTLFNBQVMsQ0FBQyxXQUF1QixFQUFFLFdBQW9CO0lBQy9ELE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBRTVFLE9BQU8sS0FBWSxDQUFDO0FBQ3JCLENBQUM7QUFFRCxTQUFTLFdBQVcsQ0FBQyxLQUFVLEVBQUUsV0FBb0I7SUFDcEQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFRLENBQUM7SUFFbEQsV0FBVyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsV0FBVztRQUNwQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFD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QUFDO0lBRUgsT0FBTyxZQUFZLENBQUM7QUFDckIsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLE1BQU0sR0FBb0M7SUFDdEQsU0FBUztJQUNULFdBQVc7SUFDWCxnQkFBZ0I7Q0FDUCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlsZTogc3JjL3BhbGV0dGUvY29tbW9uL3BhbGV0dGVTdXBlclV0aWxzL2NyZWF0ZS50c1xuXG5pbXBvcnQge1xuXHRDTVlLLFxuXHRDTVlLU3RyaW5nLFxuXHRIZXgsXG5cdEhleFN0cmluZyxcblx0SFNMLFxuXHRIU0xTdHJpbmcsXG5cdEhTVixcblx0SFNWU3RyaW5nLFxuXHRMQUIsXG5cdExBQlN0cmluZyxcblx0UGFsZXR0ZUNvbW1vbl9TdXBlclV0aWxzX0NyZWF0ZSxcblx0UGFsZXR0ZUl0ZW0sXG5cdFJHQixcblx0UkdCU3RyaW5nLFxuXHRTTCxcblx0WFlaLFxuXHRYWVpTdHJpbmdcbn0gZnJvbSAnLi4vLi4vLi4vaW5kZXgvaW5kZXguanMnO1xuaW1wb3J0IHsgY29yZSwgdXRpbHMgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vaW5kZXguanMnO1xuaW1wb3J0IHsgSURCTWFuYWdlciB9IGZyb20gJy4uLy4uLy4uL2lkYi9pbmRleC5qcyc7XG5pbXBvcnQgeyBwYWxldHRlSGVscGVycyB9IGZyb20gJy4uL3BhbGV0dGVIZWxwZXJzL2luZGV4LmpzJztcbmltcG9ydCB7IHBhbGV0dGVVdGlscyB9IGZyb20gJy4uL3BhbGV0dGVVdGlscy9pbmRleC5qcyc7XG5cbmNvbnN0IGxpbWl0cyA9IHBhbGV0dGVIZWxwZXJzLmxpbWl0cztcbmNvbnN0IHVwZGF0ZSA9IHBhbGV0dGVIZWxwZXJzLnVwZGF0ZTtcblxuY29uc3QgaHNsVG8gPSBwYWxldHRlVXRpbHMuY29udmVydC5oc2xUbztcblxuY29uc3QgaWRiID0gSURCTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuXG5mdW5jdGlvbiBiYXNlQ29sb3IoY3VzdG9tQ29sb3I6IEhTTCB8IG51bGwsIGVuYWJsZUFscGhhOiBib29sZWFuKTogSFNMIHtcblx0Y29uc3QgY29sb3IgPSBjb3JlLmJhc2UuY2xvbmUoY3VzdG9tQ29sb3IgPz8gdXRpbHMucmFuZG9tLmhzbChlbmFibGVBbHBoYSkpO1xuXG5cdHJldHVybiBjb2xvciBhcyBIU0w7XG59XG5cbmZ1bmN0aW9uIHBhbGV0dGVJdGVtKGNvbG9yOiBIU0wsIGVuYWJsZUFscGhhOiBib29sZWFuKTogUGFsZXR0ZUl0ZW0ge1xuXHRjb25zdCBjbG9uZWRDb2xvciA9IGNvcmUuYmFzZS5jbG9uZShjb2xvcikgYXMgSFNMO1xuXG5cdGNsb25lZENvbG9yLnZhbHVlLmFscGhhID0gZW5hYmxlQWxwaGFcblx0XHQ/IGNvcmUuYnJhbmQuYXNBbHBoYVJhbmdlKE1hdGgucmFuZG9tKCkpXG5cdFx0OiBjb3JlLmJyYW5kLmFzQWxwaGFSYW5nZSgxKTtcblxuXHRyZXR1cm4ge1xuXHRcdGlkOiBgJHtjb2xvci5mb3JtYXR9XyR7aWRiLmdldE5leHRQYWxldHRlSUQoKX1gLFxuXHRcdGNvbG9yczoge1xuXHRcdFx0Y215azogKGhzbFRvKGNsb25lZENvbG9yLCAnY215aycpIGFzIENNWUspLnZhbHVlLFxuXHRcdFx0aGV4OiAoaHNsVG8oY2xvbmVkQ29sb3IsICdoZXgnKSBhcyBIZXgpLnZhbHVlLFxuXHRcdFx0aHNsOiBjbG9uZWRDb2xvci52YWx1ZSxcblx0XHRcdGhzdjogKGhzbFRvKGNsb25lZENvbG9yLCAnaHN2JykgYXMgSFNWKS52YWx1ZSxcblx0XHRcdGxhYjogKGhzbFRvKGNsb25lZENvbG9yLCAnbGFiJykgYXMgTEFCKS52YWx1ZSxcblx0XHRcdHJnYjogKGhzbFRvKGNsb25lZENvbG9yLCAncmdiJykgYXMgUkdCKS52YWx1ZSxcblx0XHRcdHh5ejogKGhzbFRvKGNsb25lZENvbG9yLCAneHl6JykgYXMgWFlaKS52YWx1ZVxuXHRcdH0sXG5cdFx0Y29sb3JTdHJpbmdzOiB7XG5cdFx0XHRjbXlrU3RyaW5nOiAoXG5cdFx0XHRcdHV0aWxzLmNvbG9yLmNvbG9yVG9Db2xvclN0cmluZyhcblx0XHRcdFx0XHRoc2xUbyhjbG9uZWRDb2xvciwgJ2NteWsnKVxuXHRcdFx0XHQpIGFzIENNWUtTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHRoZXhTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAnaGV4Jylcblx0XHRcdFx0KSBhcyBIZXhTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHRoc2xTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKGNsb25lZENvbG9yKSBhcyBIU0xTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHRoc3ZTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAnaHN2Jylcblx0XHRcdFx0KSBhcyBIU1ZTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHRsYWJTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAnbGFiJylcblx0XHRcdFx0KSBhcyBMQUJTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHRyZ2JTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAncmdiJylcblx0XHRcdFx0KSBhcyBSR0JTdHJpbmdcblx0XHRcdCkudmFsdWUsXG5cdFx0XHR4eXpTdHJpbmc6IChcblx0XHRcdFx0dXRpbHMuY29sb3IuY29sb3JUb0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAneHl6Jylcblx0XHRcdFx0KSBhcyBYWVpTdHJpbmdcblx0XHRcdCkudmFsdWVcblx0XHR9LFxuXHRcdGNzc1N0cmluZ3M6IHtcblx0XHRcdGNteWtDU1NTdHJpbmc6IGNvcmUuY29udmVydC50b0NTU0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRoc2xUbyhjbG9uZWRDb2xvciwgJ2NteWsnKVxuXHRcdFx0KSxcblx0XHRcdGhleENTU1N0cmluZzogY29yZS5jb252ZXJ0LnRvQ1NTQ29sb3JTdHJpbmcoXG5cdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAnaGV4Jylcblx0XHRcdCksXG5cdFx0XHRoc2xDU1NTdHJpbmc6IGNvcmUuY29udmVydC50b0NTU0NvbG9yU3RyaW5nKGNsb25lZENvbG9yKSxcblx0XHRcdGhzdkNTU1N0cmluZzogY29yZS5jb252ZXJ0LnRvQ1NTQ29sb3JTdHJpbmcoXG5cdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAnaHN2Jylcblx0XHRcdCksXG5cdFx0XHRsYWJDU1NTdHJpbmc6IGNvcmUuY29udmVydC50b0NTU0NvbG9yU3RyaW5nKFxuXHRcdFx0XHRoc2xUbyhjbG9uZWRDb2xvciwgJ2xhYicpXG5cdFx0XHQpLFxuXHRcdFx0cmdiQ1NTU3RyaW5nOiBjb3JlLmNvbnZlcnQudG9DU1NDb2xvclN0cmluZyhcblx0XHRcdFx0aHNsVG8oY2xvbmVkQ29sb3IsICdyZ2InKVxuXHRcdFx0KSxcblx0XHRcdHh5ekNTU1N0cmluZzogY29yZS5jb252ZXJ0LnRvQ1NTQ29sb3JTdHJpbmcoXG5cdFx0XHRcdGhzbFRvKGNsb25lZENvbG9yLCAneHl6Jylcblx0XHRcdClcblx0XHR9XG5cdH07XG59XG5cbmZ1bmN0aW9uIHBhbGV0dGVJdGVtQXJyYXkoXG5cdGJhc2VDb2xvcjogSFNMLFxuXHRodWVzOiBudW1iZXJbXSxcblx0ZW5hYmxlQWxwaGE6IGJvb2xlYW4sXG5cdGxpbWl0RGFyazogYm9vbGVhbixcblx0bGltaXRHcmF5OiBib29sZWFuLFxuXHRsaW1pdExpZ2h0OiBib29sZWFuXG4pOiBQYWxldHRlSXRlbVtdIHtcblx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW3BhbGV0dGVJdGVtKGJhc2VDb2xvciwgZW5hYmxlQWxwaGEpXTtcblxuXHRodWVzLmZvckVhY2goKGh1ZSwgaSkgPT4ge1xuXHRcdGxldCBuZXdDb2xvcjogSFNMIHwgbnVsbCA9IG51bGw7XG5cblx0XHRkbyB7XG5cdFx0XHRjb25zdCBzbCA9IHV0aWxzLnJhbmRvbS5zbChlbmFibGVBbHBoYSkgYXMgU0w7XG5cdFx0XHRuZXdDb2xvciA9IHV0aWxzLmNvbnZlcnNpb24uZ2VuQWxsQ29sb3JWYWx1ZXMoe1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZTogY29yZS5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdC4uLnNsLnZhbHVlXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdH0pLmhzbCBhcyBIU0w7XG5cdFx0fSB3aGlsZSAoXG5cdFx0XHRuZXdDb2xvciAmJlxuXHRcdFx0KChsaW1pdEdyYXkgJiYgbGltaXRzLmlzVG9vR3JheShuZXdDb2xvcikpIHx8XG5cdFx0XHRcdChsaW1pdERhcmsgJiYgbGltaXRzLmlzVG9vRGFyayhuZXdDb2xvcikpIHx8XG5cdFx0XHRcdChsaW1pdExpZ2h0ICYmIGxpbWl0cy5pc1Rvb0xpZ2h0KG5ld0NvbG9yKSkpXG5cdFx0KTtcblxuXHRcdGlmIChuZXdDb2xvcikge1xuXHRcdFx0cGFsZXR0ZUl0ZW1zLnB1c2gocGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGVuYWJsZUFscGhhKSk7XG5cblx0XHRcdHVwZGF0ZS5jb2xvckJveChuZXdDb2xvciwgaSArIDEpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHBhbGV0dGVJdGVtcztcbn1cblxuZXhwb3J0IGNvbnN0IGNyZWF0ZTogUGFsZXR0ZUNvbW1vbl9TdXBlclV0aWxzX0NyZWF0ZSA9IHtcblx0YmFzZUNvbG9yLFxuXHRwYWxldHRlSXRlbSxcblx0cGFsZXR0ZUl0ZW1BcnJheVxufSBhcyBjb25zdDtcbiJdfQ==