// ColorGen - version 0.6.0-dev
import { config } from './config.js';
import { core } from './common/core.js';
import { utils } from './common.js';
import { addConversionButtonEventListeners, applyCustomColor, defineUIElements, pullParamsFromUI, desaturateColor, saturateColor, showCustomColorPopupDiv } from './dom/main.js';
import { idb } from './idb.js';
import { start } from './palette/start.js';
const consts = config.consts;
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM content loaded - Initializing application');
    const buttons = defineUIElements();
    if (!buttons) {
        console.error('Failed to initialize UI buttons');
        return;
    }
    const selectedColorOption = consts.dom.selectedColorOption;
    const { advancedMenuButton, applyCustomColorButton, clearCustomColorButton, closeCustomColorMenuButton, closeHelpMenuButton, closeHistoryMenuButton, desaturateButton, generateButton, helpMenuButton, historyMenuButton, saturateButton, showAsCMYKButton, showAsHexButton, showAsHSLButton, showAsHSVButton, showAsLABButton, showAsRGBButton } = buttons;
    // confirm that all elements are accessible
    console.log(`Advanced Menu Button: ${advancedMenuButton ? 'found' : 'not found'}\nApply Custom Color Button: ${applyCustomColorButton ? 'found' : 'not found'}\nClear Custom Color Button: ${clearCustomColorButton ? 'found' : 'not found'}\nClose Custom Color Menu Button: ${closeCustomColorMenuButton ? 'found' : 'not found'}\nClose Help Menu Button: ${closeHelpMenuButton ? 'found' : 'not found'}\nClose History Menu Button: ${closeHistoryMenuButton ? 'found' : 'not found'}\nDesaturate Button: ${desaturateButton ? 'found' : 'not found'}\nGenerate Button: ${generateButton ? 'found' : 'not found'}\nHelp Menu Button: ${helpMenuButton ? 'found' : 'not found'}\nHistory Menu Button: ${historyMenuButton ? 'found' : 'not found'}\nSaturate Button: ${saturateButton ? 'found' : 'not found'}\nShow as CMYK Button: ${showAsCMYKButton ? 'found' : 'not found'}\nShow as Hex Button: ${showAsHexButton ? 'found' : 'not found'}\nShow as HSL Button: ${showAsHSLButton ? 'found' : 'not found'}\nShow as HSV Button: ${showAsHSVButton ? 'found' : 'not found'}\nShow as LAB Button: ${showAsLABButton ? 'found' : 'not found'}\nShow as RGB Button: ${showAsRGBButton ? 'found' : 'not found'}`);
    const selectedColor = selectedColorOption
        ? parseInt(selectedColorOption.value, 10)
        : 0;
    console.log(`Selected color: ${selectedColor}`);
    try {
        addConversionButtonEventListeners();
        console.log('Conversion button event listeners attached');
    }
    catch (error) {
        console.error(`Unable to attach conversion button event listeners: ${error}`);
    }
    advancedMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        const advancedMenuContent = document.querySelector('.advanced-menu-content');
        if (advancedMenuContent) {
            const isHidden = getComputedStyle(advancedMenuContent).display === 'none';
            advancedMenuContent.style.display = isHidden ? 'flex' : 'none';
        }
        console.log('advancedMenuToggleButton clicked');
    });
    applyCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        const customHSLColor = applyCustomColor();
        const customHSLColorClone = core.clone(customHSLColor);
        await idb.saveData('customColor', 'appSettings', customHSLColorClone);
        console.log('Custom color saved to IndexedDB');
    });
    clearCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        await idb.deleteTable('customColor');
        console.log('Custom color cleared from IndexedDB');
        showCustomColorPopupDiv();
    });
    closeCustomColorMenuButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        console.log('closeCustomColorMenuButton clicked');
    });
    closeHelpMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('closeHelpMenuButton clicked');
    });
    closeHistoryMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('closeHistoryMenuButton clicked');
    });
    desaturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('desaturateButton clicked');
        desaturateColor(selectedColor);
    });
    generateButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        console.log('generateButton clicked');
        const { paletteType, numBoxes, enableAlpha, limitDarkness, limitGrayness, limitLightness } = pullParamsFromUI();
        let customColor = (await idb.getCustomColor());
        if (!customColor) {
            console.info('No custom color found. Using a random color');
            customColor = utils.random.hsl(true);
        }
        const paletteOptions = {
            paletteType,
            numBoxes,
            customColor: core.clone(customColor),
            enableAlpha,
            limitDarkness,
            limitGrayness,
            limitLightness
        };
        await start.paletteGen(paletteOptions);
    });
    helpMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        const helpMenuContent = document.querySelector('.help-menu-content');
        if (helpMenuContent) {
            const isHidden = getComputedStyle(helpMenuContent).display === 'none';
            helpMenuContent.style.display = isHidden ? 'flex' : 'none';
        }
        console.log('helpMenuToggleButton clicked');
    });
    historyMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        const historyMenuContent = document.querySelector('history-menu-content');
        if (historyMenuContent) {
            const isHidden = getComputedStyle(historyMenuContent).display === 'none';
            historyMenuContent.style.display = isHidden ? 'flex' : 'none';
        }
        console.log('historyMenuToggleButton clicked');
    });
    saturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('saturateButton clicked');
        saturateColor(selectedColor);
    });
    showAsCMYKButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsCMYKButton clicked');
    });
    showAsHexButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHexButton clicked');
    });
    showAsHSLButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHSLButton clicked');
    });
    showAsHSVButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHSVButton clicked');
    });
    showAsLABButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsLABButton clicked');
    });
    showAsRGBButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsRGBButton clicked');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFBK0I7QUFVL0IsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUNsQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDakMsT0FBTyxFQUNOLGlDQUFpQyxFQUNqQyxnQkFBZ0IsRUFDaEIsZ0JBQWdCLEVBQ2hCLGdCQUFnQixFQUNoQixlQUFlLEVBQ2YsYUFBYSxFQUNiLHVCQUF1QixFQUN2QixNQUFNLFlBQVksQ0FBQztBQUNwQixPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sT0FBTyxDQUFDO0FBQzVCLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUV4QyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO0FBRTdCLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDbEQsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0lBRTdELE1BQU0sT0FBTyxHQUFHLGdCQUFnQixFQUFFLENBQUM7SUFFbkMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2QsT0FBTyxDQUFDLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1FBQ2pELE9BQU87SUFDUixDQUFDO0lBRUQsTUFBTSxtQkFBbUIsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDO0lBRTNELE1BQU0sRUFDTCxrQkFBa0IsRUFDbEIsc0JBQXNCLEVBQ3RCLHNCQUFzQixFQUN0QiwwQkFBMEIsRUFDMUIsbUJBQW1CLEVBQ25CLHNCQUFzQixFQUN0QixnQkFBZ0IsRUFDaEIsY0FBYyxFQUNkLGNBQWMsRUFDZCxpQkFBaUIsRUFDakIsY0FBYyxF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QyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRW5CLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUMsQ0FBQztJQUN4QyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29sb3JHZW4gLSB2ZXJzaW9uIDAuNi4wLWRldlxuXG4vLyBBdXRob3I6IFZpaWhuYSBMZXJhaW5lICh2aWlobmFAVmlpaG5hVGVjaC5jb20gLyB2aWlobmEuNzggKFNpZ25hbCkgLyBWaWlobmEtTGVocmFpbmUgKEdpdGh1YikpXG4vLyBMaWNlbnNlZCB1bmRlciBHTlUgR1BMdjMgKGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLTMuMC5odG1sKVxuXG4vLyBZb3UgbWF5IHVzZSB0aGlzIGNvZGUgZm9yIGFueSBwdXJwb3NlIEVYQ0VQVCBmb3IgdGhlIGNyZWF0aW9uIG9mIHByb3ByaWV0YXJ5IGRlcml2YXRpdmVzLiBJIGVuY291cmFnZSB5b3UgdG8gaW1wcm92ZSBvbiBteSBjb2RlIG9yIHRvIGluY2x1ZGUgaXQgaW4gb3RoZXIgcHJvamVjdHMgaWYgeW91IGZpbmQgaXQgaGVscGZ1bC4gUGxlYXNlIGNyZWRpdCBtZSBhcyB0aGUgb3JpZ2luYWwgYXV0aG9yLlxuXG4vLyBUaGlzIGFwcGxpY2F0aW9uIGNvbWVzIHdpdGggQUJTT0xVVEVMWSBOTyBXQVJSQU5UWSBPUiBHVUFSQU5URUUgT0YgQU5ZIEtJTkQuXG5cbmltcG9ydCB7IEhTTCwgUGFsZXR0ZU9wdGlvbnMgfSBmcm9tICcuL2luZGV4L2NvbG9ycyc7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgeyBjb3JlIH0gZnJvbSAnLi9jb21tb24vY29yZSc7XG5pbXBvcnQgeyB1dGlscyB9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCB7XG5cdGFkZENvbnZlcnNpb25CdXR0b25FdmVudExpc3RlbmVycyxcblx0YXBwbHlDdXN0b21Db2xvcixcblx0ZGVmaW5lVUlFbGVtZW50cyxcblx0cHVsbFBhcmFtc0Zyb21VSSxcblx0ZGVzYXR1cmF0ZUNvbG9yLFxuXHRzYXR1cmF0ZUNvbG9yLFxuXHRzaG93Q3VzdG9tQ29sb3JQb3B1cERpdlxufSBmcm9tICcuL2RvbS9tYWluJztcbmltcG9ydCB7IGlkYiB9IGZyb20gJy4vaWRiJztcbmltcG9ydCB7IHN0YXJ0IH0gZnJvbSAnLi9wYWxldHRlL3N0YXJ0JztcblxuY29uc3QgY29uc3RzID0gY29uZmlnLmNvbnN0cztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcblx0Y29uc29sZS5sb2coJ0RPTSBjb250ZW50IGxvYWRlZCAtIEluaXRpYWxpemluZyBhcHBsaWNhdGlvbicpO1xuXG5cdGNvbnN0IGJ1dHRvbnMgPSBkZWZpbmVVSUVsZW1lbnRzKCk7XG5cblx0aWYgKCFidXR0b25zKSB7XG5cdFx0Y29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgVUkgYnV0dG9ucycpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHNlbGVjdGVkQ29sb3JPcHRpb24gPSBjb25zdHMuZG9tLnNlbGVjdGVkQ29sb3JPcHRpb247XG5cblx0Y29uc3Qge1xuXHRcdGFkdmFuY2VkTWVudUJ1dHRvbixcblx0XHRhcHBseUN1c3RvbUNvbG9yQnV0dG9uLFxuXHRcdGNsZWFyQ3VzdG9tQ29sb3JCdXR0b24sXG5cdFx0Y2xvc2VDdXN0b21Db2xvck1lbnVCdXR0b24sXG5cdFx0Y2xvc2VIZWxwTWVudUJ1dHRvbixcblx0XHRjbG9zZUhpc3RvcnlNZW51QnV0dG9uLFxuXHRcdGRlc2F0dXJhdGVCdXR0b24sXG5cdFx0Z2VuZXJhdGVCdXR0b24sXG5cdFx0aGVscE1lbnVCdXR0b24sXG5cdFx0aGlzdG9yeU1lbnVCdXR0b24sXG5cdFx0c2F0dXJhdGVCdXR0b24sXG5cdFx0c2hvd0FzQ01ZS0J1dHRvbixcblx0XHRzaG93QXNIZXhCdXR0b24sXG5cdFx0c2hvd0FzSFNMQnV0dG9uLFxuXHRcdHNob3dBc0hTVkJ1dHRvbixcblx0XHRzaG93QXNMQUJCdXR0b24sXG5cdFx0c2hvd0FzUkdCQnV0dG9uXG5cdH0gPSBidXR0b25zO1xuXG5cdC8vIGNvbmZpcm0gdGhhdCBhbGwgZWxlbWVudHMgYXJlIGFjY2Vzc2libGVcblx0Y29uc29sZS5sb2coXG5cdFx0YEFkdmFuY2VkIE1lbnUgQnV0dG9uOiAke2FkdmFuY2VkTWVudUJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5BcHBseSBDdXN0b20gQ29sb3IgQnV0dG9uOiAke2FwcGx5Q3VzdG9tQ29sb3JCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuQ2xlYXIgQ3VzdG9tIENvbG9yIEJ1dHRvbjogJHtjbGVhckN1c3RvbUNvbG9yQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkNsb3NlIEN1c3RvbSBDb2xvciBNZW51IEJ1dHRvbjogJHtjbG9zZUN1c3RvbUNvbG9yTWVudUJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5DbG9zZSBIZWxwIE1lbnUgQnV0dG9uOiAke2Nsb3NlSGVscE1lbnVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuQ2xvc2UgSGlzdG9yeSBNZW51IEJ1dHRvbjogJHtjbG9zZUhpc3RvcnlNZW51QnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkRlc2F0dXJhdGUgQnV0dG9uOiAke2Rlc2F0dXJhdGVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuR2VuZXJhdGUgQnV0dG9uOiAke2dlbmVyYXRlQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkhlbHAgTWVudSBCdXR0b246ICR7aGVscE1lbnVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuSGlzdG9yeSBNZW51IEJ1dHRvbjogJHtoaXN0b3J5TWVudUJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5TYXR1cmF0ZSBCdXR0b246ICR7c2F0dXJhdGVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBhcyBDTVlLIEJ1dHRvbjogJHtzaG93QXNDTVlLQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblNob3cgYXMgSGV4IEJ1dHRvbjogJHtzaG93QXNIZXhCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBhcyBIU0wgQnV0dG9uOiAke3Nob3dBc0hTTEJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5TaG93IGFzIEhTViBCdXR0b246ICR7c2hvd0FzSFNWQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblNob3cgYXMgTEFCIEJ1dHRvbjogJHtzaG93QXNMQUJCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBhcyBSR0IgQnV0dG9uOiAke3Nob3dBc1JHQkJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31gXG5cdCk7XG5cblx0Y29uc3Qgc2VsZWN0ZWRDb2xvciA9IHNlbGVjdGVkQ29sb3JPcHRpb25cblx0XHQ/IHBhcnNlSW50KHNlbGVjdGVkQ29sb3JPcHRpb24udmFsdWUsIDEwKVxuXHRcdDogMDtcblxuXHRjb25zb2xlLmxvZyhgU2VsZWN0ZWQgY29sb3I6ICR7c2VsZWN0ZWRDb2xvcn1gKTtcblxuXHR0cnkge1xuXHRcdGFkZENvbnZlcnNpb25CdXR0b25FdmVudExpc3RlbmVycygpO1xuXG5cdFx0Y29uc29sZS5sb2coJ0NvbnZlcnNpb24gYnV0dG9uIGV2ZW50IGxpc3RlbmVycyBhdHRhY2hlZCcpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoXG5cdFx0XHRgVW5hYmxlIHRvIGF0dGFjaCBjb252ZXJzaW9uIGJ1dHRvbiBldmVudCBsaXN0ZW5lcnM6ICR7ZXJyb3J9YFxuXHRcdCk7XG5cdH1cblxuXHRhZHZhbmNlZE1lbnVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc3QgYWR2YW5jZWRNZW51Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHQnLmFkdmFuY2VkLW1lbnUtY29udGVudCdcblx0XHQpIGFzIEhUTUxFbGVtZW50IHwgbnVsbDtcblxuXHRcdGlmIChhZHZhbmNlZE1lbnVDb250ZW50KSB7XG5cdFx0XHRjb25zdCBpc0hpZGRlbiA9XG5cdFx0XHRcdGdldENvbXB1dGVkU3R5bGUoYWR2YW5jZWRNZW51Q29udGVudCkuZGlzcGxheSA9PT0gJ25vbmUnO1xuXG5cdFx0XHRhZHZhbmNlZE1lbnVDb250ZW50LnN0eWxlLmRpc3BsYXkgPSBpc0hpZGRlbiA/ICdmbGV4JyA6ICdub25lJztcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZygnYWR2YW5jZWRNZW51VG9nZ2xlQnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0YXBwbHlDdXN0b21Db2xvckJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zdCBjdXN0b21IU0xDb2xvciA9IGFwcGx5Q3VzdG9tQ29sb3IoKTtcblx0XHRjb25zdCBjdXN0b21IU0xDb2xvckNsb25lOiBIU0wgPSBjb3JlLmNsb25lKGN1c3RvbUhTTENvbG9yKTtcblxuXHRcdGF3YWl0IGlkYi5zYXZlRGF0YSgnY3VzdG9tQ29sb3InLCAnYXBwU2V0dGluZ3MnLCBjdXN0b21IU0xDb2xvckNsb25lKTtcblxuXHRcdGNvbnNvbGUubG9nKCdDdXN0b20gY29sb3Igc2F2ZWQgdG8gSW5kZXhlZERCJyk7XG5cdH0pO1xuXG5cdGNsZWFyQ3VzdG9tQ29sb3JCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0YXdhaXQgaWRiLmRlbGV0ZVRhYmxlKCdjdXN0b21Db2xvcicpO1xuXG5cdFx0Y29uc29sZS5sb2coJ0N1c3RvbSBjb2xvciBjbGVhcmVkIGZyb20gSW5kZXhlZERCJyk7XG5cblx0XHRzaG93Q3VzdG9tQ29sb3JQb3B1cERpdigpO1xuXHR9KTtcblxuXHRjbG9zZUN1c3RvbUNvbG9yTWVudUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnY2xvc2VDdXN0b21Db2xvck1lbnVCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRjbG9zZUhlbHBNZW51QnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnNvbGUubG9nKCdjbG9zZUhlbHBNZW51QnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0Y2xvc2VIaXN0b3J5TWVudUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnY2xvc2VIaXN0b3J5TWVudUJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdGRlc2F0dXJhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ2Rlc2F0dXJhdGVCdXR0b24gY2xpY2tlZCcpO1xuXG5cdFx0ZGVzYXR1cmF0ZUNvbG9yKHNlbGVjdGVkQ29sb3IpO1xuXHR9KTtcblxuXHRnZW5lcmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnZ2VuZXJhdGVCdXR0b24gY2xpY2tlZCcpO1xuXG5cdFx0Y29uc3Qge1xuXHRcdFx0cGFsZXR0ZVR5cGUsXG5cdFx0XHRudW1Cb3hlcyxcblx0XHRcdGVuYWJsZUFscGhhLFxuXHRcdFx0bGltaXREYXJrbmVzcyxcblx0XHRcdGxpbWl0R3JheW5lc3MsXG5cdFx0XHRsaW1pdExpZ2h0bmVzc1xuXHRcdH0gPSBwdWxsUGFyYW1zRnJvbVVJKCk7XG5cblx0XHRsZXQgY3VzdG9tQ29sb3IgPSAoYXdhaXQgaWRiLmdldEN1c3RvbUNvbG9yKCkpIGFzIEhTTCB8IG51bGw7XG5cblx0XHRpZiAoIWN1c3RvbUNvbG9yKSB7XG5cdFx0XHRjb25zb2xlLmluZm8oJ05vIGN1c3RvbSBjb2xvciBmb3VuZC4gVXNpbmcgYSByYW5kb20gY29sb3InKTtcblxuXHRcdFx0Y3VzdG9tQ29sb3IgPSB1dGlscy5yYW5kb20uaHNsKHRydWUpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHBhbGV0dGVPcHRpb25zOiBQYWxldHRlT3B0aW9ucyA9IHtcblx0XHRcdHBhbGV0dGVUeXBlLFxuXHRcdFx0bnVtQm94ZXMsXG5cdFx0XHRjdXN0b21Db2xvcjogY29yZS5jbG9uZShjdXN0b21Db2xvciksXG5cdFx0XHRlbmFibGVBbHBoYSxcblx0XHRcdGxpbWl0RGFya25lc3MsXG5cdFx0XHRsaW1pdEdyYXluZXNzLFxuXHRcdFx0bGltaXRMaWdodG5lc3Ncblx0XHR9O1xuXG5cdFx0YXdhaXQgc3RhcnQucGFsZXR0ZUdlbihwYWxldHRlT3B0aW9ucyk7XG5cdH0pO1xuXG5cdGhlbHBNZW51QnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnN0IGhlbHBNZW51Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHQnLmhlbHAtbWVudS1jb250ZW50J1xuXHRcdCkgYXMgSFRNTEVsZW1lbnQgfCBudWxsO1xuXG5cdFx0aWYgKGhlbHBNZW51Q29udGVudCkge1xuXHRcdFx0Y29uc3QgaXNIaWRkZW4gPVxuXHRcdFx0XHRnZXRDb21wdXRlZFN0eWxlKGhlbHBNZW51Q29udGVudCkuZGlzcGxheSA9PT0gJ25vbmUnO1xuXG5cdFx0XHRoZWxwTWVudUNvbnRlbnQuc3R5bGUuZGlzcGxheSA9IGlzSGlkZGVuID8gJ2ZsZXgnIDogJ25vbmUnO1xuXHRcdH1cblxuXHRcdGNvbnNvbGUubG9nKCdoZWxwTWVudVRvZ2dsZUJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdGhpc3RvcnlNZW51QnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnN0IGhpc3RvcnlNZW51Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHQnaGlzdG9yeS1tZW51LWNvbnRlbnQnXG5cdFx0KSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG5cblx0XHRpZiAoaGlzdG9yeU1lbnVDb250ZW50KSB7XG5cdFx0XHRjb25zdCBpc0hpZGRlbiA9XG5cdFx0XHRcdGdldENvbXB1dGVkU3R5bGUoaGlzdG9yeU1lbnVDb250ZW50KS5kaXNwbGF5ID09PSAnbm9uZSc7XG5cblx0XHRcdGhpc3RvcnlNZW51Q29udGVudC5zdHlsZS5kaXNwbGF5ID0gaXNIaWRkZW4gPyAnZmxleCcgOiAnbm9uZSc7XG5cdFx0fVxuXG5cdFx0Y29uc29sZS5sb2coJ2hpc3RvcnlNZW51VG9nZ2xlQnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0c2F0dXJhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ3NhdHVyYXRlQnV0dG9uIGNsaWNrZWQnKTtcblxuXHRcdHNhdHVyYXRlQ29sb3Ioc2VsZWN0ZWRDb2xvcik7XG5cdH0pO1xuXG5cdHNob3dBc0NNWUtCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ3Nob3dBc0NNWUtCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzaG93QXNIZXhCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ3Nob3dBc0hleEJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdHNob3dBc0hTTEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2hvd0FzSFNMQnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0c2hvd0FzSFNWQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnNvbGUubG9nKCdzaG93QXNIU1ZCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzaG93QXNMQUJCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ3Nob3dBc0xBQkJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdHNob3dBc1JHQkJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2hvd0FzUkdCQnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG59KTtcbiJdfQ==