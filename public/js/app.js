// ColorGen - version 0.6.0-dev
// Author: Viihna Leraine (viihna@ViihnaTech.com / viihna.78 (Signal) / Viihna-Lehraine (Github))
// Licensed under GNU GPLv3 (https://www.gnu.org/licenses/gpl-3.0.html)
// You may use this code for any purpose EXCEPT for the creation of proprietary derivatives. I encourage you to improve on my code or to include it in other projects if you find it helpful. Please credit me as the original author.
// This application comes with ABSOLUTELY NO WARRANTY OR GUARANTEE OF ANY KIND.
import { domHelpers } from './helpers/dom.js';
import { applyCustomColor, desaturateColor, saturateColor, showCustomColorPopupDiv } from './dom/dom-main.js';
import { paletteHelpers } from './helpers/palette.js';
import { parseColorValue } from './utils/transforms.js';
import { storage } from './dom/storage.js';
let customColor = null;
function getElement(id) {
    return document.getElementById(id);
}
// applies all event listeners when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    console.log('app.js - DOM content loaded; initializing application');
    // defines the buttons within the main UI
    const generateButton = getElement('generate-button');
    const saturateButton = getElement('saturate-button');
    const desaturateButton = getElement('desaturate-button');
    const popupDivButton = getElement('custom-color-button');
    const applyCustomColorButton = getElement('apply-custom-color-button');
    const clearCustomColorButton = getElement('clear-custom-color-button');
    const advancedMenuToggleButton = getElement('advanced-menu-toggle-button');
    const applyInitialColorSpaceButton = getElement('apply-initial-color-space-button');
    const selectedColorOptions = getElement('selected-color-options');
    const selectedColor = selectedColorOptions
        ? parseInt(selectedColorOptions.value, 10)
        : 0;
    domHelpers.addConversionButtonEventListeners();
    generateButton?.addEventListener('click', e => {
        e.preventDefault();
        const { paletteType, numBoxes, initialColorSpace } = domHelpers.pullParamsFromUI();
        const colorValue = customColor
            ? parseColorValue(customColor.format, customColor.value)
            : null;
        paletteHelpers.genPalette(paletteType, numBoxes, initialColorSpace, colorValue);
    });
    saturateButton?.addEventListener('click', e => {
        e.preventDefault();
        saturateColor(selectedColor);
    });
    desaturateButton?.addEventListener('click', e => {
        e.preventDefault();
        desaturateColor(selectedColor);
    });
    popupDivButton?.addEventListener('click', e => {
        e.preventDefault();
        showCustomColorPopupDiv();
    });
    applyCustomColorButton?.addEventListener('click', e => {
        e.preventDefault();
        const hslColor = applyCustomColor();
        const customColor = {
            format: 'hsl',
            value: hslColor
        };
        storage.setAppStorage(customColor);
        showCustomColorPopupDiv();
    });
    clearCustomColorButton?.addEventListener('click', e => {
        e.preventDefault();
        storage.updateAppStorage({ customColor: null });
        customColor = null;
        showCustomColorPopupDiv();
    });
    advancedMenuToggleButton?.addEventListener('click', e => {
        e.preventDefault();
        const advancedMenu = getElement('advanced-menu');
        if (advancedMenu) {
            advancedMenu.classList.toggle('hidden');
            advancedMenu.style.display = advancedMenu.classList.contains('hidden')
                ? 'none'
                : 'block';
        }
    });
    applyInitialColorSpaceButton?.addEventListener('click', e => {
        e.preventDefault();
        const initialColorSpace = getElement('initial-color-space-options')
            ?.value || 'hex';
        console.log('Initial color space:', initialColorSpace);
        // applyInitialColorSpace(initialColorSpace); // *DEV-NOTE* uncomment when implemented
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFBK0I7QUFFL0IsaUdBQWlHO0FBQ2pHLHVFQUF1RTtBQUV2RSxzT0FBc087QUFFdE8sK0VBQStFO0FBRS9FLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUNOLGdCQUFnQixFQUNoQixlQUFlLEVBQ2YsYUFBYSxFQUNiLHVCQUF1QixFQUN2QixNQUFNLGdCQUFnQixDQUFDO0FBQ3hCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDckQsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUd4QyxJQUFJLFdBQVcsR0FBNkMsSUFBSSxDQUFDO0FBRWpFLFNBQVMsVUFBVSxDQUF3QixFQUFVO0lBQ3BELE9BQU8sUUFBUSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQWEsQ0FBQztBQUNoRCxDQUFDO0FBRUQsaURBQWlEO0FBQ2pELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDbEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDO0lBRXJFLHlDQUF5QztJQUN6QyxNQUFNLGNBQWMsR0FBRyxVQUFVLENBQW9CLGlCQUFpQixDQUFDLENBQUM7SUFDeEUsTUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFvQixpQkFBaUIsQ0FBQyxDQUFDO0lBQ3hFLE1BQU0sZ0JBQWdCLEdBQUcsVUFBVSxDQUFvQixtQkFBbUIsQ0FBQyxDQUFDO0lBQzVFLE1BQU0sY0FBYyxHQUFHLFVBQVUsQ0FBb0IscUJBQXFCLENBQUMsQ0FBQztJQUM1RSxNQUFNLHNCQUFzQixHQUFHLFVBQVUsQ0FDeEMsMkJBQTJCLENBQzNCLENBQUM7SUFDRixN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QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDeEMsWUFBWSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsWUFBWSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQzNELFFBQVEsQ0FDUjtnQkFDQSxDQUFDLENBQUMsTUFBTTtnQkFDUixDQUFDLENBQUMsT0FBTyxDQUFDO1FBQ1osQ0FBQztJQUNGLENBQUMsQ0FBQyxDQUFDO0lBRUgsNEJBQTRCLEVBQUUsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFO1FBQzNELENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUVuQixNQUFNLGlCQUFpQixHQUN0QixVQUFVLENBQW9CLDZCQUE2QixDQUFDO1lBQzNELEVBQUUsS0FBSyxJQUFJLEtBQUssQ0FBQztRQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixFQUFFLGlCQUFpQixDQUFDLENBQUM7UUFFdkQsc0ZBQXNGO0lBQ3ZGLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb2xvckdlbiAtIHZlcnNpb24gMC42LjAtZGV2XG5cbi8vIEF1dGhvcjogVmlpaG5hIExlcmFpbmUgKHZpaWhuYUBWaWlobmFUZWNoLmNvbSAvIHZpaWhuYS43OCAoU2lnbmFsKSAvIFZpaWhuYS1MZWhyYWluZSAoR2l0aHViKSlcbi8vIExpY2Vuc2VkIHVuZGVyIEdOVSBHUEx2MyAoaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLmh0bWwpXG5cbi8vIFlvdSBtYXkgdXNlIHRoaXMgY29kZSBmb3IgYW55IHB1cnBvc2UgRVhDRVBUIGZvciB0aGUgY3JlYXRpb24gb2YgcHJvcHJpZXRhcnkgZGVyaXZhdGl2ZXMuIEkgZW5jb3VyYWdlIHlvdSB0byBpbXByb3ZlIG9uIG15IGNvZGUgb3IgdG8gaW5jbHVkZSBpdCBpbiBvdGhlciBwcm9qZWN0cyBpZiB5b3UgZmluZCBpdCBoZWxwZnVsLiBQbGVhc2UgY3JlZGl0IG1lIGFzIHRoZSBvcmlnaW5hbCBhdXRob3IuXG5cbi8vIFRoaXMgYXBwbGljYXRpb24gY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZIE9SIEdVQVJBTlRFRSBPRiBBTlkgS0lORC5cblxuaW1wb3J0IHsgZG9tSGVscGVycyB9IGZyb20gJy4vaGVscGVycy9kb20nO1xuaW1wb3J0IHtcblx0YXBwbHlDdXN0b21Db2xvcixcblx0ZGVzYXR1cmF0ZUNvbG9yLFxuXHRzYXR1cmF0ZUNvbG9yLFxuXHRzaG93Q3VzdG9tQ29sb3JQb3B1cERpdlxufSBmcm9tICcuL2RvbS9kb20tbWFpbic7XG5pbXBvcnQgeyBwYWxldHRlSGVscGVycyB9IGZyb20gJy4vaGVscGVycy9wYWxldHRlJztcbmltcG9ydCB7IHBhcnNlQ29sb3JWYWx1ZSB9IGZyb20gJy4vdXRpbHMvdHJhbnNmb3Jtcyc7XG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnLi9kb20vc3RvcmFnZSc7XG5pbXBvcnQgKiBhcyB0eXBlcyBmcm9tICcuL2luZGV4JztcblxubGV0IGN1c3RvbUNvbG9yOiB7IGZvcm1hdDogc3RyaW5nOyB2YWx1ZTogc3RyaW5nIH0gfCBudWxsID0gbnVsbDtcblxuZnVuY3Rpb24gZ2V0RWxlbWVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQ+KGlkOiBzdHJpbmcpOiBUIHwgbnVsbCB7XG5cdHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkgYXMgVCB8IG51bGw7XG59XG5cbi8vIGFwcGxpZXMgYWxsIGV2ZW50IGxpc3RlbmVycyB3aGVuIERPTSBpcyBsb2FkZWRcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG5cdGNvbnNvbGUubG9nKCdhcHAuanMgLSBET00gY29udGVudCBsb2FkZWQ7IGluaXRpYWxpemluZyBhcHBsaWNhdGlvbicpO1xuXG5cdC8vIGRlZmluZXMgdGhlIGJ1dHRvbnMgd2l0aGluIHRoZSBtYWluIFVJXG5cdGNvbnN0IGdlbmVyYXRlQnV0dG9uID0gZ2V0RWxlbWVudDxIVE1MQnV0dG9uRWxlbWVudD4oJ2dlbmVyYXRlLWJ1dHRvbicpO1xuXHRjb25zdCBzYXR1cmF0ZUJ1dHRvbiA9IGdldEVsZW1lbnQ8SFRNTEJ1dHRvbkVsZW1lbnQ+KCdzYXR1cmF0ZS1idXR0b24nKTtcblx0Y29uc3QgZGVzYXR1cmF0ZUJ1dHRvbiA9IGdldEVsZW1lbnQ8SFRNTEJ1dHRvbkVsZW1lbnQ+KCdkZXNhdHVyYXRlLWJ1dHRvbicpO1xuXHRjb25zdCBwb3B1cERpdkJ1dHRvbiA9IGdldEVsZW1lbnQ8SFRNTEJ1dHRvbkVsZW1lbnQ+KCdjdXN0b20tY29sb3ItYnV0dG9uJyk7XG5cdGNvbnN0IGFwcGx5Q3VzdG9tQ29sb3JCdXR0b24gPSBnZXRFbGVtZW50PEhUTUxCdXR0b25FbGVtZW50Pihcblx0XHQnYXBwbHktY3VzdG9tLWNvbG9yLWJ1dHRvbidcblx0KTtcblx0Y29uc3QgY2xlYXJDdXN0b21Db2xvckJ1dHRvbiA9IGdldEVsZW1lbnQ8SFRNTEJ1dHRvbkVsZW1lbnQ+KFxuXHRcdCdjbGVhci1jdXN0b20tY29sb3ItYnV0dG9uJ1xuXHQpO1xuXHRjb25zdCBhZHZhbmNlZE1lbnVUb2dnbGVCdXR0b24gPSBnZXRFbGVtZW50PEhUTUxCdXR0b25FbGVtZW50Pihcblx0XHQnYWR2YW5jZWQtbWVudS10b2dnbGUtYnV0dG9uJ1xuXHQpO1xuXHRjb25zdCBhcHBseUluaXRpYWxDb2xvclNwYWNlQnV0dG9uID0gZ2V0RWxlbWVudDxIVE1MQnV0dG9uRWxlbWVudD4oXG5cdFx0J2FwcGx5LWluaXRpYWwtY29sb3Itc3BhY2UtYnV0dG9uJ1xuXHQpO1xuXHRjb25zdCBzZWxlY3RlZENvbG9yT3B0aW9ucyA9IGdldEVsZW1lbnQ8SFRNTFNlbGVjdEVsZW1lbnQ+KFxuXHRcdCdzZWxlY3RlZC1jb2xvci1vcHRpb25zJ1xuXHQpO1xuXHRjb25zdCBzZWxlY3RlZENvbG9yID0gc2VsZWN0ZWRDb2xvck9wdGlvbnNcblx0XHQ/IHBhcnNlSW50KHNlbGVjdGVkQ29sb3JPcHRpb25zLnZhbHVlLCAxMClcblx0XHQ6IDA7XG5cblx0ZG9tSGVscGVycy5hZGRDb252ZXJzaW9uQnV0dG9uRXZlbnRMaXN0ZW5lcnMoKTtcblxuXHRnZW5lcmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zdCB7IHBhbGV0dGVUeXBlLCBudW1Cb3hlcywgaW5pdGlhbENvbG9yU3BhY2UgfSA9XG5cdFx0XHRkb21IZWxwZXJzLnB1bGxQYXJhbXNGcm9tVUkoKTtcblxuXHRcdGNvbnN0IGNvbG9yVmFsdWU6IHR5cGVzLkNvbG9yRGF0YSB8IG51bGwgPSBjdXN0b21Db2xvclxuXHRcdFx0PyBwYXJzZUNvbG9yVmFsdWUoXG5cdFx0XHRcdFx0Y3VzdG9tQ29sb3IuZm9ybWF0IGFzIHR5cGVzLkNvbG9yU3BhY2UsXG5cdFx0XHRcdFx0Y3VzdG9tQ29sb3IudmFsdWVcblx0XHRcdFx0KVxuXHRcdFx0OiBudWxsO1xuXG5cdFx0cGFsZXR0ZUhlbHBlcnMuZ2VuUGFsZXR0ZShcblx0XHRcdHBhbGV0dGVUeXBlLFxuXHRcdFx0bnVtQm94ZXMsXG5cdFx0XHRpbml0aWFsQ29sb3JTcGFjZSxcblx0XHRcdGNvbG9yVmFsdWVcblx0XHQpO1xuXHR9KTtcblxuXHRzYXR1cmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0c2F0dXJhdGVDb2xvcihzZWxlY3RlZENvbG9yKTtcblx0fSk7XG5cblx0ZGVzYXR1cmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZGVzYXR1cmF0ZUNvbG9yKHNlbGVjdGVkQ29sb3IpO1xuXHR9KTtcblxuXHRwb3B1cERpdkJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0c2hvd0N1c3RvbUNvbG9yUG9wdXBEaXYoKTtcblx0fSk7XG5cblx0YXBwbHlDdXN0b21Db2xvckJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc3QgaHNsQ29sb3IgPSBhcHBseUN1c3RvbUNvbG9yKCk7XG5cdFx0Y29uc3QgY3VzdG9tQ29sb3I6IHR5cGVzLkN1c3RvbUNvbG9yID0ge1xuXHRcdFx0Zm9ybWF0OiAnaHNsJyxcblx0XHRcdHZhbHVlOiBoc2xDb2xvclxuXHRcdH07XG5cdFx0c3RvcmFnZS5zZXRBcHBTdG9yYWdlKGN1c3RvbUNvbG9yKTtcblx0XHRzaG93Q3VzdG9tQ29sb3JQb3B1cERpdigpO1xuXHR9KTtcblxuXHRjbGVhckN1c3RvbUNvbG9yQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRzdG9yYWdlLnVwZGF0ZUFwcFN0b3JhZ2UoeyBjdXN0b21Db2xvcjogbnVsbCB9KTtcblx0XHRjdXN0b21Db2xvciA9IG51bGw7XG5cdFx0c2hvd0N1c3RvbUNvbG9yUG9wdXBEaXYoKTtcblx0fSk7XG5cblx0YWR2YW5jZWRNZW51VG9nZ2xlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBhZHZhbmNlZE1lbnUgPSBnZXRFbGVtZW50PEhUTUxEaXZFbGVtZW50PignYWR2YW5jZWQtbWVudScpO1xuXHRcdGlmIChhZHZhbmNlZE1lbnUpIHtcblx0XHRcdGFkdmFuY2VkTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcblx0XHRcdGFkdmFuY2VkTWVudS5zdHlsZS5kaXNwbGF5ID0gYWR2YW5jZWRNZW51LmNsYXNzTGlzdC5jb250YWlucyhcblx0XHRcdFx0J2hpZGRlbidcblx0XHRcdClcblx0XHRcdFx0PyAnbm9uZSdcblx0XHRcdFx0OiAnYmxvY2snO1xuXHRcdH1cblx0fSk7XG5cblx0YXBwbHlJbml0aWFsQ29sb3JTcGFjZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zdCBpbml0aWFsQ29sb3JTcGFjZSA9XG5cdFx0XHRnZXRFbGVtZW50PEhUTUxTZWxlY3RFbGVtZW50PignaW5pdGlhbC1jb2xvci1zcGFjZS1vcHRpb25zJylcblx0XHRcdFx0Py52YWx1ZSB8fCAnaGV4Jztcblx0XHRjb25zb2xlLmxvZygnSW5pdGlhbCBjb2xvciBzcGFjZTonLCBpbml0aWFsQ29sb3JTcGFjZSk7XG5cblx0XHQvLyBhcHBseUluaXRpYWxDb2xvclNwYWNlKGluaXRpYWxDb2xvclNwYWNlKTsgLy8gKkRFVi1OT1RFKiB1bmNvbW1lbnQgd2hlbiBpbXBsZW1lbnRlZFxuXHR9KTtcbn0pO1xuIl19