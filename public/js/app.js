// ColorGen - version 0.6.0-dev
// Author: Viihna Leraine (viihna@ViihnaTech.com / viihna.78 (Signal) / Viihna-Lehraine (Github))
// Licensed under GNU GPLv3 (https://www.gnu.org/licenses/gpl-3.0.html)
// You may use this code for any purpose EXCEPT for the creation of proprietary derivatives. I encourage you to improve on my code or to include it in other projects if you find it helpful. Please credit me as the original author.
// This application comes with ABSOLUTELY NO WARRANTY OR GUARANTEE OF ANY KIND.
import { config } from './config/constants.js';
import { domFn } from './dom/dom-main.js';
import { database } from './database/database.js';
import { generate } from './palette-gen/generate.js';
import { randomHSL } from './utils/random-color-utils.js';
import { core } from './utils/core-utils.js';
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM content loaded - Initializing application');
    const buttons = domFn.defineUIElements();
    if (!buttons) {
        console.error('Failed to initialize UI buttons');
        return;
    }
    const selectedColorOptions = config.selectedColorOptions;
    const { applyCustomColorButton, clearCustomColorButton, closeHelpMenuButton, closeHistoryMenuButton, customColorToggleButton, desaturateButton, generateButton, saturateButton, showAsCMYKButton, showAsHexButton, showAsHSLButton, showAsHSVButton, showAsLABButton, showAsRGBButton, showHelpMenuButton, showHistoryMenuButton, subMenuToggleButtonA, subMenuToggleButtonB } = buttons;
    // confirm that all elements are accessible
    console.log(`Apply Custom Color Button: ${applyCustomColorButton ? 'found' : 'not found'}\nClear Custom Color Button: ${clearCustomColorButton ? 'found' : 'not found'}\nClose Help Menu Button: ${closeHelpMenuButton ? 'found' : 'not found'}\nClose History Menu Button: ${closeHistoryMenuButton ? 'found' : 'not found'}\nCustom Color Toggle Button: ${customColorToggleButton ? 'found' : 'not found'}\nDesaturate Button: ${desaturateButton ? 'found' : 'not found'}\nGenerate Button: ${generateButton ? 'found' : 'not found'}\nSaturate Button: ${saturateButton ? 'found' : 'not found'}\nShow as CMYK Button: ${showAsCMYKButton ? 'found' : 'not found'}\nShow as Hex Button: ${showAsHexButton ? 'found' : 'not found'}\nShow as HSL Button: ${showAsHSLButton ? 'found' : 'not found'}\nShow as HSV Button: ${showAsHSVButton ? 'found' : 'not found'}\nShow as LAB Button: ${showAsLABButton ? 'found' : 'not found'}\nShow as RGB Button: ${showAsRGBButton ? 'found' : 'not found'}\nShow Help Menu Button: ${showHelpMenuButton ? 'found' : 'not found'}\nShow History Menu Button${showHistoryMenuButton ? 'found' : 'not found'}\nSub Menu Toggle Button A: ${subMenuToggleButtonA ? 'found' : 'not found'}\nSub Menu Toggle Button B: ${subMenuToggleButtonB ? 'found' : 'not found'}`);
    const selectedColor = selectedColorOptions
        ? parseInt(selectedColorOptions.value, 10)
        : 0;
    console.log(`Selected color: ${selectedColor}`);
    try {
        domFn.addConversionButtonEventListeners();
        console.log('Conversion button event listeners attached');
    }
    catch (error) {
        console.error(`Unable to attach conversion button event listeners: ${error}`);
    }
    applyCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        const customHSLColor = domFn.applyCustomColor();
        const customHSLColorClone = core.clone(customHSLColor);
        await database.saveData('customColor', 'appSettings', customHSLColorClone);
        console.log('Custom color saved to IndexedDB');
    });
    clearCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        await database.deleteTable('customColor');
        console.log('Custom color cleared from IndexedDB');
        domFn.showCustomColorPopupDiv();
    });
    closeHelpMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('closeHelpMenuButton clicked');
    });
    closeHistoryMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('closeHistoryMenuButton clicked');
    });
    customColorToggleButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('customColorToggleButton clicked');
        domFn.showCustomColorPopupDiv();
    });
    desaturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('desaturateButton clicked');
        domFn.desaturateColor(selectedColor);
    });
    generateButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        console.log('generateButton clicked');
        const { paletteType, numBoxes, enableAlpha, limitBright, limitDark, limitGray } = domFn.pullParamsFromUI();
        let customColor = (await database.getCustomColor());
        if (!customColor) {
            console.info('No custom color found. Using a random color');
            customColor = randomHSL(true);
        }
        const paletteOptions = {
            paletteType,
            numBoxes,
            customColor: core.clone(customColor),
            enableAlpha,
            limitBright,
            limitDark,
            limitGray
        };
        await generate.startPaletteGen(paletteOptions);
    });
    saturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('saturateButton clicked');
        domFn.saturateColor(selectedColor);
    });
    showAsCMYKButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsCMYKButton clicked');
    });
    showAsHexButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHexButton clicked');
    });
    showAsHSLButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHSLButton clicked');
    });
    showAsHSVButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsHSVButton clicked');
    });
    showAsLABButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsLABButton clicked');
    });
    showAsRGBButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('showAsRGBButton clicked');
    });
    showHelpMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        if (showHelpMenuButton) {
            const clonedClasses = [...showHelpMenuButton.classList];
            const isHidden = clonedClasses.includes('hidden');
            showHelpMenuButton.classList.toggle('hidden');
            showHelpMenuButton.style.display = isHidden ? 'block' : 'none';
        }
        console.log('showHelpMenuButton clicked');
    });
    showHistoryMenuButton?.addEventListener('click', e => {
        e.preventDefault();
        if (showHistoryMenuButton) {
            const clonedClasses = [...showHistoryMenuButton.classList];
            const isHidden = clonedClasses.includes('hidden');
            showHistoryMenuButton.classList.toggle('hidden');
            showHistoryMenuButton.style.display = isHidden ? 'block' : 'none';
        }
        console.log('showHistoryMenuButton clicked');
    });
    subMenuToggleButtonA?.addEventListener('click', e => {
        e.preventDefault();
        if (subMenuToggleButtonA) {
            const clonedClasses = [...subMenuToggleButtonA.classList];
            const isHidden = clonedClasses.includes('hidden');
            subMenuToggleButtonA.classList.toggle('hidden');
            subMenuToggleButtonA.style.display = isHidden ? 'block' : 'none';
        }
        console.log('subMenuToggleButtonA clicked');
    });
    subMenuToggleButtonB?.addEventListener('click', e => {
        e.preventDefault();
        if (subMenuToggleButtonB) {
            const clonedClasses = [...subMenuToggleButtonB.classList];
            const isHidden = clonedClasses.includes('hidden');
            subMenuToggleButtonB.classList.toggle('hidden');
            subMenuToggleButtonB.style.display = isHidden ? 'block' : 'none';
        }
        console.log('subMenuToggleButtonB clicked');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFBK0I7QUFFL0IsaUdBQWlHO0FBQ2pHLHVFQUF1RTtBQUV2RSxzT0FBc087QUFFdE8sK0VBQStFO0FBRS9FLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM1QyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRS9DLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDdkQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRTFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDbEQsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0lBRTdELE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBRXpDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNkLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLENBQUMsQ0FBQztRQUNqRCxPQUFPO0lBQ1IsQ0FBQztJQUVELE1BQU0sb0JBQW9CLEdBQUcsTUFBTSxDQUFDLG9CQUFvQixDQUFDO0lBRXpELE1BQU0sRUFDTCxzQkFBc0IsRUFDdEIsc0JBQXNCLEVBQ3RCLG1CQUFtQixFQUNuQixzQkFBc0IsRUFDdEIsdUJBQXVCLEVBQ3ZCLGdCQUFnQixFQUNoQixjQUFjLEVBQ2QsY0FBYyxFQUNkLGdCQUFnQixFQUNoQixlQUFlLEVBQ2YsZUFBZSxFQUNmLGVBQWUsRUFDZixlQUFlLEVBQ2YsZUFBZSxFQUNmLGtCQUFrQixFQUNsQixxQkFBcUIsRUFD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LFNBQVMsQ0FBQyxDQUFDO1lBQzFELE1BQU0sUUFBUSxHQUFHLGFBQWEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbEQsb0JBQW9CLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNoRCxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDbEUsQ0FBQztRQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsOEJBQThCLENBQUMsQ0FBQztJQUM3QyxDQUFDLENBQUMsQ0FBQztJQUVILG9CQUFvQixFQUFFLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRTtRQUNuRCxDQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7UUFFbkIsSUFBSSxvQkFBb0IsRUFBRSxDQUFDO1lBQzFCLE1BQU0sYUFBYSxHQUFHLENBQUMsR0FBRyxvQkFBb0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMxRCxNQUFNLFFBQVEsR0FBRyxhQUFhLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRWxELG9CQUFvQixDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDaEQsb0JBQW9CLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ2xFLENBQUM7UUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUM7SUFDN0MsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvbG9yR2VuIC0gdmVyc2lvbiAwLjYuMC1kZXZcblxuLy8gQXV0aG9yOiBWaWlobmEgTGVyYWluZSAodmlpaG5hQFZpaWhuYVRlY2guY29tIC8gdmlpaG5hLjc4IChTaWduYWwpIC8gVmlpaG5hLUxlaHJhaW5lIChHaXRodWIpKVxuLy8gTGljZW5zZWQgdW5kZXIgR05VIEdQTHYzIChodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC0zLjAuaHRtbClcblxuLy8gWW91IG1heSB1c2UgdGhpcyBjb2RlIGZvciBhbnkgcHVycG9zZSBFWENFUFQgZm9yIHRoZSBjcmVhdGlvbiBvZiBwcm9wcmlldGFyeSBkZXJpdmF0aXZlcy4gSSBlbmNvdXJhZ2UgeW91IHRvIGltcHJvdmUgb24gbXkgY29kZSBvciB0byBpbmNsdWRlIGl0IGluIG90aGVyIHByb2plY3RzIGlmIHlvdSBmaW5kIGl0IGhlbHBmdWwuIFBsZWFzZSBjcmVkaXQgbWUgYXMgdGhlIG9yaWdpbmFsIGF1dGhvci5cblxuLy8gVGhpcyBhcHBsaWNhdGlvbiBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkgT1IgR1VBUkFOVEVFIE9GIEFOWSBLSU5ELlxuXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZy9jb25zdGFudHMnO1xuaW1wb3J0IHsgZG9tRm4gfSBmcm9tICcuL2RvbS9kb20tbWFpbic7XG5pbXBvcnQgeyBkYXRhYmFzZSB9IGZyb20gJy4vZGF0YWJhc2UvZGF0YWJhc2UnO1xuaW1wb3J0ICogYXMgY29sb3JzIGZyb20gJy4vaW5kZXgvY29sb3JzJztcbmltcG9ydCB7IGdlbmVyYXRlIH0gZnJvbSAnLi9wYWxldHRlLWdlbi9nZW5lcmF0ZSc7XG5pbXBvcnQgeyByYW5kb21IU0wgfSBmcm9tICcuL3V0aWxzL3JhbmRvbS1jb2xvci11dGlscyc7XG5pbXBvcnQgeyBjb3JlIH0gZnJvbSAnLi91dGlscy9jb3JlLXV0aWxzJztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcblx0Y29uc29sZS5sb2coJ0RPTSBjb250ZW50IGxvYWRlZCAtIEluaXRpYWxpemluZyBhcHBsaWNhdGlvbicpO1xuXG5cdGNvbnN0IGJ1dHRvbnMgPSBkb21Gbi5kZWZpbmVVSUVsZW1lbnRzKCk7XG5cblx0aWYgKCFidXR0b25zKSB7XG5cdFx0Y29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgVUkgYnV0dG9ucycpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHNlbGVjdGVkQ29sb3JPcHRpb25zID0gY29uZmlnLnNlbGVjdGVkQ29sb3JPcHRpb25zO1xuXG5cdGNvbnN0IHtcblx0XHRhcHBseUN1c3RvbUNvbG9yQnV0dG9uLFxuXHRcdGNsZWFyQ3VzdG9tQ29sb3JCdXR0b24sXG5cdFx0Y2xvc2VIZWxwTWVudUJ1dHRvbixcblx0XHRjbG9zZUhpc3RvcnlNZW51QnV0dG9uLFxuXHRcdGN1c3RvbUNvbG9yVG9nZ2xlQnV0dG9uLFxuXHRcdGRlc2F0dXJhdGVCdXR0b24sXG5cdFx0Z2VuZXJhdGVCdXR0b24sXG5cdFx0c2F0dXJhdGVCdXR0b24sXG5cdFx0c2hvd0FzQ01ZS0J1dHRvbixcblx0XHRzaG93QXNIZXhCdXR0b24sXG5cdFx0c2hvd0FzSFNMQnV0dG9uLFxuXHRcdHNob3dBc0hTVkJ1dHRvbixcblx0XHRzaG93QXNMQUJCdXR0b24sXG5cdFx0c2hvd0FzUkdCQnV0dG9uLFxuXHRcdHNob3dIZWxwTWVudUJ1dHRvbixcblx0XHRzaG93SGlzdG9yeU1lbnVCdXR0b24sXG5cdFx0c3ViTWVudVRvZ2dsZUJ1dHRvbkEsXG5cdFx0c3ViTWVudVRvZ2dsZUJ1dHRvbkJcblx0fSA9IGJ1dHRvbnM7XG5cblx0Ly8gY29uZmlybSB0aGF0IGFsbCBlbGVtZW50cyBhcmUgYWNjZXNzaWJsZVxuXHRjb25zb2xlLmxvZyhcblx0XHRgQXBwbHkgQ3VzdG9tIENvbG9yIEJ1dHRvbjogJHthcHBseUN1c3RvbUNvbG9yQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkNsZWFyIEN1c3RvbSBDb2xvciBCdXR0b246ICR7Y2xlYXJDdXN0b21Db2xvckJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5DbG9zZSBIZWxwIE1lbnUgQnV0dG9uOiAke2Nsb3NlSGVscE1lbnVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuQ2xvc2UgSGlzdG9yeSBNZW51IEJ1dHRvbjogJHtjbG9zZUhpc3RvcnlNZW51QnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkN1c3RvbSBDb2xvciBUb2dnbGUgQnV0dG9uOiAke2N1c3RvbUNvbG9yVG9nZ2xlQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcbkRlc2F0dXJhdGUgQnV0dG9uOiAke2Rlc2F0dXJhdGVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuR2VuZXJhdGUgQnV0dG9uOiAke2dlbmVyYXRlQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblNhdHVyYXRlIEJ1dHRvbjogJHtzYXR1cmF0ZUJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5TaG93IGFzIENNWUsgQnV0dG9uOiAke3Nob3dBc0NNWUtCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBhcyBIZXggQnV0dG9uOiAke3Nob3dBc0hleEJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5TaG93IGFzIEhTTCBCdXR0b246ICR7c2hvd0FzSFNMQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblNob3cgYXMgSFNWIEJ1dHRvbjogJHtzaG93QXNIU1ZCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBhcyBMQUIgQnV0dG9uOiAke3Nob3dBc0xBQkJ1dHRvbiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31cXG5TaG93IGFzIFJHQiBCdXR0b246ICR7c2hvd0FzUkdCQnV0dG9uID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblNob3cgSGVscCBNZW51IEJ1dHRvbjogJHtzaG93SGVscE1lbnVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU2hvdyBIaXN0b3J5IE1lbnUgQnV0dG9uJHtzaG93SGlzdG9yeU1lbnVCdXR0b24gPyAnZm91bmQnIDogJ25vdCBmb3VuZCd9XFxuU3ViIE1lbnUgVG9nZ2xlIEJ1dHRvbiBBOiAke3N1Yk1lbnVUb2dnbGVCdXR0b25BID8gJ2ZvdW5kJyA6ICdub3QgZm91bmQnfVxcblN1YiBNZW51IFRvZ2dsZSBCdXR0b24gQjogJHtzdWJNZW51VG9nZ2xlQnV0dG9uQiA/ICdmb3VuZCcgOiAnbm90IGZvdW5kJ31gXG5cdCk7XG5cblx0Y29uc3Qgc2VsZWN0ZWRDb2xvciA9IHNlbGVjdGVkQ29sb3JPcHRpb25zXG5cdFx0PyBwYXJzZUludChzZWxlY3RlZENvbG9yT3B0aW9ucy52YWx1ZSwgMTApXG5cdFx0OiAwO1xuXG5cdGNvbnNvbGUubG9nKGBTZWxlY3RlZCBjb2xvcjogJHtzZWxlY3RlZENvbG9yfWApO1xuXG5cdHRyeSB7XG5cdFx0ZG9tRm4uYWRkQ29udmVyc2lvbkJ1dHRvbkV2ZW50TGlzdGVuZXJzKCk7XG5cblx0XHRjb25zb2xlLmxvZygnQ29udmVyc2lvbiBidXR0b24gZXZlbnQgbGlzdGVuZXJzIGF0dGFjaGVkJyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihcblx0XHRcdGBVbmFibGUgdG8gYXR0YWNoIGNvbnZlcnNpb24gYnV0dG9uIGV2ZW50IGxpc3RlbmVyczogJHtlcnJvcn1gXG5cdFx0KTtcblx0fVxuXG5cdGFwcGx5Q3VzdG9tQ29sb3JCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc3QgY3VzdG9tSFNMQ29sb3IgPSBkb21Gbi5hcHBseUN1c3RvbUNvbG9yKCk7XG5cdFx0Y29uc3QgY3VzdG9tSFNMQ29sb3JDbG9uZTogY29sb3JzLkhTTCA9IGNvcmUuY2xvbmUoY3VzdG9tSFNMQ29sb3IpO1xuXG5cdFx0YXdhaXQgZGF0YWJhc2Uuc2F2ZURhdGEoXG5cdFx0XHQnY3VzdG9tQ29sb3InLFxuXHRcdFx0J2FwcFNldHRpbmdzJyxcblx0XHRcdGN1c3RvbUhTTENvbG9yQ2xvbmVcblx0XHQpO1xuXG5cdFx0Y29uc29sZS5sb2coJ0N1c3RvbSBjb2xvciBzYXZlZCB0byBJbmRleGVkREInKTtcblx0fSk7XG5cblx0Y2xlYXJDdXN0b21Db2xvckJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRhd2FpdCBkYXRhYmFzZS5kZWxldGVUYWJsZSgnY3VzdG9tQ29sb3InKTtcblxuXHRcdGNvbnNvbGUubG9nKCdDdXN0b20gY29sb3IgY2xlYXJlZCBmcm9tIEluZGV4ZWREQicpO1xuXG5cdFx0ZG9tRm4uc2hvd0N1c3RvbUNvbG9yUG9wdXBEaXYoKTtcblx0fSk7XG5cblx0Y2xvc2VIZWxwTWVudUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnY2xvc2VIZWxwTWVudUJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdGNsb3NlSGlzdG9yeU1lbnVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ2Nsb3NlSGlzdG9yeU1lbnVCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRjdXN0b21Db2xvclRvZ2dsZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnY3VzdG9tQ29sb3JUb2dnbGVCdXR0b24gY2xpY2tlZCcpO1xuXG5cdFx0ZG9tRm4uc2hvd0N1c3RvbUNvbG9yUG9wdXBEaXYoKTtcblx0fSk7XG5cblx0ZGVzYXR1cmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnZGVzYXR1cmF0ZUJ1dHRvbiBjbGlja2VkJyk7XG5cblx0XHRkb21Gbi5kZXNhdHVyYXRlQ29sb3Ioc2VsZWN0ZWRDb2xvcik7XG5cdH0pO1xuXG5cdGdlbmVyYXRlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnNvbGUubG9nKCdnZW5lcmF0ZUJ1dHRvbiBjbGlja2VkJyk7XG5cblx0XHRjb25zdCB7XG5cdFx0XHRwYWxldHRlVHlwZSxcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdH0gPSBkb21Gbi5wdWxsUGFyYW1zRnJvbVVJKCk7XG5cblx0XHRsZXQgY3VzdG9tQ29sb3IgPVxuXHRcdFx0KGF3YWl0IGRhdGFiYXNlLmdldEN1c3RvbUNvbG9yKCkpIGFzIGNvbG9ycy5IU0wgfCBudWxsO1xuXG5cdFx0aWYgKCFjdXN0b21Db2xvcikge1xuXHRcdFx0Y29uc29sZS5pbmZvKCdObyBjdXN0b20gY29sb3IgZm91bmQuIFVzaW5nIGEgcmFuZG9tIGNvbG9yJyk7XG5cblx0XHRcdGN1c3RvbUNvbG9yID0gcmFuZG9tSFNMKHRydWUpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHBhbGV0dGVPcHRpb25zOiBjb2xvcnMuUGFsZXR0ZU9wdGlvbnMgPSB7XG5cdFx0XHRwYWxldHRlVHlwZSxcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0Y3VzdG9tQ29sb3I6IGNvcmUuY2xvbmUoY3VzdG9tQ29sb3IpLFxuXHRcdFx0ZW5hYmxlQWxwaGEsXG5cdFx0XHRsaW1pdEJyaWdodCxcblx0XHRcdGxpbWl0RGFyayxcblx0XHRcdGxpbWl0R3JheVxuXHRcdH07XG5cblx0XHRhd2FpdCBnZW5lcmF0ZS5zdGFydFBhbGV0dGVHZW4ocGFsZXR0ZU9wdGlvbnMpO1xuXHR9KTtcblxuXHRzYXR1cmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2F0dXJhdGVCdXR0b24gY2xpY2tlZCcpO1xuXG5cdFx0ZG9tRm4uc2F0dXJhdGVDb2xvcihzZWxlY3RlZENvbG9yKTtcblx0fSk7XG5cblx0c2hvd0FzQ01ZS0J1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2hvd0FzQ01ZS0J1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdHNob3dBc0hleEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2hvd0FzSGV4QnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0c2hvd0FzSFNMQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnNvbGUubG9nKCdzaG93QXNIU0xCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzaG93QXNIU1ZCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Y29uc29sZS5sb2coJ3Nob3dBc0hTVkJ1dHRvbiBjbGlja2VkJyk7XG5cdH0pO1xuXG5cdHNob3dBc0xBQkJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRjb25zb2xlLmxvZygnc2hvd0FzTEFCQnV0dG9uIGNsaWNrZWQnKTtcblx0fSk7XG5cblx0c2hvd0FzUkdCQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGNvbnNvbGUubG9nKCdzaG93QXNSR0JCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzaG93SGVscE1lbnVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYgKHNob3dIZWxwTWVudUJ1dHRvbikge1xuXHRcdFx0Y29uc3QgY2xvbmVkQ2xhc3NlcyA9IFsuLi5zaG93SGVscE1lbnVCdXR0b24uY2xhc3NMaXN0XTtcblx0XHRcdGNvbnN0IGlzSGlkZGVuID0gY2xvbmVkQ2xhc3Nlcy5pbmNsdWRlcygnaGlkZGVuJyk7XG5cblx0XHRcdHNob3dIZWxwTWVudUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcblx0XHRcdHNob3dIZWxwTWVudUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gaXNIaWRkZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdH1cblxuXHRcdGNvbnNvbGUubG9nKCdzaG93SGVscE1lbnVCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzaG93SGlzdG9yeU1lbnVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYgKHNob3dIaXN0b3J5TWVudUJ1dHRvbikge1xuXHRcdFx0Y29uc3QgY2xvbmVkQ2xhc3NlcyA9IFsuLi5zaG93SGlzdG9yeU1lbnVCdXR0b24uY2xhc3NMaXN0XTtcblx0XHRcdGNvbnN0IGlzSGlkZGVuID0gY2xvbmVkQ2xhc3Nlcy5pbmNsdWRlcygnaGlkZGVuJyk7XG5cblx0XHRcdHNob3dIaXN0b3J5TWVudUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcblx0XHRcdHNob3dIaXN0b3J5TWVudUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gaXNIaWRkZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdH1cblxuXHRcdGNvbnNvbGUubG9nKCdzaG93SGlzdG9yeU1lbnVCdXR0b24gY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzdWJNZW51VG9nZ2xlQnV0dG9uQT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAoc3ViTWVudVRvZ2dsZUJ1dHRvbkEpIHtcblx0XHRcdGNvbnN0IGNsb25lZENsYXNzZXMgPSBbLi4uc3ViTWVudVRvZ2dsZUJ1dHRvbkEuY2xhc3NMaXN0XTtcblx0XHRcdGNvbnN0IGlzSGlkZGVuID0gY2xvbmVkQ2xhc3Nlcy5pbmNsdWRlcygnaGlkZGVuJyk7XG5cblx0XHRcdHN1Yk1lbnVUb2dnbGVCdXR0b25BLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuXHRcdFx0c3ViTWVudVRvZ2dsZUJ1dHRvbkEuc3R5bGUuZGlzcGxheSA9IGlzSGlkZGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZygnc3ViTWVudVRvZ2dsZUJ1dHRvbkEgY2xpY2tlZCcpO1xuXHR9KTtcblxuXHRzdWJNZW51VG9nZ2xlQnV0dG9uQj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAoc3ViTWVudVRvZ2dsZUJ1dHRvbkIpIHtcblx0XHRcdGNvbnN0IGNsb25lZENsYXNzZXMgPSBbLi4uc3ViTWVudVRvZ2dsZUJ1dHRvbkIuY2xhc3NMaXN0XTtcblx0XHRcdGNvbnN0IGlzSGlkZGVuID0gY2xvbmVkQ2xhc3Nlcy5pbmNsdWRlcygnaGlkZGVuJyk7XG5cblx0XHRcdHN1Yk1lbnVUb2dnbGVCdXR0b25CLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuXHRcdFx0c3ViTWVudVRvZ2dsZUJ1dHRvbkIuc3R5bGUuZGlzcGxheSA9IGlzSGlkZGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZygnc3ViTWVudVRvZ2dsZUJ1dHRvbkIgY2xpY2tlZCcpO1xuXHR9KTtcbn0pO1xuIl19