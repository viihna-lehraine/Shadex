// ColorGen - version 0.6.0-dev
// Author: Viihna Leraine (viihna@ViihnaTech.com / viihna.78 (Signal) / Viihna-Lehraine (Github))
// Licensed under GNU GPLv3 (https://www.gnu.org/licenses/gpl-3.0.html)
// You may use this code for any purpose EXCEPT for the creation of proprietary derivatives. I encourage you to improve on my code or to include it in other projects if you find it helpful. Please credit me as the original author.
// This application comes with ABSOLUTELY NO WARRANTY OR GUARANTEE OF ANY KIND.
import { domFn } from './dom/dom-main.js';
import { idbFn } from './dom/idb-fn.js';
import { domHelpers } from './helpers/dom.js';
import { generate } from './palette-gen/generate.js';
import { core } from './utils/core.js';
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM content loaded - Initializing application');
    const buttons = domFn.defineUIButtons();
    if (!buttons) {
        console.error('Failed to initialize UI buttons');
        return;
    }
    const selectedColorOptions = domHelpers.getElement('selected-color-options');
    const { advancedMenuToggleButton, applyColorSpaceButton, applyCustomColorButton, clearCustomColorButton, desaturateButton, generateButton, popupDivButton, saturateButton } = buttons;
    // confirm that all elements are accessible
    console.log(`generateButton: ${generateButton}\nsaturateButton: ${saturateButton}\ndesaturateButton: ${desaturateButton}\npopupDivButton: ${popupDivButton}\napplyCustomColorButton: ${applyCustomColorButton}\nclearCustomColorButton: ${clearCustomColorButton}\nadvancedMenuToggleButton: ${advancedMenuToggleButton}\napplyColorSpaceButton: ${applyColorSpaceButton}\nselectedColorOptions: ${selectedColorOptions}`);
    const selectedColor = selectedColorOptions
        ? parseInt(selectedColorOptions.value, 10)
        : 0;
    console.log(`Selected color: ${selectedColor}`);
    try {
        domFn.addConversionButtonEventListeners();
        console.log('Conversion button event listeners attached');
    }
    catch (error) {
        console.error(`Unable to attach conversion button event listeners: ${error}`);
    }
    advancedMenuToggleButton?.addEventListener('click', e => {
        e.preventDefault();
        const advancedMenu = domHelpers.getElement('advanced-menu');
        if (advancedMenu) {
            const clonedClasses = [...advancedMenu.classList];
            const isHidden = clonedClasses.includes('hidden');
            advancedMenu.classList.toggle('hidden');
            advancedMenu.style.display = isHidden ? 'block' : 'none';
        }
    });
    applyColorSpaceButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        const colorSpace = domFn.applySelectedColorSpace();
        await idbFn.saveData('settings', 'appSettings', { colorSpace });
        console.log('Color space saved to IndexedDB');
    });
    applyCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        const color = domFn.applyCustomColor();
        const customColorClone = core.clone(color);
        await idbFn.saveData('customColor', 'appSettings', customColorClone);
        console.log('Custom color saved to IndexedDB');
        domFn.showCustomColorPopupDiv();
    });
    clearCustomColorButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        await idbFn.deleteTable('customColor');
        console.log('Custom color cleared from IndexedDB');
        domFn.showCustomColorPopupDiv();
    });
    desaturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('desaturateButton clicked');
        domFn.desaturateColor(selectedColor);
    });
    generateButton?.addEventListener('click', async (e) => {
        e.preventDefault();
        console.log('generateButton clicked');
        const { paletteType, numBoxes, colorSpace } = domFn.pullParamsFromUI();
        const customColor = await idbFn.getCustomColor();
        const paletteOptions = {
            paletteType,
            numBoxes,
            colorSpace: colorSpace ?? 'hex',
            customColor: core.clone(customColor)
        };
        await generate.startPaletteGen(paletteOptions);
    });
    popupDivButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('popupDivButton clicked');
        domFn.showCustomColorPopupDiv();
    });
    saturateButton?.addEventListener('click', e => {
        e.preventDefault();
        console.log('saturateButton clicked');
        domFn.saturateColor(selectedColor);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFBK0I7QUFFL0IsaUdBQWlHO0FBQ2pHLHVFQUF1RTtBQUV2RSxzT0FBc087QUFFdE8sK0VBQStFO0FBRS9FLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0MsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2xELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFFcEMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNsRCxPQUFPLENBQUMsR0FBRyxDQUFDLCtDQUErQyxDQUFDLENBQUM7SUFFN0QsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBRXhDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNkLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLENBQUMsQ0FBQztRQUNqRCxPQUFPO0lBQ1IsQ0FBQztJQUVELE1BQU0sb0JBQW9CLEdBQUcsVUFBVSxDQUFDLFVBQVUsQ0FDakQsd0JBQXdCLENBQ3hCLENBQUM7SUFFRixNQUFNLEVBQ0wsd0JBQXdCLEVBQ3hCLHFCQUFxQixFQUNyQixzQkFBc0IsRUFDdEIsc0JBQXNCLEVBQ3RCLGdCQUFnQixFQUNoQixjQUFjLEVBQ2QsY0FBYyxFQUNkLGNBQWMsRUFDZCxHQUFHLE9BQU8sQ0FBQztJQUVaLDJDQUEyQztJQUMzQyxPQUFPLENBQUMsR0FBRyxDQUNWLG1CQUFtQixjQUFjLHFCQUFxQixjQUFjLHVCQUF1QixnQkFBZ0IscUJBQXFCLGNBQWMsNkJBQTZCLHNCQUFzQiw2QkFBNkIs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QXdCLENBQUMsQ0FBQztRQUN0QyxLQUFLLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb2xvckdlbiAtIHZlcnNpb24gMC42LjAtZGV2XG5cbi8vIEF1dGhvcjogVmlpaG5hIExlcmFpbmUgKHZpaWhuYUBWaWlobmFUZWNoLmNvbSAvIHZpaWhuYS43OCAoU2lnbmFsKSAvIFZpaWhuYS1MZWhyYWluZSAoR2l0aHViKSlcbi8vIExpY2Vuc2VkIHVuZGVyIEdOVSBHUEx2MyAoaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLmh0bWwpXG5cbi8vIFlvdSBtYXkgdXNlIHRoaXMgY29kZSBmb3IgYW55IHB1cnBvc2UgRVhDRVBUIGZvciB0aGUgY3JlYXRpb24gb2YgcHJvcHJpZXRhcnkgZGVyaXZhdGl2ZXMuIEkgZW5jb3VyYWdlIHlvdSB0byBpbXByb3ZlIG9uIG15IGNvZGUgb3IgdG8gaW5jbHVkZSBpdCBpbiBvdGhlciBwcm9qZWN0cyBpZiB5b3UgZmluZCBpdCBoZWxwZnVsLiBQbGVhc2UgY3JlZGl0IG1lIGFzIHRoZSBvcmlnaW5hbCBhdXRob3IuXG5cbi8vIFRoaXMgYXBwbGljYXRpb24gY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZIE9SIEdVQVJBTlRFRSBPRiBBTlkgS0lORC5cblxuaW1wb3J0IHsgZG9tRm4gfSBmcm9tICcuL2RvbS9kb20tbWFpbic7XG5pbXBvcnQgeyBpZGJGbiB9IGZyb20gJy4vZG9tL2lkYi1mbic7XG5pbXBvcnQgeyBkb21IZWxwZXJzIH0gZnJvbSAnLi9oZWxwZXJzL2RvbSc7XG5pbXBvcnQgKiBhcyBjb2xvcnMgZnJvbSAnLi9pbmRleC9jb2xvcnMnO1xuaW1wb3J0IHsgZ2VuZXJhdGUgfSBmcm9tICcuL3BhbGV0dGUtZ2VuL2dlbmVyYXRlJztcbmltcG9ydCB7IGNvcmUgfSBmcm9tICcuL3V0aWxzL2NvcmUnO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuXHRjb25zb2xlLmxvZygnRE9NIGNvbnRlbnQgbG9hZGVkIC0gSW5pdGlhbGl6aW5nIGFwcGxpY2F0aW9uJyk7XG5cblx0Y29uc3QgYnV0dG9ucyA9IGRvbUZuLmRlZmluZVVJQnV0dG9ucygpO1xuXG5cdGlmICghYnV0dG9ucykge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFVJIGJ1dHRvbnMnKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCBzZWxlY3RlZENvbG9yT3B0aW9ucyA9IGRvbUhlbHBlcnMuZ2V0RWxlbWVudDxIVE1MU2VsZWN0RWxlbWVudD4oXG5cdFx0J3NlbGVjdGVkLWNvbG9yLW9wdGlvbnMnXG5cdCk7XG5cblx0Y29uc3Qge1xuXHRcdGFkdmFuY2VkTWVudVRvZ2dsZUJ1dHRvbixcblx0XHRhcHBseUNvbG9yU3BhY2VCdXR0b24sXG5cdFx0YXBwbHlDdXN0b21Db2xvckJ1dHRvbixcblx0XHRjbGVhckN1c3RvbUNvbG9yQnV0dG9uLFxuXHRcdGRlc2F0dXJhdGVCdXR0b24sXG5cdFx0Z2VuZXJhdGVCdXR0b24sXG5cdFx0cG9wdXBEaXZCdXR0b24sXG5cdFx0c2F0dXJhdGVCdXR0b25cblx0fSA9IGJ1dHRvbnM7XG5cblx0Ly8gY29uZmlybSB0aGF0IGFsbCBlbGVtZW50cyBhcmUgYWNjZXNzaWJsZVxuXHRjb25zb2xlLmxvZyhcblx0XHRgZ2VuZXJhdGVCdXR0b246ICR7Z2VuZXJhdGVCdXR0b259XFxuc2F0dXJhdGVCdXR0b246ICR7c2F0dXJhdGVCdXR0b259XFxuZGVzYXR1cmF0ZUJ1dHRvbjogJHtkZXNhdHVyYXRlQnV0dG9ufVxcbnBvcHVwRGl2QnV0dG9uOiAke3BvcHVwRGl2QnV0dG9ufVxcbmFwcGx5Q3VzdG9tQ29sb3JCdXR0b246ICR7YXBwbHlDdXN0b21Db2xvckJ1dHRvbn1cXG5jbGVhckN1c3RvbUNvbG9yQnV0dG9uOiAke2NsZWFyQ3VzdG9tQ29sb3JCdXR0b259XFxuYWR2YW5jZWRNZW51VG9nZ2xlQnV0dG9uOiAke2FkdmFuY2VkTWVudVRvZ2dsZUJ1dHRvbn1cXG5hcHBseUNvbG9yU3BhY2VCdXR0b246ICR7YXBwbHlDb2xvclNwYWNlQnV0dG9ufVxcbnNlbGVjdGVkQ29sb3JPcHRpb25zOiAke3NlbGVjdGVkQ29sb3JPcHRpb25zfWBcblx0KTtcblxuXHRjb25zdCBzZWxlY3RlZENvbG9yID0gc2VsZWN0ZWRDb2xvck9wdGlvbnNcblx0XHQ/IHBhcnNlSW50KHNlbGVjdGVkQ29sb3JPcHRpb25zLnZhbHVlLCAxMClcblx0XHQ6IDA7XG5cblx0Y29uc29sZS5sb2coYFNlbGVjdGVkIGNvbG9yOiAke3NlbGVjdGVkQ29sb3J9YCk7XG5cblx0dHJ5IHtcblx0XHRkb21Gbi5hZGRDb252ZXJzaW9uQnV0dG9uRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRjb25zb2xlLmxvZygnQ29udmVyc2lvbiBidXR0b24gZXZlbnQgbGlzdGVuZXJzIGF0dGFjaGVkJyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihcblx0XHRcdGBVbmFibGUgdG8gYXR0YWNoIGNvbnZlcnNpb24gYnV0dG9uIGV2ZW50IGxpc3RlbmVyczogJHtlcnJvcn1gXG5cdFx0KTtcblx0fVxuXG5cdGFkdmFuY2VkTWVudVRvZ2dsZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc3QgYWR2YW5jZWRNZW51ID1cblx0XHRcdGRvbUhlbHBlcnMuZ2V0RWxlbWVudDxIVE1MRGl2RWxlbWVudD4oJ2FkdmFuY2VkLW1lbnUnKTtcblxuXHRcdGlmIChhZHZhbmNlZE1lbnUpIHtcblx0XHRcdGNvbnN0IGNsb25lZENsYXNzZXMgPSBbLi4uYWR2YW5jZWRNZW51LmNsYXNzTGlzdF07XG5cdFx0XHRjb25zdCBpc0hpZGRlbiA9IGNsb25lZENsYXNzZXMuaW5jbHVkZXMoJ2hpZGRlbicpO1xuXHRcdFx0YWR2YW5jZWRNZW51LmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuXHRcdFx0YWR2YW5jZWRNZW51LnN0eWxlLmRpc3BsYXkgPSBpc0hpZGRlbiA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0fVxuXHR9KTtcblxuXHRhcHBseUNvbG9yU3BhY2VCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNvbnN0IGNvbG9yU3BhY2U6IGNvbG9ycy5Db2xvclNwYWNlID0gZG9tRm4uYXBwbHlTZWxlY3RlZENvbG9yU3BhY2UoKTtcblx0XHRhd2FpdCBpZGJGbi5zYXZlRGF0YSgnc2V0dGluZ3MnLCAnYXBwU2V0dGluZ3MnLCB7IGNvbG9yU3BhY2UgfSk7XG5cdFx0Y29uc29sZS5sb2coJ0NvbG9yIHNwYWNlIHNhdmVkIHRvIEluZGV4ZWREQicpO1xuXHR9KTtcblxuXHRhcHBseUN1c3RvbUNvbG9yQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBjb2xvciA9IGRvbUZuLmFwcGx5Q3VzdG9tQ29sb3IoKTtcblx0XHRjb25zdCBjdXN0b21Db2xvckNsb25lOiBjb2xvcnMuQ29sb3IgPSBjb3JlLmNsb25lKGNvbG9yKTtcblx0XHRhd2FpdCBpZGJGbi5zYXZlRGF0YSgnY3VzdG9tQ29sb3InLCAnYXBwU2V0dGluZ3MnLCBjdXN0b21Db2xvckNsb25lKTtcblx0XHRjb25zb2xlLmxvZygnQ3VzdG9tIGNvbG9yIHNhdmVkIHRvIEluZGV4ZWREQicpO1xuXHRcdGRvbUZuLnNob3dDdXN0b21Db2xvclBvcHVwRGl2KCk7XG5cdH0pO1xuXG5cdGNsZWFyQ3VzdG9tQ29sb3JCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGF3YWl0IGlkYkZuLmRlbGV0ZVRhYmxlKCdjdXN0b21Db2xvcicpO1xuXHRcdGNvbnNvbGUubG9nKCdDdXN0b20gY29sb3IgY2xlYXJlZCBmcm9tIEluZGV4ZWREQicpO1xuXHRcdGRvbUZuLnNob3dDdXN0b21Db2xvclBvcHVwRGl2KCk7XG5cdH0pO1xuXG5cdGRlc2F0dXJhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNvbnNvbGUubG9nKCdkZXNhdHVyYXRlQnV0dG9uIGNsaWNrZWQnKTtcblx0XHRkb21Gbi5kZXNhdHVyYXRlQ29sb3Ioc2VsZWN0ZWRDb2xvcik7XG5cdH0pO1xuXG5cdGdlbmVyYXRlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zb2xlLmxvZygnZ2VuZXJhdGVCdXR0b24gY2xpY2tlZCcpO1xuXHRcdGNvbnN0IHsgcGFsZXR0ZVR5cGUsIG51bUJveGVzLCBjb2xvclNwYWNlIH0gPSBkb21Gbi5wdWxsUGFyYW1zRnJvbVVJKCk7XG5cdFx0Y29uc3QgY3VzdG9tQ29sb3IgPSBhd2FpdCBpZGJGbi5nZXRDdXN0b21Db2xvcigpO1xuXHRcdGNvbnN0IHBhbGV0dGVPcHRpb25zOiBjb2xvcnMuUGFsZXR0ZU9wdGlvbnMgPSB7XG5cdFx0XHRwYWxldHRlVHlwZSxcblx0XHRcdG51bUJveGVzLFxuXHRcdFx0Y29sb3JTcGFjZTogY29sb3JTcGFjZSA/PyAnaGV4Jyxcblx0XHRcdGN1c3RvbUNvbG9yOiBjb3JlLmNsb25lKGN1c3RvbUNvbG9yKVxuXHRcdH07XG5cblx0XHRhd2FpdCBnZW5lcmF0ZS5zdGFydFBhbGV0dGVHZW4ocGFsZXR0ZU9wdGlvbnMpO1xuXHR9KTtcblxuXHRwb3B1cERpdkJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc29sZS5sb2coJ3BvcHVwRGl2QnV0dG9uIGNsaWNrZWQnKTtcblx0XHRkb21Gbi5zaG93Q3VzdG9tQ29sb3JQb3B1cERpdigpO1xuXHR9KTtcblxuXHRzYXR1cmF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc29sZS5sb2coJ3NhdHVyYXRlQnV0dG9uIGNsaWNrZWQnKTtcblx0XHRkb21Gbi5zYXR1cmF0ZUNvbG9yKHNlbGVjdGVkQ29sb3IpO1xuXHR9KTtcbn0pO1xuIl19