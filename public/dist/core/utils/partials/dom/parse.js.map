{"version":3,"file":"parse.js","sources":["../../../../../../../src/core/utils/partials/dom/parse.ts"],"sourcesContent":["// File: core/utils/dom/partials/parse.ts\n\nimport {\n\tBrandingUtilities,\n\tDOMParsingUtilities,\n\tHex,\n\tHSL,\n\tRGB,\n\tServices\n} from '../../../../types/index.js';\nimport { regex } from '../../../../config/index.js';\n\nexport function domParsingUtilitiesFactory(\n\tbrand: BrandingUtilities,\n\tservices: Services\n): DOMParsingUtilities {\n\tconst { errors, log } = services;\n\n\tfunction parseCheckbox(id: string): boolean | void {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst checkbox = document.getElementById(id) as HTMLInputElement | null;\n\n\t\t\treturn checkbox ? checkbox.checked : undefined;\n\t\t}, 'Error occurred while parsing checkbox.');\n\t}\n\n\tfunction parseColorInput(input: HTMLInputElement): Hex | HSL | RGB | null {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst colorStr = input.value.trim().toLowerCase();\n\t\t\tconst hexMatch = colorStr.match(regex.dom.hex);\n\t\t\tconst hslMatch = colorStr.match(regex.dom.hsl);\n\t\t\tconst rgbMatch = colorStr.match(regex.dom.rgb);\n\n\t\t\tif (hexMatch) {\n\t\t\t\tlet hex = hexMatch[1];\n\t\t\t\tif (hex.length === 3) {\n\t\t\t\t\thex = hex\n\t\t\t\t\t\t.split('')\n\t\t\t\t\t\t.map(c => c + c)\n\t\t\t\t\t\t.join('');\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'hex',\n\t\t\t\t\tvalue: { hex: brand.asHexSet(`#${hex}`) }\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (hslMatch) {\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'hsl',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\thue: brand.asRadial(parseInt(hslMatch[1], 10)),\n\t\t\t\t\t\tsaturation: brand.asPercentile(parseFloat(hslMatch[2])),\n\t\t\t\t\t\tlightness: brand.asPercentile(parseFloat(hslMatch[3]))\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (rgbMatch) {\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'rgb',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tred: brand.asByteRange(parseInt(rgbMatch[1], 10)),\n\t\t\t\t\t\tgreen: brand.asByteRange(parseInt(rgbMatch[2], 10)),\n\t\t\t\t\t\tblue: brand.asByteRange(parseInt(rgbMatch[3], 10))\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// handle named colors\n\t\t\tconst testElement = document.createElement('div');\n\t\t\ttestElement.style.color = colorStr;\n\n\t\t\tif (testElement.style.color !== '') {\n\t\t\t\tconst ctx = document.createElement('canvas').getContext('2d');\n\n\t\t\t\tif (ctx) {\n\t\t\t\t\tctx.fillStyle = colorStr;\n\n\t\t\t\t\tconst rgb = ctx.fillStyle.match(/\\d+/g)?.map(Number);\n\n\t\t\t\t\tif (rgb && rgb.length === 3) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tformat: 'rgb',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\tred: brand.asByteRange(rgb[0]),\n\t\t\t\t\t\t\t\tgreen: brand.asByteRange(rgb[1]),\n\t\t\t\t\t\t\t\tblue: brand.asByteRange(rgb[2])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlog.info(`Invalid color input: ${colorStr}`, `parseColorInput`);\n\n\t\t\treturn null;\n\t\t}, 'Error occurred while parsing color input.');\n\t}\n\n\tfunction parseDropdownSelection(\n\t\tid: string,\n\t\tvalidOptions: string[]\n\t): string | void {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst dropdown = document.getElementById(id) as HTMLSelectElement | null;\n\n\t\t\tif (!dropdown) return;\n\n\t\t\tconst selectedValue = dropdown.value;\n\n\t\t\tif (!validOptions.includes(selectedValue)) {\n\t\t\t\treturn validOptions.includes(selectedValue) ? selectedValue : undefined;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}, 'Error occurred while parsing dropdown selection.');\n\t}\n\n\tfunction parseNumberInput(\n\t\tinput: HTMLInputElement,\n\t\tmin?: number,\n\t\tmax?: number\n\t): number | null {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst value = parseFloat(input.value.trim());\n\n\t\t\tif (isNaN(value)) return null;\n\n\t\t\tif (min !== undefined && value < min) return min;\n\t\t\tif (max !== undefined && value > max) return max;\n\n\t\t\treturn value;\n\t\t}, 'Error occurred while parsing number input.');\n\t}\n\n\tfunction parseTextInput(\n\t\tinput: HTMLInputElement,\n\t\tregex?: RegExp\n\t): string | null {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst text = input.value.trim();\n\n\t\t\tif (regex && !regex.test(text)) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn text || null;\n\t\t}, 'Error occurred while parsing text input.');\n\t}\n\n\tconst domParsingUtilities: DOMParsingUtilities = {\n\t\tparseCheckbox,\n\t\tparseColorInput,\n\t\tparseDropdownSelection,\n\t\tparseNumberInput,\n\t\tparseTextInput\n\t};\n\n\treturn errors.handleSync(\n\t\t() => domParsingUtilities,\n\t\t'Error occurred while creating DOM parsing utilities group.'\n\t);\n}\n"],"names":[],"mappings":"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"}