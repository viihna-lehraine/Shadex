{"version":3,"file":"adjust.js","sources":["../../../../../src/core/utils/adjust.ts"],"sourcesContent":["import {\n\tAdjustmentUtilities,\n\tBrandingUtilities,\n\tHSL,\n\tRGB,\n\tServices,\n\tValidationUtilities\n} from '../../types/index.js';\nimport { defaults, paletteConfig } from '../../config/index.js';\n\nconst adjustments = paletteConfig.adjustment;\nconst defaultColors = defaults.colors;\n\nexport function adjustmentUtilitiesFactory(\n\tbrand: BrandingUtilities,\n\tservices: Services,\n\tvalidate: ValidationUtilities\n): AdjustmentUtilities {\n\tconst { errors, log } = services;\n\n\tfunction applyGammaCorrection(value: number): number {\n\t\treturn errors.handleSync(() => {\n\t\t\treturn value > 0.0031308\n\t\t\t\t? 1.055 * Math.pow(value, 1 / 2.4) - 0.055\n\t\t\t\t: 12.92 * value;\n\t\t}, 'Error occurred while applying gamma correction.');\n\t}\n\n\tfunction clampRGB(rgb: RGB): RGB {\n\t\treturn errors.handleSync(() => {\n\t\t\tconst defaultRGB = defaultColors.rgb;\n\n\t\t\tif (!validate.colorValue(rgb)) {\n\t\t\t\tlog.error(\n\t\t\t\t\t`Invalid RGB value ${JSON.stringify(rgb)}`,\n\t\t\t\t\t'adjustmentUtils.clampRGB'\n\t\t\t\t);\n\n\t\t\t\treturn defaultRGB;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tvalue: {\n\t\t\t\t\tred: brand.asByteRange(\n\t\t\t\t\t\tMath.round(\n\t\t\t\t\t\t\tMath.min(Math.max(0, rgb.value.red), 1) * 255\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tgreen: brand.asByteRange(\n\t\t\t\t\t\tMath.round(\n\t\t\t\t\t\t\tMath.min(Math.max(0, rgb.value.green), 1) * 255\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tblue: brand.asByteRange(\n\t\t\t\t\t\tMath.round(\n\t\t\t\t\t\t\tMath.min(Math.max(0, rgb.value.blue), 1) * 255\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tformat: 'rgb'\n\t\t\t};\n\t\t}, 'Error occurred while clamping RGB value.');\n\t}\n\n\tfunction sl(color: HSL): HSL {\n\t\treturn errors.handleSync(() => {\n\t\t\tif (!validate.colorValue(color)) {\n\t\t\t\tlog.error(\n\t\t\t\t\t'Invalid color valus for adjustment.',\n\t\t\t\t\t`adjustmentUtils.sl`\n\t\t\t\t);\n\n\t\t\t\treturn color;\n\t\t\t}\n\n\t\t\tconst adjustedSaturation = Math.min(\n\t\t\t\tMath.max(color.value.saturation + adjustments.slaValue, 0),\n\t\t\t\t100\n\t\t\t);\n\t\t\tconst adjustedLightness = Math.min(100);\n\n\t\t\treturn {\n\t\t\t\tvalue: {\n\t\t\t\t\thue: color.value.hue,\n\t\t\t\t\tsaturation: brand.asPercentile(adjustedSaturation),\n\t\t\t\t\tlightness: brand.asPercentile(adjustedLightness)\n\t\t\t\t},\n\t\t\t\tformat: 'hsl'\n\t\t\t};\n\t\t}, 'Error occurred while adjusting saturation and lightness.');\n\t}\n\n\tconst adjustmentUtilities: AdjustmentUtilities = {\n\t\tapplyGammaCorrection,\n\t\tclampRGB,\n\t\tsl\n\t};\n\n\treturn errors.handleSync(() => {\n\t\treturn adjustmentUtilities;\n\t}, 'Error occurred while creating adjustment utils.');\n}\n"],"names":[],"mappings":"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"}