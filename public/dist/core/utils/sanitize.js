// File: core/utilities/sanitize.ts
export function sanitationUtilitiesFactory(brand, services, validate) {
    const { errors } = services;
    function getSafeQueryParam(param) {
        return errors.handleSync(() => {
            const urlParams = new URLSearchParams(window.location.search);
            const rawValue = urlParams.get(param);
            return rawValue ? sanitizeInput(rawValue) : null;
        }, 'Error occurred while getting safe query parameter');
    }
    function toColorValueRange(value, rangeKey) {
        return errors.handleSync(() => {
            validate.range(value, rangeKey);
            return rangeKey === 'HexSet'
                ? brand.asHexSet(value)
                : brand.asBranded(value, rangeKey);
        }, 'Error occurred while validating color value range.', { context: { rangeKey } });
    }
    function lab(value, output) {
        return errors.handleSync(() => {
            if (output === 'l') {
                return brand.asLAB_L(Math.round(Math.min(Math.max(value, 0), 100)));
            }
            else if (output === 'a') {
                return brand.asLAB_A(Math.round(Math.min(Math.max(value, -125), 125)));
            }
            else if (output === 'b') {
                return brand.asLAB_B(Math.round(Math.min(Math.max(value, -125), 125)));
            }
            else
                throw new Error('Unable to return LAB value');
        }, 'Error occurred while sanitizing LAB value');
    }
    function percentile(value) {
        return errors.handleSync(() => {
            const rawPercentile = Math.round(Math.min(Math.max(value, 0), 100));
            return brand.asPercentile(rawPercentile);
        }, 'Error occurred while sanitizing percentile value');
    }
    function radial(value) {
        return errors.handleSync(() => {
            const rawRadial = Math.round(Math.min(Math.max(value, 0), 360)) & 360;
            return brand.asRadial(rawRadial);
        }, 'Error occurred while sanitizing radial value');
    }
    function rgb(value) {
        return errors.handleSync(() => {
            const rawByteRange = Math.round(Math.min(Math.max(value, 0), 255));
            return toColorValueRange(rawByteRange, 'ByteRange');
        }, 'Error occurred while sanitizing RGB value');
    }
    function sanitizeInput(str) {
        return errors.handleSync(() => {
            return str.replace(/[&<>"'`/=():]/g, char => ({
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;',
                '`': '&#x60;',
                '/': '&#x2F;',
                '=': '&#x3D;',
                '(': '&#40;',
                ')': '&#41;',
                ':': '&#58;'
            })[char] || char);
        }, 'Error occurred while sanitizing input');
    }
    const sanitationUtilities = {
        getSafeQueryParam,
        lab,
        percentile,
        radial,
        rgb,
        sanitizeInput,
        toColorValueRange
    };
    return errors.handleSync(() => sanitationUtilities, 'Error creating sanitation utilities group.');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FuaXRpemUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29yZS91dGlscy9zYW5pdGl6ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxtQ0FBbUM7QUFnQm5DLE1BQU0sVUFBVSwwQkFBMEIsQ0FDekMsS0FBd0IsRUFDeEIsUUFBa0IsRUFDbEIsUUFBNkI7SUFFN0IsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQztJQUU1QixTQUFTLGlCQUFpQixDQUFDLEtBQWE7UUFDdkMsT0FBTyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUM3QixNQUFNLFNBQVMsR0FBRyxJQUFJLGVBQWUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQzlELE1BQU0sUUFBUSxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFdEMsT0FBTyxRQUFRLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQ2xELENBQUMsRUFBRSxtREFBbUQsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFRCxTQUFTLGlCQUFpQixDQUN6QixLQUFzQixFQUN0QixRQUFXO1FBRVgsT0FBTyxNQUFNLENBQUMsVUFBVSxDQUN2QixHQUFHLEVBQUU7WUFDSixRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztZQUVoQyxPQUFPLFFBQVEsS0FBSyxRQUFRO2dCQUMzQixDQUFDLENBQUUsS0FBSyxDQUFDLFFBQVEsQ0FDZixLQUFlLENBQ2U7Z0JBQ2hDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQWUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUMvQyxDQUFDLEVBQ0Qsb0RBQW9ELEVBQ3BELEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsQ0FDekIsQ0FBQztJQUNI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QUUsTUFBTTtnQkFDWCxHQUFHLEVBQUUsUUFBUTtnQkFDYixHQUFHLEVBQUUsUUFBUTtnQkFDYixHQUFHLEVBQUUsUUFBUTtnQkFDYixHQUFHLEVBQUUsUUFBUTtnQkFDYixHQUFHLEVBQUUsUUFBUTtnQkFDYixHQUFHLEVBQUUsT0FBTztnQkFDWixHQUFHLEVBQUUsT0FBTztnQkFDWixHQUFHLEVBQUUsT0FBTzthQUNaLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQ2pCLENBQUM7UUFDSCxDQUFDLEVBQUUsdUNBQXVDLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsTUFBTSxtQkFBbUIsR0FBd0I7UUFDaEQsaUJBQWlCO1FBQ2pCLEdBQUc7UUFDSCxVQUFVO1FBQ1YsTUFBTTtRQUNOLEdBQUc7UUFDSCxhQUFhO1FBQ2IsaUJBQWlCO0tBQ2pCLENBQUM7SUFFRixPQUFPLE1BQU0sQ0FBQyxVQUFVLENBQ3ZCLEdBQUcsRUFBRSxDQUFDLG1CQUFtQixFQUN6Qiw0Q0FBNEMsQ0FDNUMsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaWxlOiBjb3JlL3V0aWxpdGllcy9zYW5pdGl6ZS50c1xuXG5pbXBvcnQge1xuXHRCcmFuZGluZ1V0aWxpdGllcyxcblx0Qnl0ZVJhbmdlLFxuXHRMQUJfQSxcblx0TEFCX0IsXG5cdExBQl9MLFxuXHRQZXJjZW50aWxlLFxuXHRSYWRpYWwsXG5cdFJhbmdlS2V5TWFwLFxuXHRTYW5pdGF0aW9uVXRpbGl0aWVzLFxuXHRTZXJ2aWNlcyxcblx0VmFsaWRhdGlvblV0aWxpdGllc1xufSBmcm9tICcuLi8uLi90eXBlcy9pbmRleC5qcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGF0aW9uVXRpbGl0aWVzRmFjdG9yeShcblx0YnJhbmQ6IEJyYW5kaW5nVXRpbGl0aWVzLFxuXHRzZXJ2aWNlczogU2VydmljZXMsXG5cdHZhbGlkYXRlOiBWYWxpZGF0aW9uVXRpbGl0aWVzXG4pOiBTYW5pdGF0aW9uVXRpbGl0aWVzIHtcblx0Y29uc3QgeyBlcnJvcnMgfSA9IHNlcnZpY2VzO1xuXG5cdGZ1bmN0aW9uIGdldFNhZmVRdWVyeVBhcmFtKHBhcmFtOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcblx0XHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoKCkgPT4ge1xuXHRcdFx0Y29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcblx0XHRcdGNvbnN0IHJhd1ZhbHVlID0gdXJsUGFyYW1zLmdldChwYXJhbSk7XG5cblx0XHRcdHJldHVybiByYXdWYWx1ZSA/IHNhbml0aXplSW5wdXQocmF3VmFsdWUpIDogbnVsbDtcblx0XHR9LCAnRXJyb3Igb2NjdXJyZWQgd2hpbGUgZ2V0dGluZyBzYWZlIHF1ZXJ5IHBhcmFtZXRlcicpO1xuXHR9XG5cblx0ZnVuY3Rpb24gdG9Db2xvclZhbHVlUmFuZ2U8VCBleHRlbmRzIGtleW9mIFJhbmdlS2V5TWFwPihcblx0XHR2YWx1ZTogc3RyaW5nIHwgbnVtYmVyLFxuXHRcdHJhbmdlS2V5OiBUXG5cdCk6IFJhbmdlS2V5TWFwW1RdIHtcblx0XHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0XHQoKSA9PiB7XG5cdFx0XHRcdHZhbGlkYXRlLnJhbmdlKHZhbHVlLCByYW5nZUtleSk7XG5cblx0XHRcdFx0cmV0dXJuIHJhbmdlS2V5ID09PSAnSGV4U2V0J1xuXHRcdFx0XHRcdD8gKGJyYW5kLmFzSGV4U2V0KFxuXHRcdFx0XHRcdFx0XHR2YWx1ZSBhcyBzdHJpbmdcblx0XHRcdFx0XHRcdCkgYXMgdW5rbm93biBhcyBSYW5nZUtleU1hcFtUXSlcblx0XHRcdFx0XHQ6IGJyYW5kLmFzQnJhbmRlZCh2YWx1ZSBhcyBudW1iZXIsIHJhbmdlS2V5KTtcblx0XHRcdH0sXG5cdFx0XHQnRXJyb3Igb2NjdXJyZWQgd2hpbGUgdmFsaWRhdGluZyBjb2xvciB2YWx1ZSByYW5nZS4nLFxuXHRcdFx0eyBjb250ZXh0OiB7IHJhbmdlS2V5IH0gfVxuXHRcdCk7XG5cdH1cblxuXHRmdW5jdGlvbiBsYWIoXG5cdFx0dmFsdWU6IG51bWJlcixcblx0XHRvdXRwdXQ6ICdsJyB8ICdhJyB8ICdiJ1xuXHQpOiBMQUJfTCB8IExBQl9BIHwgTEFCX0Ige1xuXHRcdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYygoKSA9PiB7XG5cdFx0XHRpZiAob3V0cHV0ID09PSAnbCcpIHtcblx0XHRcdFx0cmV0dXJuIGJyYW5kLmFzTEFCX0woXG5cdFx0XHRcdFx0TWF0aC5yb3VuZChNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgMCksIDEwMCkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGVsc2UgaWYgKG91dHB1dCA9PT0gJ2EnKSB7XG5cdFx0XHRcdHJldHVybiBicmFuZC5hc0xBQl9BKFxuXHRcdFx0XHRcdE1hdGgucm91bmQoTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIC0xMjUpLCAxMjUpKVxuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIGlmIChvdXRwdXQgPT09ICdiJykge1xuXHRcdFx0XHRyZXR1cm4gYnJhbmQuYXNMQUJfQihcblx0XHRcdFx0XHRNYXRoLnJvdW5kKE1hdGgubWluKE1hdGgubWF4KHZhbHVlLCAtMTI1KSwgMTI1KSlcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byByZXR1cm4gTEFCIHZhbHVlJyk7XG5cdFx0fSwgJ0Vycm9yIG9jY3VycmVkIHdoaWxlIHNhbml0aXppbmcgTEFCIHZhbHVlJyk7XG5cdH1cblxuXHRmdW5jdGlvbiBwZXJjZW50aWxlKHZhbHVlOiBudW1iZXIpOiBQZXJjZW50aWxlIHtcblx0XHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoKCkgPT4ge1xuXHRcdFx0Y29uc3QgcmF3UGVyY2VudGlsZSA9IE1hdGgucm91bmQoTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIDApLCAxMDApKTtcblxuXHRcdFx0cmV0dXJuIGJyYW5kLmFzUGVyY2VudGlsZShyYXdQZXJjZW50aWxlKTtcblx0XHR9LCAnRXJyb3Igb2NjdXJyZWQgd2hpbGUgc2FuaXRpemluZyBwZXJjZW50aWxlIHZhbHVlJyk7XG5cdH1cblxuXHRmdW5jdGlvbiByYWRpYWwodmFsdWU6IG51bWJlcik6IFJhZGlhbCB7XG5cdFx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKCgpID0+IHtcblx0XHRcdGNvbnN0IHJhd1JhZGlhbCA9XG5cdFx0XHRcdE1hdGgucm91bmQoTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIDApLCAzNjApKSAmIDM2MDtcblxuXHRcdFx0cmV0dXJuIGJyYW5kLmFzUmFkaWFsKHJhd1JhZGlhbCk7XG5cdFx0fSwgJ0Vycm9yIG9jY3VycmVkIHdoaWxlIHNhbml0aXppbmcgcmFkaWFsIHZhbHVlJyk7XG5cdH1cblxuXHRmdW5jdGlvbiByZ2IodmFsdWU6IG51bWJlcik6IEJ5dGVSYW5nZSB7XG5cdFx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKCgpID0+IHtcblx0XHRcdGNvbnN0IHJhd0J5dGVSYW5nZSA9IE1hdGgucm91bmQoTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIDApLCAyNTUpKTtcblxuXHRcdFx0cmV0dXJuIHRvQ29sb3JWYWx1ZVJhbmdlKHJhd0J5dGVSYW5nZSwgJ0J5dGVSYW5nZScpITtcblx0XHR9LCAnRXJyb3Igb2NjdXJyZWQgd2hpbGUgc2FuaXRpemluZyBSR0IgdmFsdWUnKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHNhbml0aXplSW5wdXQoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYygoKSA9PiB7XG5cdFx0XHRyZXR1cm4gc3RyLnJlcGxhY2UoXG5cdFx0XHRcdC9bJjw+XCInYC89KCk6XS9nLFxuXHRcdFx0XHRjaGFyID0+XG5cdFx0XHRcdFx0KHtcblx0XHRcdFx0XHRcdCcmJzogJyZhbXA7Jyxcblx0XHRcdFx0XHRcdCc8JzogJyZsdDsnLFxuXHRcdFx0XHRcdFx0Jz4nOiAnJmd0OycsXG5cdFx0XHRcdFx0XHQnXCInOiAnJnF1b3Q7Jyxcblx0XHRcdFx0XHRcdFwiJ1wiOiAnJiMwMzk7Jyxcblx0XHRcdFx0XHRcdCdgJzogJyYjeDYwOycsXG5cdFx0XHRcdFx0XHQnLyc6ICcmI3gyRjsnLFxuXHRcdFx0XHRcdFx0Jz0nOiAnJiN4M0Q7Jyxcblx0XHRcdFx0XHRcdCcoJzogJyYjNDA7Jyxcblx0XHRcdFx0XHRcdCcpJzogJyYjNDE7Jyxcblx0XHRcdFx0XHRcdCc6JzogJyYjNTg7J1xuXHRcdFx0XHRcdH0pW2NoYXJdIHx8IGNoYXJcblx0XHRcdCk7XG5cdFx0fSwgJ0Vycm9yIG9jY3VycmVkIHdoaWxlIHNhbml0aXppbmcgaW5wdXQnKTtcblx0fVxuXG5cdGNvbnN0IHNhbml0YXRpb25VdGlsaXRpZXM6IFNhbml0YXRpb25VdGlsaXRpZXMgPSB7XG5cdFx0Z2V0U2FmZVF1ZXJ5UGFyYW0sXG5cdFx0bGFiLFxuXHRcdHBlcmNlbnRpbGUsXG5cdFx0cmFkaWFsLFxuXHRcdHJnYixcblx0XHRzYW5pdGl6ZUlucHV0LFxuXHRcdHRvQ29sb3JWYWx1ZVJhbmdlXG5cdH07XG5cblx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKFxuXHRcdCgpID0+IHNhbml0YXRpb25VdGlsaXRpZXMsXG5cdFx0J0Vycm9yIGNyZWF0aW5nIHNhbml0YXRpb24gdXRpbGl0aWVzIGdyb3VwLidcblx0KTtcbn1cbiJdfQ==