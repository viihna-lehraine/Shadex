{"version":3,"file":"initialize.js","sources":["../../../../src/app/initialize.ts"],"sourcesContent":["// File: app/initialize.js\n\nimport {\n\tHelpersInterface,\n\tServicesInterface,\n\tUtilitiesInterface\n} from '../types/index.js';\nimport { PaletteEvents } from '../events/PaletteEvents.js';\nimport { PaletteState } from '../state/PaletteState.js';\nimport { StateManager } from '../state/StateManager.js';\nimport { UIEvents } from '../events/UIEvents.js';\n\nasync function initializeApp(): Promise<{\n\tevents: {\n\t\tpalette: PaletteEvents;\n\t\tui: UIEvents;\n\t};\n\thelpers: HelpersInterface;\n\tpaletteState: PaletteState;\n\tservices: ServicesInterface;\n\tstateManager: StateManager;\n\tutils: UtilitiesInterface;\n}> {\n\ttry {\n\t\tconsole.log('initializeApp() Importing dependencies...');\n\n\t\tconsole.log('initializeApp() Loading createHelpers...');\n\t\tconst { createHelpers } = await import(\n\t\t\t'../common/factories/helpers.js'\n\t\t);\n\t\tconsole.log('[initializeApp()] Loaded createHelpers.');\n\n\t\tconst { createServices } = await import(\n\t\t\t'../common/factories/services.js'\n\t\t);\n\t\tconsole.log('[initializeApp()] Loaded createServices.');\n\n\t\tconst { createUtils } = await import('../common/factories/utils.js');\n\t\tconsole.log('[initializeApp()] Loaded createUtils.');\n\n\t\tconst services = await createServices();\n\t\tconsole.log(`services.app.log:`, services?.app?.log);\n\t\tconsole.log('[initializeApp()] Initialized Services.');\n\n\t\tconsole.log('[initializeApp()] Creating logger...');\n\n\t\t// create placeholders\n\t\tconst helpers = {} as HelpersInterface;\n\t\tconsole.log('[initializeApp()] Created Helpers placeholder.');\n\n\t\tconst utils = {} as UtilitiesInterface;\n\t\tconsole.log('[initializeApp()] Created Utils placeholder.');\n\n\t\t// construct both by passing placeholders\n\t\tObject.assign(helpers, await createHelpers(services, utils));\n\t\tconsole.log('[initializeApp()] Constructed Helpers .');\n\n\t\tObject.assign(utils, await createUtils(helpers, services));\n\t\tconsole.log('[initializeApp()] Constructed Utils.');\n\n\t\t// initialize StateManager\n\t\tconst stateManager = StateManager.getInstance(services);\n\t\tconsole.log('[initializeApp()] Initialized StateManager.');\n\n\t\t// initialize PaletteState\n\t\tconst paletteState = new PaletteState(stateManager, utils);\n\t\tconsole.log('[initializeApp()] Initialized PaletteState.');\n\n\t\t// initialize Event Managers\n\t\tconst paletteEvents = new PaletteEvents(\n\t\t\tpaletteState,\n\t\t\tservices,\n\t\t\tstateManager,\n\t\t\tutils\n\t\t);\n\t\tconsole.log('[initializeApp()] Created PaletteEvents.');\n\n\t\tconst uiEvents = new UIEvents(services, utils);\n\t\tconsole.log('[initializeApp()] Initialized UIEvents.');\n\n\t\t// attach event handlers\n\t\tconsole.log('[initializeApp()] Attaching event handlers...');\n\n\t\tpaletteEvents.init();\n\t\tconsole.log('[initializeApp()] Called PaletteEvents.init().');\n\n\t\tuiEvents.init();\n\t\tconsole.log('[initializeApp()] Called UIEvents.init().');\n\n\t\tuiEvents.initButtons();\n\t\tconsole.log('[initializeApp()] Called UIEvents.initButtons().');\n\n\t\tconsole.log(`[initializeApp(] Services before return:`, services);\n\n\t\t// log initialization success\n\t\tconsole.log(\n\t\t\t`[initializeApp()] Services object before return: ${JSON.stringify(services)}`\n\t\t);\n\t\tconst log = services.app.log;\n\t\tconsole.log('[initializeApp()] log function:', paletteState);\n\t\tlog('info', `Log has been initialized.`, 'initializeApp()', 1);\n\n\t\tlog('info', 'Initialization complete.', 'initializeApp()', 1);\n\t\tconsole.log(\n\t\t\t'[initializeApp()] Reached function end, returning Common Functions Object.'\n\t\t);\n\t\treturn {\n\t\t\tevents: { palette: paletteEvents, ui: uiEvents },\n\t\t\thelpers,\n\t\t\tpaletteState,\n\t\t\tservices,\n\t\t\tstateManager,\n\t\t\tutils\n\t\t};\n\t} catch (error) {\n\t\tconsole.error(\n\t\t\t`[initializeApp()] Initialization failed: ${error instanceof Error ? error.message : error}`\n\t\t);\n\n\t\tthrow error;\n\t}\n}\n\nexport { initializeApp };\nexport default initializeApp;\n"],"names":[],"mappings":"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"}