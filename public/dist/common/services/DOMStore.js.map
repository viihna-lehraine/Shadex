{"version":3,"file":"DOMStore.js","sources":["../../../../../src/common/services/DOMStore.ts"],"sourcesContent":["// File: common/services/DOMStore.ts\n\nimport {\n\tDOMElements,\n\tDOMStoreInterface,\n\tHelpers,\n\tServices,\n\tUnvalidatedDOMElements\n} from '../../types/index.js';\nimport { domIndex } from '../../config/index.js';\n\nconst ids = domIndex.ids;\n\nexport class DOMStore implements DOMStoreInterface {\n\tstatic #instance: DOMStore;\n\t#elements: DOMElements | null = null;\n\t#errors: Services['errors'];\n\t#helpers: Helpers;\n\t#log: Services['log'];\n\n\tconstructor(\n\t\terrors: Services['errors'],\n\t\thelpers: Helpers,\n\t\tlog: Services['log']\n\t) {\n\t\tthis.#errors = errors;\n\t\tthis.#log = log;\n\t\tthis.#helpers = helpers;\n\t\tthis.#validateAndGetDOMElements();\n\t}\n\n\tstatic getInstance(\n\t\terrors: Services['errors'],\n\t\thelpers: Helpers,\n\t\tlog: Services['log']\n\t): DOMStore {\n\t\tif (!DOMStore.#instance) {\n\t\t\tlog(\n\t\t\t\t'No DOMStore instance exists yet. Creating DOMStore instance',\n\t\t\t\t'debug'\n\t\t\t);\n\t\t\tDOMStore.#instance = new DOMStore(errors, helpers, log);\n\t\t}\n\n\t\tlog(\n\t\t\t'DOMStore instance already exists. Returning existing instance',\n\t\t\t'debug'\n\t\t);\n\n\t\treturn DOMStore.#instance;\n\t}\n\n\tgetElement<K extends keyof DOMElements, E extends keyof DOMElements[K]>(\n\t\tcategory: K,\n\t\tkey: E\n\t): DOMElements[K][E] {\n\t\tconst element = this.#elements?.[category]?.[key];\n\n\t\tif (!element) {\n\t\t\tthis.#log(\n\t\t\t\t`Element ${category}.${String(key)} is not validated or missing.`,\n\t\t\t\t'error'\n\t\t\t);\n\t\t\tthrow new Error(`Element ${category}.${String(key)} not found`);\n\t\t}\n\t\treturn element;\n\t}\n\n\tgetElements(): DOMElements {\n\t\tif (!this.#elements) {\n\t\t\tthis.#log('DOM elements are not validated yet.', 'error');\n\t\t\tthrow new Error('DOM elements not validated');\n\t\t}\n\n\t\treturn this.#elements;\n\t}\n\n\tsetElements(elements: DOMElements): void {\n\t\tthis.#errors.handleSync(() => {\n\t\t\tthis.#elements = elements;\n\t\t}, 'Unable to set DOM elements');\n\t\tthis.#log('DOM elements set successfully', 'debug');\n\t}\n\n\t#validateAndGetDOMElements(): void {\n\t\tconst missingElements: string[] = [];\n\n\t\tthis.#errors.handleSync(\n\t\t\t() => {\n\t\t\t\tconst elementTypeMap: Record<\n\t\t\t\t\tkeyof UnvalidatedDOMElements,\n\t\t\t\t\tkeyof HTMLElementTagNameMap\n\t\t\t\t> = {\n\t\t\t\t\tbtns: 'button',\n\t\t\t\t\tdivs: 'div',\n\t\t\t\t\tinputs: 'input'\n\t\t\t\t};\n\n\t\t\t\tconst elements: Partial<DOMElements> = {\n\t\t\t\t\tbtns: {} as DOMElements['btns'],\n\t\t\t\t\tdivs: {} as DOMElements['divs'],\n\t\t\t\t\tinputs: {} as DOMElements['inputs']\n\t\t\t\t};\n\n\t\t\t\tfor (const [category, elementsGroup] of Object.entries(ids)) {\n\t\t\t\t\tconst tagName =\n\t\t\t\t\t\telementTypeMap[\n\t\t\t\t\t\t\tcategory as keyof UnvalidatedDOMElements\n\t\t\t\t\t\t];\n\t\t\t\t\tif (!tagName) {\n\t\t\t\t\t\tthis.#log(\n\t\t\t\t\t\t\t`No element type mapping for category \"${category}\". Skipping...`,\n\t\t\t\t\t\t\t'warn'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const [key, id] of Object.entries(elementsGroup)) {\n\t\t\t\t\t\tconst element =\n\t\t\t\t\t\t\tthis.#helpers.dom.getElement<\n\t\t\t\t\t\t\t\tHTMLElementTagNameMap[typeof tagName]\n\t\t\t\t\t\t\t>(id);\n\t\t\t\t\t\tif (!element) {\n\t\t\t\t\t\t\tthis.#log(\n\t\t\t\t\t\t\t\t`Element with ID \"${id}\" not found.`,\n\t\t\t\t\t\t\t\t'error'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tmissingElements.push(id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\telements[\n\t\t\t\t\t\t\t\t\tcategory as keyof DOMElements\n\t\t\t\t\t\t\t\t] as Record<string, HTMLElement>\n\t\t\t\t\t\t\t)[key] = element;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (missingElements.length > 0) {\n\t\t\t\t\tthis.#log(\n\t\t\t\t\t\t`Missing elements: ${missingElements.join(', ')}`,\n\t\t\t\t\t\t'warn'\n\t\t\t\t\t);\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'Some DOM elements are missing. Validation failed.'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.#elements = elements as DOMElements;\n\t\t\t},\n\t\t\t'Unable to validate DOM elements',\n\t\t\t{ missingElements: missingElements }\n\t\t);\n\t\tthis.#log('All static elements are present! üè≥Ô∏è‚Äç‚ößÔ∏è ü©∑ üè≥Ô∏è‚Äç‚ößÔ∏è', 'debug');\n\t}\n}\n"],"names":[],"mappings":"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"}