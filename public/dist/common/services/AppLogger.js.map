{"version":3,"file":"AppLogger.js","sources":["../../../../../src/common/services/AppLogger.ts"],"sourcesContent":["// File: common/services/AppLogger.js\n\nimport { AppLoggerClassInterface, MutationLog } from '../../types/index.js';\nimport { data } from '../../data/index.js';\n\nconst mode = data.mode;\n\nexport class AppLogger implements AppLoggerClassInterface {\n\tprivate static instance: AppLogger | null = null;\n\n\tprivate constructor() {\n\t\tconsole.log('[AppLogger] AppLogger constructor executed.');\n\t}\n\n\tpublic static getInstance(): AppLogger {\n\t\tconsole.log('[AppLogger] Executing getInstance().');\n\n\t\tif (!AppLogger.instance) {\n\t\t\tconsole.log(\n\t\t\t\t'[AppLogger] No instance found. Creating new instance.'\n\t\t\t);\n\t\t\tAppLogger.instance = new AppLogger();\n\t\t\tconsole.log('[AppLogger] Instance created.');\n\t\t}\n\n\t\tconsole.log('[AppLogger] Returning existing instance.');\n\t\treturn AppLogger.instance;\n\t}\n\n\tpublic log(\n\t\tmessage: string,\n\t\tlevel: 'debug' | 'info' | 'warn' | 'error' = 'info',\n\t\tdebugLevel: number = 0,\n\t\tcaller?: string\n\t): void {\n\t\tif (debugLevel >= 5) {\n\t\t\tconsole.log(`[AppLogger.log] Log function CALLED with:`, {\n\t\t\t\tmessage,\n\t\t\t\tlevel,\n\t\t\t\tdebugLevel,\n\t\t\t\tcaller\n\t\t\t});\n\t\t}\n\t\tthis.logMessage(message, level, debugLevel, caller);\n\t}\n\n\tpublic async logAsync(\n\t\tmessage: string,\n\t\tlevel: 'debug' | 'info' | 'warn' | 'error' = 'info',\n\t\tdebugLevel: number = 0,\n\t\tcaller?: string\n\t): Promise<void> {\n\t\tthis.logMessage(message, level, debugLevel, caller);\n\t}\n\n\tpublic logMutation(\n\t\tdata: MutationLog,\n\t\tlogCallback: (data: MutationLog) => void = () => {}\n\t): void {\n\t\tthis.log(this.formatMutationLog(data), 'info');\n\n\t\tlogCallback(data);\n\t}\n\n\tprivate logMessage(\n\t\tmessage: string,\n\t\tlevel: 'debug' | 'info' | 'warn' | 'error',\n\t\tdebugLevel: number,\n\t\tcaller?: string\n\t): void {\n\t\tif (level === 'info' || debugLevel < this.getDebugThreshold(level)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst callerInfo = caller || this.getCallerInfo();\n\t\tconst timestamp = this.getFormattedTimestamp();\n\n\t\ttry {\n\t\t\tconsole.log(\n\t\t\t\t`%c[${level.toUpperCase()}]%c ${timestamp} [${callerInfo}] %c${message}`,\n\t\t\t\tthis.getLevelColor(level),\n\t\t\t\t'color: gray',\n\t\t\t\t'color: inherit'\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error(\n\t\t\t\t`AppLogger encountered an unexpected error: ${error}`\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tcallerInfo === 'Unknown caller' &&\n\t\t\tdebugLevel > 1 &&\n\t\t\tmode.stackTrace\n\t\t) {\n\t\t\tconsole.trace('Full Stack Trace:');\n\t\t}\n\t}\n\n\tprivate formatMutationLog(data: MutationLog): string {\n\t\treturn `Mutation logged: ${JSON.stringify(data)}`;\n\t}\n\n\tprivate getDebugThreshold(\n\t\tlevel: 'debug' | 'info' | 'warn' | 'error'\n\t): number {\n\t\tswitch (level) {\n\t\t\tcase 'debug':\n\t\t\t\treturn 2;\n\t\t\tcase 'info':\n\t\t\t\treturn 1;\n\t\t\tcase 'warn':\n\t\t\t\treturn 0;\n\t\t\tcase 'error':\n\t\t\t\treturn 0;\n\t\t\tdefault:\n\t\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprivate getCallerInfo(): string {\n\t\tconst stack = new Error().stack;\n\n\t\tif (stack) {\n\t\t\tconst stackLines = stack.split('\\n');\n\n\t\t\tfor (const line of stackLines) {\n\t\t\t\tif (!line.includes('AppLogger') && line.includes('at ')) {\n\t\t\t\t\tconst match =\n\t\t\t\t\t\tline.match(/at\\s+(.*)\\s+\\((.*):(\\d+):(\\d+)\\)/) ||\n\t\t\t\t\t\tline.match(/at\\s+(.*):(\\d+):(\\d+)/);\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\treturn match[1]\n\t\t\t\t\t\t\t? `${match[1]} (${match[2]}:${match[3]})`\n\t\t\t\t\t\t\t: `${match[2]}:${match[3]}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn 'Unknown caller';\n\t}\n\n\tprivate getFormattedTimestamp(): string {\n\t\treturn new Date().toLocaleString('en-US', {\n\t\t\tyear: 'numeric',\n\t\t\tmonth: '2-digit',\n\t\t\tday: '2-digit',\n\t\t\thour: '2-digit',\n\t\t\tminute: '2-digit',\n\t\t\tsecond: '2-digit',\n\t\t\thour12: false\n\t\t});\n\t}\n\n\tprivate getLevelColor(level: 'debug' | 'info' | 'warn' | 'error'): string {\n\t\tswitch (level) {\n\t\t\tcase 'debug':\n\t\t\t\treturn 'color: green';\n\t\t\tcase 'info':\n\t\t\t\treturn 'color: blue';\n\t\t\tcase 'warn':\n\t\t\t\treturn 'color: orange';\n\t\t\tcase 'error':\n\t\t\t\treturn 'color: red';\n\t\t\tdefault:\n\t\t\t\treturn 'color: black';\n\t\t}\n\t}\n}\n"],"names":[],"mappings":"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"}