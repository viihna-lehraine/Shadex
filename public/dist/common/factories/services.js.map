{"version":3,"file":"services.js","sources":["../../../../../src/common/factories/services.ts"],"sourcesContent":["// File: common/factories/services.ts\n\nimport { DefaultObserverData, Helpers, Services } from '../../types/index.js';\nimport {\n\tDataObserver,\n\tDOMStore,\n\tErrorHandler,\n\tLogger,\n\tSemaphore\n} from '../services/index.js';\nimport { config } from '../../config/index.js';\n\nexport function serviceFactory<\n\tT extends DefaultObserverData = DefaultObserverData\n>(helpers: Helpers, initialData: T): Services<T> {\n\tconsole.log('[ServiceFactory-1] Loading createServices...');\n\n\tconst services = {} as Services<T>;\n\n\tconst logger = Logger.getInstance(helpers);\n\tservices.errors = ErrorHandler.getInstance(helpers, logger);\n\n\tif (!logger || !services.errors) {\n\t\tthrow new Error(\n\t\t\t'[ServiceFactory-2] Logger or ErrorHandler failed to initialize.'\n\t\t);\n\t}\n\n\tservices.log = (\n\t\tmessage: string,\n\t\tlevel: 'debug' | 'info' | 'warn' | 'error' = 'info',\n\t\tverbosityRequirement: number = 0\n\t) => {\n\t\tif (\n\t\t\tconfig.mode.log[level] &&\n\t\t\tconfig.mode.log.verbosity >= verbosityRequirement\n\t\t) {\n\t\t\tconst caller = helpers.data.getCallerInfo();\n\t\t\tlogger.log(message, level, caller);\n\t\t}\n\n\t\tif (level === 'error' && config.mode.showAlerts) {\n\t\t\talert(message);\n\t\t}\n\t};\n\n\tservices.domStore = DOMStore.getInstance(\n\t\tservices.errors,\n\t\thelpers,\n\t\tservices.log\n\t);\n\tservices.observer = new DataObserver<T>(initialData);\n\n\tservices.setObserverData = (newData: T) => {\n\t\tservices.observer.setData(newData);\n\t\tservices.log(\n\t\t\t`DataObserver updated with new data: ${JSON.stringify(newData)}`,\n\t\t\t'debug',\n\t\t\t2\n\t\t);\n\t};\n\n\tservices.semaphore = new Semaphore();\n\n\treturn services;\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AAYgB,SAAA,cAAc,CAE5B,OAAgB,EAAE,WAAc,EAAA;AACjC,IAAA,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC;IAE3D,MAAM,QAAQ,GAAG,EAAiB;IAElC,MAAM,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC;IAC1C,QAAQ,CAAC,MAAM,GAAG,YAAY,CAAC,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC;IAE3D,IAAI,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;AAChC,QAAA,MAAM,IAAI,KAAK,CACd,iEAAiE,CACjE;;AAGF,IAAA,QAAQ,CAAC,GAAG,GAAG,CACd,OAAe,EACf,KAA6C,GAAA,MAAM,EACnD,oBAAA,GAA+B,CAAC,KAC7B;AACH,QAAA,IACC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,IAAI,oBAAoB,EAChD;YACD,MAAM,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE;YAC3C,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC;;AAMpC,KAAC;AAED,IAAA,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,WAAW,CACvC,QAAQ,CAAC,MAAM,EACf,OAAO,EACP,QAAQ,CAAC,GAAG,CACZ;IACD,QAAQ,CAAC,QAAQ,GAAG,IAAI,YAAY,CAAI,WAAW,CAAC;AAEpD,IAAA,QAAQ,CAAC,eAAe,GAAG,CAAC,OAAU,KAAI;AACzC,QAAA,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC;AAClC,QAAA,QAAQ,CAAC,GAAG,CACX,CAAuC,oCAAA,EAAA,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,EAChE,OAAO,EACP,CAAC,CACD;AACF,KAAC;AAED,IAAA,QAAQ,CAAC,SAAS,GAAG,IAAI,SAAS,EAAE;AAEpC,IAAA,OAAO,QAAQ;AAChB;;;;"}