// File: common/transform.js
import { brand } from './core.js';
import { createLogger } from '../logger/index.js';
import { modeData as mode } from '../data/mode.js';
const thisModule = 'common/transform/base.ts';
const logger = await createLogger();
function addHashToHex(hex) {
    try {
        return hex.value.hex.startsWith('#')
            ? hex
            : {
                value: {
                    hex: brand.asHexSet(`#${hex.value}}`)
                },
                format: 'hex'
            };
    }
    catch (error) {
        throw new Error(`addHashToHex error: ${error}`);
    }
}
function brandPalette(data) {
    return {
        ...data,
        metadata: { ...data.metadata },
        items: data.items.map(item => ({
            colors: {
                main: {
                    cmyk: {
                        cyan: brand.asPercentile(item.colors.main.cmyk.cyan ?? 0),
                        magenta: brand.asPercentile(item.colors.main.cmyk.magenta ?? 0),
                        yellow: brand.asPercentile(item.colors.main.cmyk.yellow ?? 0),
                        key: brand.asPercentile(item.colors.main.cmyk.key ?? 0)
                    },
                    hex: {
                        hex: brand.asHexSet(item.colors.main.hex.hex ?? '#000000')
                    },
                    hsl: {
                        hue: brand.asRadial(item.colors.main.hsl.hue ?? 0),
                        saturation: brand.asPercentile(item.colors.main.hsl.saturation ?? 0),
                        lightness: brand.asPercentile(item.colors.main.hsl.lightness ?? 0)
                    },
                    hsv: {
                        hue: brand.asRadial(item.colors.main.hsv.hue ?? 0),
                        saturation: brand.asPercentile(item.colors.main.hsv.saturation ?? 0),
                        value: brand.asPercentile(item.colors.main.hsv.value ?? 0)
                    },
                    lab: {
                        l: brand.asLAB_L(item.colors.main.lab.l ?? 0),
                        a: brand.asLAB_A(item.colors.main.lab.a ?? 0),
                        b: brand.asLAB_B(item.colors.main.lab.b ?? 0)
                    },
                    rgb: {
                        red: brand.asByteRange(item.colors.main.rgb.red ?? 0),
                        green: brand.asByteRange(item.colors.main.rgb.green ?? 0),
                        blue: brand.asByteRange(item.colors.main.rgb.blue ?? 0)
                    },
                    xyz: {
                        x: brand.asXYZ_X(item.colors.main.xyz.x ?? 0),
                        y: brand.asXYZ_Y(item.colors.main.xyz.y ?? 0),
                        z: brand.asXYZ_Z(item.colors.main.xyz.z ?? 0)
                    }
                },
                stringProps: {
                    cmyk: {
                        cyan: String(item.colors.main.cmyk.cyan ?? 0),
                        magenta: String(item.colors.main.cmyk.magenta ?? 0),
                        yellow: String(item.colors.main.cmyk.yellow ?? 0),
                        key: String(item.colors.main.cmyk.key ?? 0)
                    },
                    hex: {
                        hex: String(item.colors.main.hex.hex ?? '#000000')
                    },
                    hsl: {
                        hue: String(item.colors.main.hsl.hue ?? 0),
                        saturation: String(item.colors.main.hsl.saturation ?? 0),
                        lightness: String(item.colors.main.hsl.lightness ?? 0)
                    },
                    hsv: {
                        hue: String(item.colors.main.hsv.hue ?? 0),
                        saturation: String(item.colors.main.hsv.saturation ?? 0),
                        value: String(item.colors.main.hsv.value ?? 0)
                    },
                    lab: {
                        l: String(item.colors.main.lab.l ?? 0),
                        a: String(item.colors.main.lab.a ?? 0),
                        b: String(item.colors.main.lab.b ?? 0)
                    },
                    rgb: {
                        red: String(item.colors.main.rgb.red ?? 0),
                        green: String(item.colors.main.rgb.green ?? 0),
                        blue: String(item.colors.main.rgb.blue ?? 0)
                    },
                    xyz: {
                        x: String(item.colors.main.xyz.x ?? 0),
                        y: String(item.colors.main.xyz.y ?? 0),
                        z: String(item.colors.main.xyz.z ?? 0)
                    }
                },
                css: {
                    cmyk: `cmyk(${item.colors.main.cmyk.cyan}%, ${item.colors.main.cmyk.magenta}%, ${item.colors.main.cmyk.yellow}%, ${item.colors.main.cmyk.key}%)`,
                    hex: `${item.colors.main.hex.hex}}`,
                    hsl: `hsl(${item.colors.main.hsl.hue}, ${item.colors.main.hsl.saturation}%, ${item.colors.main.hsl.lightness}%)`,
                    hsv: `hsv(${item.colors.main.hsv.hue}, ${item.colors.main.hsv.saturation}%, ${item.colors.main.hsv.value}%)`,
                    lab: `lab(${item.colors.main.lab.l}, ${item.colors.main.lab.a}, ${item.colors.main.lab.b})`,
                    rgb: `rgb(${item.colors.main.rgb.red}, ${item.colors.main.rgb.green}, ${item.colors.main.rgb.blue})`,
                    xyz: `xyz(${item.colors.main.xyz.x}, ${item.colors.main.xyz.y}, ${item.colors.main.xyz.z})`
                }
            }
        }))
    };
}
function componentToHex(component) {
    const thisMethod = 'common > transform > base > componentToHex()';
    try {
        const hex = Math.max(0, Math.min(255, component)).toString(16);
        return hex.length === 1 ? '0' + hex : hex;
    }
    catch (error) {
        if (!mode.quiet && mode.logging.error)
            logger.error(`componentToHex error: ${error}`, `${thisModule} > ${thisMethod}`);
        return '00';
    }
}
function defaultColorValue(color) {
    switch (color.format) {
        case 'cmyk':
            return {
                value: {
                    cyan: brand.asPercentile(0),
                    magenta: brand.asPercentile(0),
                    yellow: brand.asPercentile(0),
                    key: brand.asPercentile(0)
                },
                format: 'cmyk'
            };
        case 'hex':
            return {
                value: {
                    hex: brand.asHexSet('#000000')
                },
                format: 'hex'
            };
        case 'hsl':
            return {
                value: {
                    hue: brand.asRadial(0),
                    saturation: brand.asPercentile(0),
                    lightness: brand.asPercentile(0)
                },
                format: 'hsl'
            };
        case 'hsv':
            return {
                value: {
                    hue: brand.asRadial(0),
                    saturation: brand.asPercentile(0),
                    value: brand.asPercentile(0)
                },
                format: 'hsv'
            };
        case 'lab':
            return {
                value: {
                    l: brand.asLAB_L(0),
                    a: brand.asLAB_A(0),
                    b: brand.asLAB_B(0)
                },
                format: 'lab'
            };
        case 'rgb':
            return {
                value: {
                    red: brand.asByteRange(0),
                    green: brand.asByteRange(0),
                    blue: brand.asByteRange(0)
                },
                format: 'rgb'
            };
        case 'sl':
            return {
                value: {
                    saturation: brand.asPercentile(0),
                    lightness: brand.asPercentile(0)
                },
                format: 'sl'
            };
        case 'sv':
            return {
                value: {
                    saturation: brand.asPercentile(0),
                    value: brand.asPercentile(0)
                },
                format: 'sv'
            };
        case 'xyz':
            return {
                value: {
                    x: brand.asXYZ_X(0),
                    y: brand.asXYZ_Y(0),
                    z: brand.asXYZ_Z(0)
                },
                format: 'xyz'
            };
        default:
            throw new Error(`
				Unknown color format\nDetails: ${JSON.stringify(color)}`);
    }
}
export const transformUtils = {
    addHashToHex,
    componentToHex,
    brandPalette,
    defaultColorValue
};
export { componentToHex };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbW1vbi90cmFuc2Zvcm0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsNEJBQTRCO0FBVTVCLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDbEMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxRQUFRLElBQUksSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFbkQsTUFBTSxVQUFVLEdBQUcsMEJBQTBCLENBQUM7QUFFOUMsTUFBTSxNQUFNLEdBQUcsTUFBTSxZQUFZLEVBQUUsQ0FBQztBQUVwQyxTQUFTLFlBQVksQ0FBQyxHQUFRO0lBQzdCLElBQUksQ0FBQztRQUNKLE9BQU8sR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQztZQUNuQyxDQUFDLENBQUMsR0FBRztZQUNMLENBQUMsQ0FBQztnQkFDQSxLQUFLLEVBQUU7b0JBQ04sR0FBRyxFQUFFLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFHLENBQUMsS0FBSyxHQUFHLENBQUM7aUJBQ3JDO2dCQUNELE1BQU0sRUFBRSxLQUFjO2FBQ3RCLENBQUM7SUFDTCxDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNoQixNQUFNLElBQUksS0FBSyxDQUFDLHVCQUF1QixLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQ2pELENBQUM7QUFDRixDQUFDO0FBQ0QsU0FBUyxZQUFZLENBQUMsSUFBc0I7SUFDM0MsT0FBTztRQUNOLEdBQUcsSUFBSTtRQUNQLFFBQVEsRUFBRSxFQUFFLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUM5QixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzlCLE1BQU0sRUFBRTtnQkFD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QUcsSUFBSSxDQUFDLENBQUM7d0JBQzFDLFVBQVUsRUFBRSxNQUFNLENBQ2pCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLElBQUksQ0FBQyxDQUNwQzt3QkFDRCxTQUFTLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLElBQUksQ0FBQyxDQUFDO3FCQUN0RDtvQkFDRCxHQUFHLEVBQUU7d0JBQ0osR0FBRyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQzt3QkFDMUMsVUFBVSxFQUFFLE1BQU0sQ0FDakIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQ3BDO3dCQUNELEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUM7cUJBQzlDO29CQUNELEdBQUcsRUFBRTt3QkFDSixDQUFDLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUN0QyxDQUFDLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUN0QyxDQUFDLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO3FCQUN0QztvQkFDRCxHQUFHLEVBQUU7d0JBQ0osR0FBRyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQzt3QkFDMUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQzt3QkFDOUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQztxQkFDNUM7b0JBQ0QsR0FBRyxFQUFFO3dCQUNKLENBQUMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQ3RDLENBQUMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQ3RDLENBQUMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ3RDO2lCQUNEO2dCQUNELEdBQUcsRUFBRTtvQkFDSixJQUFJLEVBQUUsUUFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJO29CQUNoSixHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHO29CQUNuQyxHQUFHLEVBQUUsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMs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QUFFLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2lCQUNoQztnQkFDRCxNQUFNLEVBQUUsSUFBSTthQUNaLENBQUM7UUFDSCxLQUFLLElBQUk7WUFDUixPQUFPO2dCQUNOLEtBQUssRUFBRTtvQkFDTixVQUFVLEVBQUUsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7b0JBQ2pDLEtBQUssRUFBRSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztpQkFDNUI7Z0JBQ0QsTUFBTSxFQUFFLElBQUk7YUFDWixDQUFDO1FBQ0gsS0FBSyxLQUFLO1lBQ1QsT0FBTztnQkFDTixLQUFLLEVBQUU7b0JBQ04sQ0FBQyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO29CQUNuQixDQUFDLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7b0JBQ25CLENBQUMsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztpQkFDbkI7Z0JBQ0QsTUFBTSxFQUFFLEtBQUs7YUFDYixDQUFDO1FBQ0g7WUFDQyxNQUFNLElBQUksS0FBSyxDQUFDO3FDQUNrQixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUM3RCxDQUFDO0FBQ0YsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBMEM7SUFDcEUsWUFBWTtJQUNaLGNBQWM7SUFDZCxZQUFZO0lBQ1osaUJBQWlCO0NBQ2pCLENBQUM7QUFFRixPQUFPLEVBQUUsY0FBYyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaWxlOiBjb21tb24vdHJhbnNmb3JtLmpzXG5cbmltcG9ydCB7XG5cdENvbG9yLFxuXHRDb21tb25Gbl9NYXN0ZXJJbnRlcmZhY2UsXG5cdEhleCxcblx0UGFsZXR0ZSxcblx0VW5icmFuZGVkQ29sb3IsXG5cdFVuYnJhbmRlZFBhbGV0dGVcbn0gZnJvbSAnLi4vdHlwZXMvaW5kZXguanMnO1xuaW1wb3J0IHsgYnJhbmQgfSBmcm9tICcuL2NvcmUuanMnO1xuaW1wb3J0IHsgY3JlYXRlTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyL2luZGV4LmpzJztcbmltcG9ydCB7IG1vZGVEYXRhIGFzIG1vZGUgfSBmcm9tICcuLi9kYXRhL21vZGUuanMnO1xuXG5jb25zdCB0aGlzTW9kdWxlID0gJ2NvbW1vbi90cmFuc2Zvcm0vYmFzZS50cyc7XG5cbmNvbnN0IGxvZ2dlciA9IGF3YWl0IGNyZWF0ZUxvZ2dlcigpO1xuXG5mdW5jdGlvbiBhZGRIYXNoVG9IZXgoaGV4OiBIZXgpOiBIZXgge1xuXHR0cnkge1xuXHRcdHJldHVybiBoZXgudmFsdWUuaGV4LnN0YXJ0c1dpdGgoJyMnKVxuXHRcdFx0PyBoZXhcblx0XHRcdDoge1xuXHRcdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0XHRoZXg6IGJyYW5kLmFzSGV4U2V0KGAjJHtoZXgudmFsdWV9fWApXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoZXgnIGFzICdoZXgnXG5cdFx0XHRcdH07XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKGBhZGRIYXNoVG9IZXggZXJyb3I6ICR7ZXJyb3J9YCk7XG5cdH1cbn1cbmZ1bmN0aW9uIGJyYW5kUGFsZXR0ZShkYXRhOiBVbmJyYW5kZWRQYWxldHRlKTogUGFsZXR0ZSB7XG5cdHJldHVybiB7XG5cdFx0Li4uZGF0YSxcblx0XHRtZXRhZGF0YTogeyAuLi5kYXRhLm1ldGFkYXRhIH0sXG5cdFx0aXRlbXM6IGRhdGEuaXRlbXMubWFwKGl0ZW0gPT4gKHtcblx0XHRcdGNvbG9yczoge1xuXHRcdFx0XHRtYWluOiB7XG5cdFx0XHRcdFx0Y215azoge1xuXHRcdFx0XHRcdFx0Y3lhbjogYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRpdGVtLmNvbG9ycy5tYWluLmNteWsuY3lhbiA/PyAwXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bWFnZW50YTogYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRpdGVtLmNvbG9ycy5tYWluLmNteWsubWFnZW50YSA/PyAwXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0eWVsbG93OiBicmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRcdGl0ZW0uY29sb3JzLm1haW4uY215ay55ZWxsb3cgPz8gMFxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGtleTogYnJhbmQuYXNQZXJjZW50aWxlKGl0ZW0uY29sb3JzLm1haW4uY215ay5rZXkgPz8gMClcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGhleDoge1xuXHRcdFx0XHRcdFx0aGV4OiBicmFuZC5hc0hleFNldChcblx0XHRcdFx0XHRcdFx0aXRlbS5jb2xvcnMubWFpbi5oZXguaGV4ID8/ICcjMDAwMDAwJ1xuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0aHNsOiB7XG5cdFx0XHRcdFx0XHRodWU6IGJyYW5kLmFzUmFkaWFsKGl0ZW0uY29sb3JzLm1haW4uaHNsLmh1ZSA/PyAwKSxcblx0XHRcdFx0XHRcdHNhdHVyYXRpb246IGJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0aXRlbS5jb2xvcnMubWFpbi5oc2wuc2F0dXJhdGlvbiA/PyAwXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bGlnaHRuZXNzOiBicmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRcdGl0ZW0uY29sb3JzLm1haW4uaHNsLmxpZ2h0bmVzcyA/PyAwXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRoc3Y6IHtcblx0XHRcdFx0XHRcdGh1ZTogYnJhbmQuYXNSYWRpYWwoaXRlbS5jb2xvcnMubWFpbi5oc3YuaHVlID8/IDApLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRpdGVtLmNvbG9ycy5tYWluLmhzdi5zYXR1cmF0aW9uID8/IDBcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHR2YWx1ZTogYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRpdGVtLmNvbG9ycy5tYWluLmhzdi52YWx1ZSA/PyAwXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRsYWI6IHtcblx0XHRcdFx0XHRcdGw6IGJyYW5kLmFzTEFCX0woaXRlbS5jb2xvcnMubWFpbi5sYWIubCA/PyAwKSxcblx0XHRcdFx0XHRcdGE6IGJyYW5kLmFzTEFCX0EoaXRlbS5jb2xvcnMubWFpbi5sYWIuYSA/PyAwKSxcblx0XHRcdFx0XHRcdGI6IGJyYW5kLmFzTEFCX0IoaXRlbS5jb2xvcnMubWFpbi5sYWIuYiA/PyAwKVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0cmdiOiB7XG5cdFx0XHRcdFx0XHRyZWQ6IGJyYW5kLmFzQnl0ZVJhbmdlKGl0ZW0uY29sb3JzLm1haW4ucmdiLnJlZCA/PyAwKSxcblx0XHRcdFx0XHRcdGdyZWVuOiBicmFuZC5hc0J5dGVSYW5nZShcblx0XHRcdFx0XHRcdFx0aXRlbS5jb2xvcnMubWFpbi5yZ2IuZ3JlZW4gPz8gMFxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGJsdWU6IGJyYW5kLmFzQnl0ZVJhbmdlKGl0ZW0uY29sb3JzLm1haW4ucmdiLmJsdWUgPz8gMClcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHh5ejoge1xuXHRcdFx0XHRcdFx0eDogYnJhbmQuYXNYWVpfWChpdGVtLmNvbG9ycy5tYWluLnh5ei54ID8/IDApLFxuXHRcdFx0XHRcdFx0eTogYnJhbmQuYXNYWVpfWShpdGVtLmNvbG9ycy5tYWluLnh5ei55ID8/IDApLFxuXHRcdFx0XHRcdFx0ejogYnJhbmQuYXNYWVpfWihpdGVtLmNvbG9ycy5tYWluLnh5ei56ID8/IDApXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdHJpbmdQcm9wczoge1xuXHRcdFx0XHRcdGNteWs6IHtcblx0XHRcdFx0XHRcdGN5YW46IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLmNteWsuY3lhbiA/PyAwKSxcblx0XHRcdFx0XHRcdG1hZ2VudGE6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLmNteWsubWFnZW50YSA/PyAwKSxcblx0XHRcdFx0XHRcdHllbGxvdzogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4uY215ay55ZWxsb3cgPz8gMCksXG5cdFx0XHRcdFx0XHRrZXk6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLmNteWsua2V5ID8/IDApXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRoZXg6IHtcblx0XHRcdFx0XHRcdGhleDogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4uaGV4LmhleCA/PyAnIzAwMDAwMCcpXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRoc2w6IHtcblx0XHRcdFx0XHRcdGh1ZTogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4uaHNsLmh1ZSA/PyAwKSxcblx0XHRcdFx0XHRcdHNhdHVyYXRpb246IFN0cmluZyhcblx0XHRcdFx0XHRcdFx0aXRlbS5jb2xvcnMubWFpbi5oc2wuc2F0dXJhdGlvbiA/PyAwXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bGlnaHRuZXNzOiBTdHJpbmcoaXRlbS5jb2xvcnMubWFpbi5oc2wubGlnaHRuZXNzID8/IDApXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRoc3Y6IHtcblx0XHRcdFx0XHRcdGh1ZTogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4uaHN2Lmh1ZSA/PyAwKSxcblx0XHRcdFx0XHRcdHNhdHVyYXRpb246IFN0cmluZyhcblx0XHRcdFx0XHRcdFx0aXRlbS5jb2xvcnMubWFpbi5oc3Yuc2F0dXJhdGlvbiA/PyAwXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0dmFsdWU6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLmhzdi52YWx1ZSA/PyAwKVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0bGFiOiB7XG5cdFx0XHRcdFx0XHRsOiBTdHJpbmcoaXRlbS5jb2xvcnMubWFpbi5sYWIubCA/PyAwKSxcblx0XHRcdFx0XHRcdGE6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLmxhYi5hID8/IDApLFxuXHRcdFx0XHRcdFx0YjogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4ubGFiLmIgPz8gMClcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHJnYjoge1xuXHRcdFx0XHRcdFx0cmVkOiBTdHJpbmcoaXRlbS5jb2xvcnMubWFpbi5yZ2IucmVkID8/IDApLFxuXHRcdFx0XHRcdFx0Z3JlZW46IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLnJnYi5ncmVlbiA/PyAwKSxcblx0XHRcdFx0XHRcdGJsdWU6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLnJnYi5ibHVlID8/IDApXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHR4eXo6IHtcblx0XHRcdFx0XHRcdHg6IFN0cmluZyhpdGVtLmNvbG9ycy5tYWluLnh5ei54ID8/IDApLFxuXHRcdFx0XHRcdFx0eTogU3RyaW5nKGl0ZW0uY29sb3JzLm1haW4ueHl6LnkgPz8gMCksXG5cdFx0XHRcdFx0XHR6OiBTdHJpbmcoaXRlbS5jb2xvcnMubWFpbi54eXoueiA/PyAwKVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSxcblx0XHRcdFx0Y3NzOiB7XG5cdFx0XHRcdFx0Y215azogYGNteWsoJHtpdGVtLmNvbG9ycy5tYWluLmNteWsuY3lhbn0lLCAke2l0ZW0uY29sb3JzLm1haW4uY215ay5tYWdlbnRhfSUsICR7aXRlbS5jb2xvcnMubWFpbi5jbXlrLnllbGxvd30lLCAke2l0ZW0uY29sb3JzLm1haW4uY215ay5rZXl9JSlgLFxuXHRcdFx0XHRcdGhleDogYCR7aXRlbS5jb2xvcnMubWFpbi5oZXguaGV4fX1gLFxuXHRcdFx0XHRcdGhzbDogYGhzbCgke2l0ZW0uY29sb3JzLm1haW4uaHNsLmh1ZX0sICR7aXRlbS5jb2xvcnMubWFpbi5oc2wuc2F0dXJhdGlvbn0lLCAke2l0ZW0uY29sb3JzLm1haW4uaHNsLmxpZ2h0bmVzc30lKWAsXG5cdFx0XHRcdFx0aHN2OiBgaHN2KCR7aXRlbS5jb2xvcnMubWFpbi5oc3YuaHVlfSwgJHtpdGVtLmNvbG9ycy5tYWluLmhzdi5zYXR1cmF0aW9ufSUsICR7aXRlbS5jb2xvcnMubWFpbi5oc3YudmFsdWV9JSlgLFxuXHRcdFx0XHRcdGxhYjogYGxhYigke2l0ZW0uY29sb3JzLm1haW4ubGFiLmx9LCAke2l0ZW0uY29sb3JzLm1haW4ubGFiLmF9LCAke2l0ZW0uY29sb3JzLm1haW4ubGFiLmJ9KWAsXG5cdFx0XHRcdFx0cmdiOiBgcmdiKCR7aXRlbS5jb2xvcnMubWFpbi5yZ2IucmVkfSwgJHtpdGVtLmNvbG9ycy5tYWluLnJnYi5ncmVlbn0sICR7aXRlbS5jb2xvcnMubWFpbi5yZ2IuYmx1ZX0pYCxcblx0XHRcdFx0XHR4eXo6IGB4eXooJHtpdGVtLmNvbG9ycy5tYWluLnh5ei54fSwgJHtpdGVtLmNvbG9ycy5tYWluLnh5ei55fSwgJHtpdGVtLmNvbG9ycy5tYWluLnh5ei56fSlgXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KSlcblx0fTtcbn1cblxuZnVuY3Rpb24gY29tcG9uZW50VG9IZXgoY29tcG9uZW50OiBudW1iZXIpOiBzdHJpbmcge1xuXHRjb25zdCB0aGlzTWV0aG9kID0gJ2NvbW1vbiA+IHRyYW5zZm9ybSA+IGJhc2UgPiBjb21wb25lbnRUb0hleCgpJztcblxuXHR0cnkge1xuXHRcdGNvbnN0IGhleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgY29tcG9uZW50KSkudG9TdHJpbmcoMTYpO1xuXG5cdFx0cmV0dXJuIGhleC5sZW5ndGggPT09IDEgPyAnMCcgKyBoZXggOiBoZXg7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0aWYgKCFtb2RlLnF1aWV0ICYmIG1vZGUubG9nZ2luZy5lcnJvcilcblx0XHRcdGxvZ2dlci5lcnJvcihcblx0XHRcdFx0YGNvbXBvbmVudFRvSGV4IGVycm9yOiAke2Vycm9yfWAsXG5cdFx0XHRcdGAke3RoaXNNb2R1bGV9ID4gJHt0aGlzTWV0aG9kfWBcblx0XHRcdCk7XG5cblx0XHRyZXR1cm4gJzAwJztcblx0fVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0Q29sb3JWYWx1ZShjb2xvcjogVW5icmFuZGVkQ29sb3IpOiBDb2xvciB7XG5cdHN3aXRjaCAoY29sb3IuZm9ybWF0KSB7XG5cdFx0Y2FzZSAnY215ayc6XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGN5YW46IGJyYW5kLmFzUGVyY2VudGlsZSgwKSxcblx0XHRcdFx0XHRtYWdlbnRhOiBicmFuZC5hc1BlcmNlbnRpbGUoMCksXG5cdFx0XHRcdFx0eWVsbG93OiBicmFuZC5hc1BlcmNlbnRpbGUoMCksXG5cdFx0XHRcdFx0a2V5OiBicmFuZC5hc1BlcmNlbnRpbGUoMClcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnY215aydcblx0XHRcdH07XG5cdFx0Y2FzZSAnaGV4Jzpcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0aGV4OiBicmFuZC5hc0hleFNldCgnIzAwMDAwMCcpXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hleCdcblx0XHRcdH07XG5cdFx0Y2FzZSAnaHNsJzpcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0aHVlOiBicmFuZC5hc1JhZGlhbCgwKSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiBicmFuZC5hc1BlcmNlbnRpbGUoMCksXG5cdFx0XHRcdFx0bGlnaHRuZXNzOiBicmFuZC5hc1BlcmNlbnRpbGUoMClcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0fTtcblx0XHRjYXNlICdoc3YnOlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRodWU6IGJyYW5kLmFzUmFkaWFsKDApLFxuXHRcdFx0XHRcdHNhdHVyYXRpb246IGJyYW5kLmFzUGVyY2VudGlsZSgwKSxcblx0XHRcdFx0XHR2YWx1ZTogYnJhbmQuYXNQZXJjZW50aWxlKDApXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzdidcblx0XHRcdH07XG5cdFx0Y2FzZSAnbGFiJzpcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0bDogYnJhbmQuYXNMQUJfTCgwKSxcblx0XHRcdFx0XHRhOiBicmFuZC5hc0xBQl9BKDApLFxuXHRcdFx0XHRcdGI6IGJyYW5kLmFzTEFCX0IoMClcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnbGFiJ1xuXHRcdFx0fTtcblx0XHRjYXNlICdyZ2InOlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRyZWQ6IGJyYW5kLmFzQnl0ZVJhbmdlKDApLFxuXHRcdFx0XHRcdGdyZWVuOiBicmFuZC5hc0J5dGVSYW5nZSgwKSxcblx0XHRcdFx0XHRibHVlOiBicmFuZC5hc0J5dGVSYW5nZSgwKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmb3JtYXQ6ICdyZ2InXG5cdFx0XHR9O1xuXHRcdGNhc2UgJ3NsJzpcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0c2F0dXJhdGlvbjogYnJhbmQuYXNQZXJjZW50aWxlKDApLFxuXHRcdFx0XHRcdGxpZ2h0bmVzczogYnJhbmQuYXNQZXJjZW50aWxlKDApXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ3NsJ1xuXHRcdFx0fTtcblx0XHRjYXNlICdzdic6XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdHNhdHVyYXRpb246IGJyYW5kLmFzUGVyY2VudGlsZSgwKSxcblx0XHRcdFx0XHR2YWx1ZTogYnJhbmQuYXNQZXJjZW50aWxlKDApXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ3N2J1xuXHRcdFx0fTtcblx0XHRjYXNlICd4eXonOlxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHR4OiBicmFuZC5hc1hZWl9YKDApLFxuXHRcdFx0XHRcdHk6IGJyYW5kLmFzWFlaX1koMCksXG5cdFx0XHRcdFx0ejogYnJhbmQuYXNYWVpfWigwKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmb3JtYXQ6ICd4eXonXG5cdFx0XHR9O1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFxuXHRcdFx0XHRVbmtub3duIGNvbG9yIGZvcm1hdFxcbkRldGFpbHM6ICR7SlNPTi5zdHJpbmdpZnkoY29sb3IpfWApO1xuXHR9XG59XG5cbmV4cG9ydCBjb25zdCB0cmFuc2Zvcm1VdGlsczogQ29tbW9uRm5fTWFzdGVySW50ZXJmYWNlWyd0cmFuc2Zvcm0nXSA9IHtcblx0YWRkSGFzaFRvSGV4LFxuXHRjb21wb25lbnRUb0hleCxcblx0YnJhbmRQYWxldHRlLFxuXHRkZWZhdWx0Q29sb3JWYWx1ZVxufTtcblxuZXhwb3J0IHsgY29tcG9uZW50VG9IZXggfTtcbiJdfQ==