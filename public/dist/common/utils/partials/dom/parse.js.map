{"version":3,"file":"parse.js","sources":["../../../../../../../src/common/utils/partials/dom/parse.ts"],"sourcesContent":["// File: common/utils/dom/partials/parse.ts\n\nimport {\n\tDOMParsingUtils,\n\tHex,\n\tHSL,\n\tRGB,\n\tServices,\n\tUtilities\n} from '../../../../types/index.js';\nimport { regex } from '../../../../config/index.js';\n\nexport function domParsingUtilsFactory(\n\tservices: Services,\n\tutils: Utilities\n): DOMParsingUtils {\n\tconst { brand } = utils;\n\tconst { log } = services;\n\n\treturn {\n\t\tparseCheckbox(id: string): boolean | void {\n\t\t\tconst checkbox = document.getElementById(\n\t\t\t\tid\n\t\t\t) as HTMLInputElement | null;\n\n\t\t\treturn checkbox ? checkbox.checked : undefined;\n\t\t},\n\t\tparseColorInput(input: HTMLInputElement): Hex | HSL | RGB | null {\n\t\t\tconst colorStr = input.value.trim().toLowerCase();\n\t\t\tconst hexMatch = colorStr.match(regex.dom.hex);\n\t\t\tconst hslMatch = colorStr.match(regex.dom.hsl);\n\t\t\tconst rgbMatch = colorStr.match(regex.dom.rgb);\n\n\t\t\tif (hexMatch) {\n\t\t\t\tlet hex = hexMatch[1];\n\t\t\t\tif (hex.length === 3) {\n\t\t\t\t\thex = hex\n\t\t\t\t\t\t.split('')\n\t\t\t\t\t\t.map(c => c + c)\n\t\t\t\t\t\t.join('');\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'hex',\n\t\t\t\t\tvalue: { hex: utils.brand.asHexSet(`#${hex}`) }\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (hslMatch) {\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'hsl',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\thue: brand.asRadial(parseInt(hslMatch[1], 10)),\n\t\t\t\t\t\tsaturation: brand.asPercentile(parseFloat(hslMatch[2])),\n\t\t\t\t\t\tlightness: brand.asPercentile(parseFloat(hslMatch[3]))\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (rgbMatch) {\n\t\t\t\treturn {\n\t\t\t\t\tformat: 'rgb',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tred: brand.asByteRange(parseInt(rgbMatch[1], 10)),\n\t\t\t\t\t\tgreen: brand.asByteRange(parseInt(rgbMatch[2], 10)),\n\t\t\t\t\t\tblue: brand.asByteRange(parseInt(rgbMatch[3], 10))\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// handle named colors\n\t\t\tconst testElement = document.createElement('div');\n\t\t\ttestElement.style.color = colorStr;\n\n\t\t\tif (testElement.style.color !== '') {\n\t\t\t\tconst ctx = document.createElement('canvas').getContext('2d');\n\n\t\t\t\tif (ctx) {\n\t\t\t\t\tctx.fillStyle = colorStr;\n\n\t\t\t\t\tconst rgb = ctx.fillStyle.match(/\\d+/g)?.map(Number);\n\n\t\t\t\t\tif (rgb && rgb.length === 3) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tformat: 'rgb',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\tred: brand.asByteRange(rgb[0]),\n\t\t\t\t\t\t\t\tgreen: brand.asByteRange(rgb[1]),\n\t\t\t\t\t\t\t\tblue: brand.asByteRange(rgb[2])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlog(`Invalid color input: ${colorStr}`, 'warn');\n\n\t\t\treturn null;\n\t\t},\n\t\tparseDropdownSelection(\n\t\t\tid: string,\n\t\t\tvalidOptions: string[]\n\t\t): string | void {\n\t\t\tconst dropdown = document.getElementById(\n\t\t\t\tid\n\t\t\t) as HTMLSelectElement | null;\n\n\t\t\tif (!dropdown) return;\n\n\t\t\tconst selectedValue = dropdown.value;\n\n\t\t\tif (!validOptions.includes(selectedValue)) {\n\t\t\t\treturn validOptions.includes(selectedValue)\n\t\t\t\t\t? selectedValue\n\t\t\t\t\t: undefined;\n\t\t\t}\n\t\t},\n\t\tparseNumberInput(\n\t\t\tinput: HTMLInputElement,\n\t\t\tmin?: number,\n\t\t\tmax?: number\n\t\t): number | null {\n\t\t\tconst value = parseFloat(input.value.trim());\n\n\t\t\tif (isNaN(value)) return null;\n\n\t\t\tif (min !== undefined && value < min) return min;\n\t\t\tif (max !== undefined && value > max) return max;\n\n\t\t\treturn value;\n\t\t},\n\t\tparseTextInput(input: HTMLInputElement, regex?: RegExp): string | null {\n\t\t\tconst text = input.value.trim();\n\n\t\t\tif (regex && !regex.test(text)) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn text || null;\n\t\t}\n\t};\n}\n"],"names":[],"mappings":"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"}