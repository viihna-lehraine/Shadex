// File: io/parse/color.js
import { commonFn } from '../../common/index.js';
import { configData as config } from '../../data/config.js';
const brand = commonFn.core.brand;
const regex = config.regex;
const colorParsers = {};
const cmykParser = {
    parse(input) {
        const match = input.match(regex.colors.cmyk);
        if (!match) {
            throw new Error(`Invalid CMYK string format: ${input}`);
        }
        const [_, cyan, magenta, yellow, key, alpha = '1'] = match;
        const value = {
            cyan: brand.asPercentile(parseFloat(cyan) / 100),
            magenta: brand.asPercentile(parseFloat(magenta) / 100),
            yellow: brand.asPercentile(parseFloat(yellow) / 100),
            key: brand.asPercentile(parseFloat(key) / 100),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'cmyk', value };
    }
};
const hexParser = {
    parse(input) {
        const match = input.match(regex.colors.hex);
        if (!match) {
            throw new Error(`Invalid Hex string format: ${input}`);
        }
        const hex = brand.asHexSet(match[1].substring(0, 6));
        const alpha = brand.asHexComponent(String(match[1].length === 8
            ? parseInt(match[1].substring(6, 8), 16) / 255
            : 1));
        const numAlpha = brand.asAlphaRange(alpha);
        return {
            format: 'hex',
            value: { hex, alpha, numAlpha }
        };
    }
};
const hslParser = {
    parse(input) {
        const match = input.match(regex.colors.hsl);
        if (!match) {
            throw new Error(`Invalid HSL string format: ${input}`);
        }
        const [_, hue, saturation, lightness, alpha = '1'] = match;
        const value = {
            hue: brand.asRadial(parseFloat(hue)),
            saturation: brand.asPercentile(parseFloat(saturation) / 100),
            lightness: brand.asPercentile(parseFloat(lightness) / 100),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'hsl', value };
    }
};
const hsvParser = {
    parse(input) {
        const match = input.match(regex.colors.hsv);
        if (!match) {
            throw new Error(`Invalid HSV string format: ${input}`);
        }
        const [_, hue, saturation, value, alpha = '1'] = match;
        const hsvValue = {
            hue: brand.asRadial(parseFloat(hue)),
            saturation: brand.asPercentile(parseFloat(saturation) / 100),
            value: brand.asPercentile(parseFloat(value) / 100),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'hsv', value: hsvValue };
    }
};
const labParser = {
    parse(input) {
        const match = input.match(regex.colors.lab);
        if (!match) {
            throw new Error(`Invalid LAB string format: ${input}`);
        }
        const [_, l, a, b, alpha = '1'] = match;
        const labValue = {
            l: brand.asLAB_L(parseFloat(l)),
            a: brand.asLAB_A(parseFloat(a)),
            b: brand.asLAB_B(parseFloat(b)),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'lab', value: labValue };
    }
};
const rgbParser = {
    parse(input) {
        const match = input.match(regex.colors.rgb);
        if (!match) {
            throw new Error(`Invalid RGB string format: ${input}`);
        }
        const [_, red, green, blue, alpha = '1'] = match;
        const rgbValue = {
            red: brand.asByteRange(parseFloat(red)),
            green: brand.asByteRange(parseFloat(green)),
            blue: brand.asByteRange(parseFloat(blue)),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'rgb', value: rgbValue };
    }
};
const xyzParser = {
    parse(input) {
        const match = input.match(regex.colors.xyz);
        if (!match) {
            throw new Error(`Invalid XYZ string format: ${input}`);
        }
        const [_, x, y, z, alpha = '1'] = match;
        const xyzValue = {
            x: brand.asXYZ_X(parseFloat(x)),
            y: brand.asXYZ_Y(parseFloat(y)),
            z: brand.asXYZ_Z(parseFloat(z)),
            alpha: brand.asAlphaRange(parseFloat(alpha))
        };
        return { format: 'xyz', value: xyzValue };
    }
};
colorParsers['cmyk'] = cmykParser;
colorParsers['hex'] = hexParser;
colorParsers['hsl'] = hslParser;
colorParsers['hsv'] = hsvParser;
colorParsers['lab'] = labParser;
colorParsers['rgb'] = rgbParser;
colorParsers['xyz'] = xyzParser;
export function asColorString(format, input) {
    const parser = colorParsers[format.toLowerCase()];
    if (!parser) {
        throw new Error(`No parser available for format: ${format}`);
    }
    return parser.parse(input);
}
// ******** CSS COLOR STRINGS ********
export function asCSSColorString(format, input) {
    const color = asColorString(format, input);
    switch (color.format) {
        case 'cmyk':
            const cmyk = color.value;
            return `cmyk(${cmyk.cyan * 100}%, ${cmyk.magenta * 100}%, ${cmyk.yellow * 100}%, ${cmyk.key * 100}${cmyk.alpha !== 1 ? `, ${cmyk.alpha}` : ''})`;
        case 'hex':
            const hex = color.value;
            return `#${hex.hex}${String(hex.alpha) !== 'FF' ? hex.alpha : ''}`;
        case 'hsl':
            const hsl = color.value;
            return `hsl(${hsl.hue}, ${hsl.saturation * 100}%, ${hsl.lightness * 100}%${hsl.alpha !== 1 ? `, ${hsl.alpha}` : ''})`;
        case 'hsv':
            const hsv = color.value;
            return `hsv(${hsv.hue}, ${hsv.saturation * 100}%, ${hsv.value * 100}%${hsv.alpha !== 1 ? `, ${hsv.alpha}` : ''})`;
        case 'lab':
            const lab = color.value;
            return `lab(${lab.l}, ${lab.a}, ${lab.b}${lab.alpha !== 1 ? `, ${lab.alpha}` : ''})`;
        case 'rgb':
            const rgb = color.value;
            return `rgb(${rgb.red}, ${rgb.green}, ${rgb.blue}${rgb.alpha !== 1 ? `, ${rgb.alpha}` : ''})`;
        case 'xyz':
            const xyz = color.value;
            return `xyz(${xyz.x}, ${xyz.y}, ${xyz.z}${xyz.alpha !== 1 ? `, ${xyz.alpha}` : ''})`;
        default:
            throw new Error(`Unsupported color format: ${color.format}`);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sb3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvaW8vcGFyc2UvY29sb3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsMEJBQTBCO0FBYTFCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNqRCxPQUFPLEVBQUUsVUFBVSxJQUFJLE1BQU0sRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTVELE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBQ2xDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7QUFFM0IsTUFBTSxZQUFZLEdBQWdDLEVBQUUsQ0FBQztBQUVyRCxNQUFNLFVBQVUsR0FBZ0I7SUFDL0IsS0FBSyxDQUFDLEtBQWE7UUFDbEIsTUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRTdDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNaLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDekQsQ0FBQztRQUVELE1BQU0sQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEtBQUssR0FBRyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUM7UUFFM0QsTUFBTSxLQUFLLEdBQWtCO1lBQzVCLElBQUksRUFBRSxLQUFLLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDaEQsT0FBTyxFQUFFLEtBQUssQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQztZQUN0RCxNQUFNLEVBQUUsS0FBSyxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDO1lB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QUssS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUN0QyxHQUFHLENBQUM7UUFFTCxLQUFLLEtBQUs7WUFDVCxNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsS0FBcUIsQ0FBQztZQUN4QyxPQUFPLE9BQU8sR0FBRyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQ3RDLEdBQUcsQ0FBQyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFDdEMsR0FBRyxDQUFDO1FBRUw7WUFDQyxNQUFNLElBQUksS0FBSyxDQUFDLDZCQUE2QixLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztJQUMvRCxDQUFDO0FBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZpbGU6IGlvL3BhcnNlL2NvbG9yLmpzXG5cbmltcG9ydCB7XG5cdENNWUssXG5cdENvbG9yLFxuXHRDb2xvclBhcnNlcixcblx0SGV4LFxuXHRIU0wsXG5cdEhTVixcblx0TEFCLFxuXHRSR0IsXG5cdFhZWlxufSBmcm9tICcuLi8uLi90eXBlcy9pbmRleC5qcyc7XG5pbXBvcnQgeyBjb21tb25GbiB9IGZyb20gJy4uLy4uL2NvbW1vbi9pbmRleC5qcyc7XG5pbXBvcnQgeyBjb25maWdEYXRhIGFzIGNvbmZpZyB9IGZyb20gJy4uLy4uL2RhdGEvY29uZmlnLmpzJztcblxuY29uc3QgYnJhbmQgPSBjb21tb25Gbi5jb3JlLmJyYW5kO1xuY29uc3QgcmVnZXggPSBjb25maWcucmVnZXg7XG5cbmNvbnN0IGNvbG9yUGFyc2VyczogUmVjb3JkPHN0cmluZywgQ29sb3JQYXJzZXI+ID0ge307XG5cbmNvbnN0IGNteWtQYXJzZXI6IENvbG9yUGFyc2VyID0ge1xuXHRwYXJzZShpbnB1dDogc3RyaW5nKTogQ01ZSyB7XG5cdFx0Y29uc3QgbWF0Y2ggPSBpbnB1dC5tYXRjaChyZWdleC5jb2xvcnMuY215ayk7XG5cblx0XHRpZiAoIW1hdGNoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgQ01ZSyBzdHJpbmcgZm9ybWF0OiAke2lucHV0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IFtfLCBjeWFuLCBtYWdlbnRhLCB5ZWxsb3csIGtleSwgYWxwaGEgPSAnMSddID0gbWF0Y2g7XG5cblx0XHRjb25zdCB2YWx1ZTogQ01ZS1sndmFsdWUnXSA9IHtcblx0XHRcdGN5YW46IGJyYW5kLmFzUGVyY2VudGlsZShwYXJzZUZsb2F0KGN5YW4pIC8gMTAwKSxcblx0XHRcdG1hZ2VudGE6IGJyYW5kLmFzUGVyY2VudGlsZShwYXJzZUZsb2F0KG1hZ2VudGEpIC8gMTAwKSxcblx0XHRcdHllbGxvdzogYnJhbmQuYXNQZXJjZW50aWxlKHBhcnNlRmxvYXQoeWVsbG93KSAvIDEwMCksXG5cdFx0XHRrZXk6IGJyYW5kLmFzUGVyY2VudGlsZShwYXJzZUZsb2F0KGtleSkgLyAxMDApLFxuXHRcdFx0YWxwaGE6IGJyYW5kLmFzQWxwaGFSYW5nZShwYXJzZUZsb2F0KGFscGhhKSlcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHsgZm9ybWF0OiAnY215aycsIHZhbHVlIH07XG5cdH1cbn07XG5cbmNvbnN0IGhleFBhcnNlcjogQ29sb3JQYXJzZXIgPSB7XG5cdHBhcnNlKGlucHV0OiBzdHJpbmcpOiBIZXgge1xuXHRcdGNvbnN0IG1hdGNoID0gaW5wdXQubWF0Y2gocmVnZXguY29sb3JzLmhleCk7XG5cblx0XHRpZiAoIW1hdGNoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgSGV4IHN0cmluZyBmb3JtYXQ6ICR7aW5wdXR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgaGV4ID0gYnJhbmQuYXNIZXhTZXQobWF0Y2hbMV0uc3Vic3RyaW5nKDAsIDYpKTtcblx0XHRjb25zdCBhbHBoYSA9IGJyYW5kLmFzSGV4Q29tcG9uZW50KFxuXHRcdFx0U3RyaW5nKFxuXHRcdFx0XHRtYXRjaFsxXS5sZW5ndGggPT09IDhcblx0XHRcdFx0XHQ/IHBhcnNlSW50KG1hdGNoWzFdLnN1YnN0cmluZyg2LCA4KSwgMTYpIC8gMjU1XG5cdFx0XHRcdFx0OiAxXG5cdFx0XHQpXG5cdFx0KTtcblx0XHRjb25zdCBudW1BbHBoYSA9IGJyYW5kLmFzQWxwaGFSYW5nZShhbHBoYSk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0Zm9ybWF0OiAnaGV4Jyxcblx0XHRcdHZhbHVlOiB7IGhleCwgYWxwaGEsIG51bUFscGhhIH1cblx0XHR9O1xuXHR9XG59O1xuXG5jb25zdCBoc2xQYXJzZXI6IENvbG9yUGFyc2VyID0ge1xuXHRwYXJzZShpbnB1dDogc3RyaW5nKTogSFNMIHtcblx0XHRjb25zdCBtYXRjaCA9IGlucHV0Lm1hdGNoKHJlZ2V4LmNvbG9ycy5oc2wpO1xuXG5cdFx0aWYgKCFtYXRjaCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEhTTCBzdHJpbmcgZm9ybWF0OiAke2lucHV0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IFtfLCBodWUsIHNhdHVyYXRpb24sIGxpZ2h0bmVzcywgYWxwaGEgPSAnMSddID0gbWF0Y2g7XG5cblx0XHRjb25zdCB2YWx1ZTogSFNMWyd2YWx1ZSddID0ge1xuXHRcdFx0aHVlOiBicmFuZC5hc1JhZGlhbChwYXJzZUZsb2F0KGh1ZSkpLFxuXHRcdFx0c2F0dXJhdGlvbjogYnJhbmQuYXNQZXJjZW50aWxlKHBhcnNlRmxvYXQoc2F0dXJhdGlvbikgLyAxMDApLFxuXHRcdFx0bGlnaHRuZXNzOiBicmFuZC5hc1BlcmNlbnRpbGUocGFyc2VGbG9hdChsaWdodG5lc3MpIC8gMTAwKSxcblx0XHRcdGFscGhhOiBicmFuZC5hc0FscGhhUmFuZ2UocGFyc2VGbG9hdChhbHBoYSkpXG5cdFx0fTtcblxuXHRcdHJldHVybiB7IGZvcm1hdDogJ2hzbCcsIHZhbHVlIH07XG5cdH1cbn07XG5cbmNvbnN0IGhzdlBhcnNlcjogQ29sb3JQYXJzZXIgPSB7XG5cdHBhcnNlKGlucHV0OiBzdHJpbmcpOiBIU1Yge1xuXHRcdGNvbnN0IG1hdGNoID0gaW5wdXQubWF0Y2gocmVnZXguY29sb3JzLmhzdik7XG5cblx0XHRpZiAoIW1hdGNoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgSFNWIHN0cmluZyBmb3JtYXQ6ICR7aW5wdXR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgW18sIGh1ZSwgc2F0dXJhdGlvbiwgdmFsdWUsIGFscGhhID0gJzEnXSA9IG1hdGNoO1xuXG5cdFx0Y29uc3QgaHN2VmFsdWU6IEhTVlsndmFsdWUnXSA9IHtcblx0XHRcdGh1ZTogYnJhbmQuYXNSYWRpYWwocGFyc2VGbG9hdChodWUpKSxcblx0XHRcdHNhdHVyYXRpb246IGJyYW5kLmFzUGVyY2VudGlsZShwYXJzZUZsb2F0KHNhdHVyYXRpb24pIC8gMTAwKSxcblx0XHRcdHZhbHVlOiBicmFuZC5hc1BlcmNlbnRpbGUocGFyc2VGbG9hdCh2YWx1ZSkgLyAxMDApLFxuXHRcdFx0YWxwaGE6IGJyYW5kLmFzQWxwaGFSYW5nZShwYXJzZUZsb2F0KGFscGhhKSlcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHsgZm9ybWF0OiAnaHN2JywgdmFsdWU6IGhzdlZhbHVlIH07XG5cdH1cbn07XG5cbmNvbnN0IGxhYlBhcnNlcjogQ29sb3JQYXJzZXIgPSB7XG5cdHBhcnNlKGlucHV0OiBzdHJpbmcpOiBMQUIge1xuXHRcdGNvbnN0IG1hdGNoID0gaW5wdXQubWF0Y2gocmVnZXguY29sb3JzLmxhYik7XG5cblx0XHRpZiAoIW1hdGNoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgTEFCIHN0cmluZyBmb3JtYXQ6ICR7aW5wdXR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgW18sIGwsIGEsIGIsIGFscGhhID0gJzEnXSA9IG1hdGNoO1xuXG5cdFx0Y29uc3QgbGFiVmFsdWU6IExBQlsndmFsdWUnXSA9IHtcblx0XHRcdGw6IGJyYW5kLmFzTEFCX0wocGFyc2VGbG9hdChsKSksXG5cdFx0XHRhOiBicmFuZC5hc0xBQl9BKHBhcnNlRmxvYXQoYSkpLFxuXHRcdFx0YjogYnJhbmQuYXNMQUJfQihwYXJzZUZsb2F0KGIpKSxcblx0XHRcdGFscGhhOiBicmFuZC5hc0FscGhhUmFuZ2UocGFyc2VGbG9hdChhbHBoYSkpXG5cdFx0fTtcblxuXHRcdHJldHVybiB7IGZvcm1hdDogJ2xhYicsIHZhbHVlOiBsYWJWYWx1ZSB9O1xuXHR9XG59O1xuXG5jb25zdCByZ2JQYXJzZXI6IENvbG9yUGFyc2VyID0ge1xuXHRwYXJzZShpbnB1dDogc3RyaW5nKTogUkdCIHtcblx0XHRjb25zdCBtYXRjaCA9IGlucHV0Lm1hdGNoKHJlZ2V4LmNvbG9ycy5yZ2IpO1xuXG5cdFx0aWYgKCFtYXRjaCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIFJHQiBzdHJpbmcgZm9ybWF0OiAke2lucHV0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IFtfLCByZWQsIGdyZWVuLCBibHVlLCBhbHBoYSA9ICcxJ10gPSBtYXRjaDtcblxuXHRcdGNvbnN0IHJnYlZhbHVlOiBSR0JbJ3ZhbHVlJ10gPSB7XG5cdFx0XHRyZWQ6IGJyYW5kLmFzQnl0ZVJhbmdlKHBhcnNlRmxvYXQocmVkKSksXG5cdFx0XHRncmVlbjogYnJhbmQuYXNCeXRlUmFuZ2UocGFyc2VGbG9hdChncmVlbikpLFxuXHRcdFx0Ymx1ZTogYnJhbmQuYXNCeXRlUmFuZ2UocGFyc2VGbG9hdChibHVlKSksXG5cdFx0XHRhbHBoYTogYnJhbmQuYXNBbHBoYVJhbmdlKHBhcnNlRmxvYXQoYWxwaGEpKVxuXHRcdH07XG5cblx0XHRyZXR1cm4geyBmb3JtYXQ6ICdyZ2InLCB2YWx1ZTogcmdiVmFsdWUgfTtcblx0fVxufTtcblxuY29uc3QgeHl6UGFyc2VyOiBDb2xvclBhcnNlciA9IHtcblx0cGFyc2UoaW5wdXQ6IHN0cmluZyk6IFhZWiB7XG5cdFx0Y29uc3QgbWF0Y2ggPSBpbnB1dC5tYXRjaChyZWdleC5jb2xvcnMueHl6KTtcblxuXHRcdGlmICghbWF0Y2gpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBYWVogc3RyaW5nIGZvcm1hdDogJHtpbnB1dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBbXywgeCwgeSwgeiwgYWxwaGEgPSAnMSddID0gbWF0Y2g7XG5cblx0XHRjb25zdCB4eXpWYWx1ZTogWFlaWyd2YWx1ZSddID0ge1xuXHRcdFx0eDogYnJhbmQuYXNYWVpfWChwYXJzZUZsb2F0KHgpKSxcblx0XHRcdHk6IGJyYW5kLmFzWFlaX1kocGFyc2VGbG9hdCh5KSksXG5cdFx0XHR6OiBicmFuZC5hc1hZWl9aKHBhcnNlRmxvYXQoeikpLFxuXHRcdFx0YWxwaGE6IGJyYW5kLmFzQWxwaGFSYW5nZShwYXJzZUZsb2F0KGFscGhhKSlcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHsgZm9ybWF0OiAneHl6JywgdmFsdWU6IHh5elZhbHVlIH07XG5cdH1cbn07XG5cbmNvbG9yUGFyc2Vyc1snY215ayddID0gY215a1BhcnNlcjtcbmNvbG9yUGFyc2Vyc1snaGV4J10gPSBoZXhQYXJzZXI7XG5jb2xvclBhcnNlcnNbJ2hzbCddID0gaHNsUGFyc2VyO1xuY29sb3JQYXJzZXJzWydoc3YnXSA9IGhzdlBhcnNlcjtcbmNvbG9yUGFyc2Vyc1snbGFiJ10gPSBsYWJQYXJzZXI7XG5jb2xvclBhcnNlcnNbJ3JnYiddID0gcmdiUGFyc2VyO1xuY29sb3JQYXJzZXJzWyd4eXonXSA9IHh5elBhcnNlcjtcblxuZXhwb3J0IGZ1bmN0aW9uIGFzQ29sb3JTdHJpbmcoZm9ybWF0OiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpOiBDb2xvciB7XG5cdGNvbnN0IHBhcnNlciA9IGNvbG9yUGFyc2Vyc1tmb3JtYXQudG9Mb3dlckNhc2UoKV07XG5cblx0aWYgKCFwYXJzZXIpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoYE5vIHBhcnNlciBhdmFpbGFibGUgZm9yIGZvcm1hdDogJHtmb3JtYXR9YCk7XG5cdH1cblxuXHRyZXR1cm4gcGFyc2VyLnBhcnNlKGlucHV0KTtcbn1cblxuLy8gKioqKioqKiogQ1NTIENPTE9SIFNUUklOR1MgKioqKioqKipcblxuZXhwb3J0IGZ1bmN0aW9uIGFzQ1NTQ29sb3JTdHJpbmcoZm9ybWF0OiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpOiBzdHJpbmcge1xuXHRjb25zdCBjb2xvciA9IGFzQ29sb3JTdHJpbmcoZm9ybWF0LCBpbnB1dCk7XG5cblx0c3dpdGNoIChjb2xvci5mb3JtYXQpIHtcblx0XHRjYXNlICdjbXlrJzpcblx0XHRcdGNvbnN0IGNteWsgPSBjb2xvci52YWx1ZSBhcyBDTVlLWyd2YWx1ZSddO1xuXHRcdFx0cmV0dXJuIGBjbXlrKCR7Y215ay5jeWFuICogMTAwfSUsICR7Y215ay5tYWdlbnRhICogMTAwfSUsICR7Y215ay55ZWxsb3cgKiAxMDB9JSwgJHtjbXlrLmtleSAqIDEwMH0ke1xuXHRcdFx0XHRjbXlrLmFscGhhICE9PSAxID8gYCwgJHtjbXlrLmFscGhhfWAgOiAnJ1xuXHRcdFx0fSlgO1xuXG5cdFx0Y2FzZSAnaGV4Jzpcblx0XHRcdGNvbnN0IGhleCA9IGNvbG9yLnZhbHVlIGFzIEhleFsndmFsdWUnXTtcblx0XHRcdHJldHVybiBgIyR7aGV4LmhleH0ke1N0cmluZyhoZXguYWxwaGEpICE9PSAnRkYnID8gaGV4LmFscGhhIDogJyd9YDtcblxuXHRcdGNhc2UgJ2hzbCc6XG5cdFx0XHRjb25zdCBoc2wgPSBjb2xvci52YWx1ZSBhcyBIU0xbJ3ZhbHVlJ107XG5cdFx0XHRyZXR1cm4gYGhzbCgke2hzbC5odWV9LCAke2hzbC5zYXR1cmF0aW9uICogMTAwfSUsICR7aHNsLmxpZ2h0bmVzcyAqIDEwMH0lJHtcblx0XHRcdFx0aHNsLmFscGhhICE9PSAxID8gYCwgJHtoc2wuYWxwaGF9YCA6ICcnXG5cdFx0XHR9KWA7XG5cblx0XHRjYXNlICdoc3YnOlxuXHRcdFx0Y29uc3QgaHN2ID0gY29sb3IudmFsdWUgYXMgSFNWWyd2YWx1ZSddO1xuXHRcdFx0cmV0dXJuIGBoc3YoJHtoc3YuaHVlfSwgJHtoc3Yuc2F0dXJhdGlvbiAqIDEwMH0lLCAke2hzdi52YWx1ZSAqIDEwMH0lJHtcblx0XHRcdFx0aHN2LmFscGhhICE9PSAxID8gYCwgJHtoc3YuYWxwaGF9YCA6ICcnXG5cdFx0XHR9KWA7XG5cblx0XHRjYXNlICdsYWInOlxuXHRcdFx0Y29uc3QgbGFiID0gY29sb3IudmFsdWUgYXMgTEFCWyd2YWx1ZSddO1xuXHRcdFx0cmV0dXJuIGBsYWIoJHtsYWIubH0sICR7bGFiLmF9LCAke2xhYi5ifSR7XG5cdFx0XHRcdGxhYi5hbHBoYSAhPT0gMSA/IGAsICR7bGFiLmFscGhhfWAgOiAnJ1xuXHRcdFx0fSlgO1xuXG5cdFx0Y2FzZSAncmdiJzpcblx0XHRcdGNvbnN0IHJnYiA9IGNvbG9yLnZhbHVlIGFzIFJHQlsndmFsdWUnXTtcblx0XHRcdHJldHVybiBgcmdiKCR7cmdiLnJlZH0sICR7cmdiLmdyZWVufSwgJHtyZ2IuYmx1ZX0ke1xuXHRcdFx0XHRyZ2IuYWxwaGEgIT09IDEgPyBgLCAke3JnYi5hbHBoYX1gIDogJydcblx0XHRcdH0pYDtcblxuXHRcdGNhc2UgJ3h5eic6XG5cdFx0XHRjb25zdCB4eXogPSBjb2xvci52YWx1ZSBhcyBYWVpbJ3ZhbHVlJ107XG5cdFx0XHRyZXR1cm4gYHh5eigke3h5ei54fSwgJHt4eXoueX0sICR7eHl6Lnp9JHtcblx0XHRcdFx0eHl6LmFscGhhICE9PSAxID8gYCwgJHt4eXouYWxwaGF9YCA6ICcnXG5cdFx0XHR9KWA7XG5cblx0XHRkZWZhdWx0OlxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBjb2xvciBmb3JtYXQ6ICR7Y29sb3IuZm9ybWF0fWApO1xuXHR9XG59XG4iXX0=