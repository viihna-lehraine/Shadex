// File: io/deserialize.js
import { createLogger } from '../logger/index.js';
import { modeData as mode } from '../data/mode.js';
const logMode = mode.logging;
const thisModule = 'io/serialize.js';
const logger = await createLogger();
async function toCSS(palette) {
    const thisMethod = 'toCSS()';
    return new Promise((resolve, reject) => {
        try {
            // 1. serialize metadata
            const metadata = `
				/* Palette Metadata */
				.palette {
					--id: "${palette.id}";
					--name: "${palette.metadata.name ?? 'Unnamed Palette'}";
					--swatches: ${palette.metadata.swatches};
					--type: "${palette.metadata.type}";
					--timestamp: "${palette.metadata.timestamp}";
					--enableAlpha: ${palette.metadata.flags.enableAlpha};
					--limitDarkness: ${palette.metadata.flags.limitDarkness};
					--limitGrayness: ${palette.metadata.flags.limitGrayness};
					--limitLightness: ${palette.metadata.flags.limitLightness};
				}`.trim();
            // 2. serialize custom color if present
            const customColor = palette.metadata.customColor
                ? `
				/* Optional Custom Color */
				.palette-custom {
					--custom-cmyk-color: "${palette.metadata.customColor.colors.main.cmyk}";
					--custom-hex-color: "${palette.metadata.customColor.colors.main.hex}";
					--custom-hsl-color: "${palette.metadata.customColor.colors.main.hsl}";
					--custom-hsv-color: "${palette.metadata.customColor.colors.main.hsv}";
					--custom-lab-color: "${palette.metadata.customColor.colors.main.lab}";
					--custom-rgb-color: "${palette.metadata.customColor.colors.main.rgb}";
					--custom-xyz-color: "${palette.metadata.customColor.colors.main.xyz}";
				}`.trim()
                : '';
            // 3. serialize palette items
            const items = palette.items
                .map(item => {
                const backgroundColor = item.colors.css.hsl;
                return `
					/* Palette Item */
					.color {
						--cmyk-color: "${item.colors.css.cmyk}";
						--hex-color: "${item.colors.css.hex}";
						--hsl-color: "${item.colors.css.hsl}";
						--hsv-color: "${item.colors.css.hsv}";
						--lab-color: "${item.colors.css.lab}";
						--rgb-color: "${item.colors.css.rgb}";
						--xyz-color: "${item.colors.css.xyz}";
						background-color: ${backgroundColor};
					}`.trim();
            })
                .join('\n\n');
            // 4. combine CSS data
            const cssData = [metadata, customColor, items]
                .filter(Boolean)
                .join('\n\n');
            // 5. resolve serialized CSS data
            resolve(cssData.trim());
        }
        catch (error) {
            if (!mode.quiet && logMode.error) {
                if (logMode.verbosity > 1) {
                    logger.error(`Failed to convert palette to CSS: ${error}`, `${thisModule} > ${thisMethod}`);
                }
                else {
                    logger.error('Failed to convert palette to CSS', `${thisModule} > ${thisMethod}`);
                }
            }
            if (mode.stackTrace) {
                console.trace('Stack Trace:');
            }
            reject(new Error(`Failed to convert palette to CSS: ${error}`));
        }
    });
}
async function toJSON(palette) {
    const thisMethod = 'toJSON()';
    return new Promise((resolve, reject) => {
        try {
            const jsonData = JSON.stringify(palette, null, 2);
            resolve(jsonData);
        }
        catch (error) {
            if (!mode.quiet && logMode.error) {
                if (logMode.verbosity > 1) {
                    logger.error(`Failed to convert palette to JSON: ${error}`, `${thisModule} > ${thisMethod}`);
                }
                else {
                    logger.error('Failed to convert palette to JSON', `${thisModule} > ${thisMethod}`);
                }
            }
            if (mode.stackTrace) {
                console.trace('Stack Trace:');
            }
            reject(new Error(`Failed to convert palette to JSON: ${error}`));
        }
    });
}
async function toXML(palette) {
    const thisMethod = 'toXML()';
    return new Promise((resolve, reject) => {
        try {
            // 1. serialize palette metadata
            const customColorXML = palette.metadata.customColor
                ? `
				<CustomColor>
					<CMYK>${palette.metadata.customColor.colors.main.cmyk}</CMYK>
					<Hex>${palette.metadata.customColor.colors.main.hex}</Hex>
					<HSL>${palette.metadata.customColor.colors.main.hsl}</HSL>
					<HSV>${palette.metadata.customColor.colors.main.hsv}</HSV>
					<LAB>${palette.metadata.customColor.colors.main.lab}</LAB>
					<RGB>${palette.metadata.customColor.colors.main.rgb}</RGB>
					<XYZ>${palette.metadata.customColor.colors.main.xyz}</XYZ>
				</CustomColor>`.trim()
                : '<CustomColor>false</CustomColor>';
            const metadata = `
				<Metadata>
					<Name>${palette.metadata.name ?? 'Unnamed Palette'}</Name>
					<Timestamp>${palette.metadata.timestamp}</Timestamp>
					<Swatches>${palette.metadata.swatches}</Swatches>
					<Type>${palette.metadata.type}</Type>
					${customColorXML}
					<Flags>
						<EnableAlpha>${palette.metadata.flags.enableAlpha}</EnableAlpha>
						<LimitDarkness>${palette.metadata.flags.limitDarkness}</LimitDarkness>
						<LimitGrayness>${palette.metadata.flags.limitGrayness}</LimitGrayness>
						<LimitLightness>${palette.metadata.flags.limitLightness}</LimitLightness>
					</Flags>
				</Metadata>`.trim();
            // 2. serialize palette items
            const xmlItems = palette.items
                .map((item, index) => `
					<PaletteItem id="${index + 1}">
						<Colors>
							<Main>
								<CMYK>${item.colors.main.cmyk}</CMYK>
								<Hex>${item.colors.main.hex}</Hex>
								<HSL>${item.colors.main.hsl}</HSL>
								<HSV>${item.colors.main.hsv}</HSV>
								<LAB>${item.colors.main.lab}</LAB>
								<RGB>${item.colors.main.rgb}</RGB>
								<XYZ>${item.colors.main.xyz}</XYZ>
							</Main>
							<CSS>
								<CMYK>${item.colors.css.cmyk}</CMYK>
								<Hex>${item.colors.css.hex}</Hex>
								<HSL>${item.colors.css.hsl}</HSL>
								<HSV>${item.colors.css.hsv}</HSV>
								<LAB>${item.colors.css.lab}</LAB>
								<RGB>${item.colors.css.rgb}</RGB>
								<XYZ>${item.colors.css.xyz}</XYZ>
							</CSS>
						</Colors>
					</PaletteItem>`.trim())
                .join('\n');
            // 3. combine metadata and items into the palette XML
            const xmlData = `
				<Palette id=${palette.id}>
					${metadata}
					<Items>
						${xmlItems}
					</Items>
				</Palette>`.trim();
            resolve(xmlData.trim());
        }
        catch (error) {
            if (!mode.quiet && logMode.error) {
                if (logMode.verbosity > 1) {
                    logger.error(`Failed to convert palette to XML: ${error}`, `${thisModule} > ${thisMethod}`);
                }
                else {
                    logger.error('Failed to convert palette to XML', `${thisModule} > ${thisMethod}`);
                }
            }
            if (mode.stackTrace) {
                console.trace('Stack Trace:');
            }
            reject(new Error(`Failed to convert palette to XML: ${error}`));
        }
    });
}
export const serialize = {
    toCSS,
    toJSON,
    toXML
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VyaWFsaXplLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2lvL3NlcmlhbGl6ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwwQkFBMEI7QUFHMUIsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxRQUFRLElBQUksSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFbkQsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUU3QixNQUFNLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQztBQUVyQyxNQUFNLE1BQU0sR0FBRyxNQUFNLFlBQVksRUFBRSxDQUFDO0FBRXBDLEtBQUssVUFBVSxLQUFLLENBQUMsT0FBZ0I7SUFDcEMsTUFBTSxVQUFVLEdBQUcsU0FBUyxDQUFDO0lBRTdCLE9BQU8sSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7UUFDdEMsSUFBSSxDQUFDO1lBQ0osd0JBQXdCO1lBQ3hCLE1BQU0sUUFBUSxHQUFHOzs7Y0FHTixPQUFPLENBQUMsRUFBRTtnQkFDUixPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxpQkFBaUI7bUJBQ3ZDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUTtnQkFDNUIsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJO3FCQUNoQixPQUFPLENBQUMsUUFBUSxDQUFDLFNBQVM7c0JBQ3pCLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFdBQVc7d0JBQ2hDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLGFBQWE7d0JBQ3BDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLGFBQWE7eUJBQ25DLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLGNBQWM7TUFDeEQsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUVYLHVDQUF1QztZQUN2QyxNQUFNLFdBQVcsR0FBRyxPQUFP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QUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ3pCLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2hCLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDbEMsSUFBSSxPQUFPLENBQUMsU0FBUyxHQUFHLENBQUMsRUFBRSxDQUFDO29CQUMzQixNQUFNLENBQUMsS0FBSyxDQUNYLHFDQUFxQyxLQUFLLEVBQUUsRUFDNUMsR0FBRyxVQUFVLE1BQU0sVUFBVSxFQUFFLENBQy9CLENBQUM7Z0JBQ0gsQ0FBQztxQkFBTSxDQUFDO29CQUNQLE1BQU0sQ0FBQyxLQUFLLENBQ1gsa0NBQWtDLEVBQ2xDLEdBQUcsVUFBVSxNQUFNLFVBQVUsRUFBRSxDQUMvQixDQUFDO2dCQUNILENBQUM7WUFDRixDQUFDO1lBRUQsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQ3JCLE9BQU8sQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDL0IsQ0FBQztZQUVELE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxxQ0FBcUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLENBQUM7SUFDRixDQUFDLENBQUMsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLENBQUMsTUFBTSxTQUFTLEdBQXNDO0lBQzNELEtBQUs7SUFDTCxNQUFNO0lBQ04sS0FBSztDQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaWxlOiBpby9kZXNlcmlhbGl6ZS5qc1xuXG5pbXBvcnQgeyBJT0ZuX01hc3RlckludGVyZmFjZSwgUGFsZXR0ZSB9IGZyb20gJy4uL3R5cGVzL2luZGV4LmpzJztcbmltcG9ydCB7IGNyZWF0ZUxvZ2dlciB9IGZyb20gJy4uL2xvZ2dlci9pbmRleC5qcyc7XG5pbXBvcnQgeyBtb2RlRGF0YSBhcyBtb2RlIH0gZnJvbSAnLi4vZGF0YS9tb2RlLmpzJztcblxuY29uc3QgbG9nTW9kZSA9IG1vZGUubG9nZ2luZztcblxuY29uc3QgdGhpc01vZHVsZSA9ICdpby9zZXJpYWxpemUuanMnO1xuXG5jb25zdCBsb2dnZXIgPSBhd2FpdCBjcmVhdGVMb2dnZXIoKTtcblxuYXN5bmMgZnVuY3Rpb24gdG9DU1MocGFsZXR0ZTogUGFsZXR0ZSk6IFByb21pc2U8c3RyaW5nPiB7XG5cdGNvbnN0IHRoaXNNZXRob2QgPSAndG9DU1MoKSc7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gMS4gc2VyaWFsaXplIG1ldGFkYXRhXG5cdFx0XHRjb25zdCBtZXRhZGF0YSA9IGBcblx0XHRcdFx0LyogUGFsZXR0ZSBNZXRhZGF0YSAqL1xuXHRcdFx0XHQucGFsZXR0ZSB7XG5cdFx0XHRcdFx0LS1pZDogXCIke3BhbGV0dGUuaWR9XCI7XG5cdFx0XHRcdFx0LS1uYW1lOiBcIiR7cGFsZXR0ZS5tZXRhZGF0YS5uYW1lID8/ICdVbm5hbWVkIFBhbGV0dGUnfVwiO1xuXHRcdFx0XHRcdC0tc3dhdGNoZXM6ICR7cGFsZXR0ZS5tZXRhZGF0YS5zd2F0Y2hlc307XG5cdFx0XHRcdFx0LS10eXBlOiBcIiR7cGFsZXR0ZS5tZXRhZGF0YS50eXBlfVwiO1xuXHRcdFx0XHRcdC0tdGltZXN0YW1wOiBcIiR7cGFsZXR0ZS5tZXRhZGF0YS50aW1lc3RhbXB9XCI7XG5cdFx0XHRcdFx0LS1lbmFibGVBbHBoYTogJHtwYWxldHRlLm1ldGFkYXRhLmZsYWdzLmVuYWJsZUFscGhhfTtcblx0XHRcdFx0XHQtLWxpbWl0RGFya25lc3M6ICR7cGFsZXR0ZS5tZXRhZGF0YS5mbGFncy5saW1pdERhcmtuZXNzfTtcblx0XHRcdFx0XHQtLWxpbWl0R3JheW5lc3M6ICR7cGFsZXR0ZS5tZXRhZGF0YS5mbGFncy5saW1pdEdyYXluZXNzfTtcblx0XHRcdFx0XHQtLWxpbWl0TGlnaHRuZXNzOiAke3BhbGV0dGUubWV0YWRhdGEuZmxhZ3MubGltaXRMaWdodG5lc3N9O1xuXHRcdFx0XHR9YC50cmltKCk7XG5cblx0XHRcdC8vIDIuIHNlcmlhbGl6ZSBjdXN0b20gY29sb3IgaWYgcHJlc2VudFxuXHRcdFx0Y29uc3QgY3VzdG9tQ29sb3IgPSBwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yXG5cdFx0XHRcdD8gYFxuXHRcdFx0XHQvKiBPcHRpb25hbCBDdXN0b20gQ29sb3IgKi9cblx0XHRcdFx0LnBhbGV0dGUtY3VzdG9tIHtcblx0XHRcdFx0XHQtLWN1c3RvbS1jbXlrLWNvbG9yOiBcIiR7cGFsZXR0ZS5tZXRhZGF0YS5jdXN0b21Db2xvci5jb2xvcnMubWFpbi5jbXlrfVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLWhleC1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4uaGV4fVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLWhzbC1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4uaHNsfVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLWhzdi1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4uaHN2fVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLWxhYi1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4ubGFifVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLXJnYi1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4ucmdifVwiO1xuXHRcdFx0XHRcdC0tY3VzdG9tLXh5ei1jb2xvcjogXCIke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4ueHl6fVwiO1xuXHRcdFx0XHR9YC50cmltKClcblx0XHRcdFx0OiAnJztcblxuXHRcdFx0Ly8gMy4gc2VyaWFsaXplIHBhbGV0dGUgaXRlbXNcblx0XHRcdGNvbnN0IGl0ZW1zID0gcGFsZXR0ZS5pdGVtc1xuXHRcdFx0XHQubWFwKGl0ZW0gPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGJhY2tncm91bmRDb2xvciA9IGl0ZW0uY29sb3JzLmNzcy5oc2w7XG5cblx0XHRcdFx0XHRyZXR1cm4gYFxuXHRcdFx0XHRcdC8qIFBhbGV0dGUgSXRlbSAqL1xuXHRcdFx0XHRcdC5jb2xvciB7XG5cdFx0XHRcdFx0XHQtLWNteWstY29sb3I6IFwiJHtpdGVtLmNvbG9ycy5jc3MuY215a31cIjtcblx0XHRcdFx0XHRcdC0taGV4LWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLmhleH1cIjtcblx0XHRcdFx0XHRcdC0taHNsLWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLmhzbH1cIjtcblx0XHRcdFx0XHRcdC0taHN2LWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLmhzdn1cIjtcblx0XHRcdFx0XHRcdC0tbGFiLWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLmxhYn1cIjtcblx0XHRcdFx0XHRcdC0tcmdiLWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLnJnYn1cIjtcblx0XHRcdFx0XHRcdC0teHl6LWNvbG9yOiBcIiR7aXRlbS5jb2xvcnMuY3NzLnh5en1cIjtcblx0XHRcdFx0XHRcdGJhY2tncm91bmQtY29sb3I6ICR7YmFja2dyb3VuZENvbG9yfTtcblx0XHRcdFx0XHR9YC50cmltKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5qb2luKCdcXG5cXG4nKTtcblxuXHRcdFx0Ly8gNC4gY29tYmluZSBDU1MgZGF0YVxuXHRcdFx0Y29uc3QgY3NzRGF0YSA9IFttZXRhZGF0YSwgY3VzdG9tQ29sb3IsIGl0ZW1zXVxuXHRcdFx0XHQuZmlsdGVyKEJvb2xlYW4pXG5cdFx0XHRcdC5qb2luKCdcXG5cXG4nKTtcblxuXHRcdFx0Ly8gNS4gcmVzb2x2ZSBzZXJpYWxpemVkIENTUyBkYXRhXG5cdFx0XHRyZXNvbHZlKGNzc0RhdGEudHJpbSgpKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0aWYgKCFtb2RlLnF1aWV0ICYmIGxvZ01vZGUuZXJyb3IpIHtcblx0XHRcdFx0aWYgKGxvZ01vZGUudmVyYm9zaXR5ID4gMSkge1xuXHRcdFx0XHRcdGxvZ2dlci5lcnJvcihcblx0XHRcdFx0XHRcdGBGYWlsZWQgdG8gY29udmVydCBwYWxldHRlIHRvIENTUzogJHtlcnJvcn1gLFxuXHRcdFx0XHRcdFx0YCR7dGhpc01vZHVsZX0gPiAke3RoaXNNZXRob2R9YFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bG9nZ2VyLmVycm9yKFxuXHRcdFx0XHRcdFx0J0ZhaWxlZCB0byBjb252ZXJ0IHBhbGV0dGUgdG8gQ1NTJyxcblx0XHRcdFx0XHRcdGAke3RoaXNNb2R1bGV9ID4gJHt0aGlzTWV0aG9kfWBcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChtb2RlLnN0YWNrVHJhY2UpIHtcblx0XHRcdFx0Y29uc29sZS50cmFjZSgnU3RhY2sgVHJhY2U6Jyk7XG5cdFx0XHR9XG5cblx0XHRcdHJlamVjdChuZXcgRXJyb3IoYEZhaWxlZCB0byBjb252ZXJ0IHBhbGV0dGUgdG8gQ1NTOiAke2Vycm9yfWApKTtcblx0XHR9XG5cdH0pO1xufVxuXG5hc3luYyBmdW5jdGlvbiB0b0pTT04ocGFsZXR0ZTogUGFsZXR0ZSk6IFByb21pc2U8c3RyaW5nPiB7XG5cdGNvbnN0IHRoaXNNZXRob2QgPSAndG9KU09OKCknO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGpzb25EYXRhID0gSlNPTi5zdHJpbmdpZnkocGFsZXR0ZSwgbnVsbCwgMik7XG5cblx0XHRcdHJlc29sdmUoanNvbkRhdGEpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRpZiAoIW1vZGUucXVpZXQgJiYgbG9nTW9kZS5lcnJvcikge1xuXHRcdFx0XHRpZiAobG9nTW9kZS52ZXJib3NpdHkgPiAxKSB7XG5cdFx0XHRcdFx0bG9nZ2VyLmVycm9yKFxuXHRcdFx0XHRcdFx0YEZhaWxlZCB0byBjb252ZXJ0IHBhbGV0dGUgdG8gSlNPTjogJHtlcnJvcn1gLFxuXHRcdFx0XHRcdFx0YCR7dGhpc01vZHVsZX0gPiAke3RoaXNNZXRob2R9YFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bG9nZ2VyLmVycm9yKFxuXHRcdFx0XHRcdFx0J0ZhaWxlZCB0byBjb252ZXJ0IHBhbGV0dGUgdG8gSlNPTicsXG5cdFx0XHRcdFx0XHRgJHt0aGlzTW9kdWxlfSA+ICR7dGhpc01ldGhvZH1gXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAobW9kZS5zdGFja1RyYWNlKSB7XG5cdFx0XHRcdGNvbnNvbGUudHJhY2UoJ1N0YWNrIFRyYWNlOicpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZWplY3QobmV3IEVycm9yKGBGYWlsZWQgdG8gY29udmVydCBwYWxldHRlIHRvIEpTT046ICR7ZXJyb3J9YCkpO1xuXHRcdH1cblx0fSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHRvWE1MKHBhbGV0dGU6IFBhbGV0dGUpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRjb25zdCB0aGlzTWV0aG9kID0gJ3RvWE1MKCknO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIDEuIHNlcmlhbGl6ZSBwYWxldHRlIG1ldGFkYXRhXG5cdFx0XHRjb25zdCBjdXN0b21Db2xvclhNTCA9IHBhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3Jcblx0XHRcdFx0PyBgXG5cdFx0XHRcdDxDdXN0b21Db2xvcj5cblx0XHRcdFx0XHQ8Q01ZSz4ke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4uY215a308L0NNWUs+XG5cdFx0XHRcdFx0PEhleD4ke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4uaGV4fTwvSGV4PlxuXHRcdFx0XHRcdDxIU0w+JHtwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yLmNvbG9ycy5tYWluLmhzbH08L0hTTD5cblx0XHRcdFx0XHQ8SFNWPiR7cGFsZXR0ZS5tZXRhZGF0YS5jdXN0b21Db2xvci5jb2xvcnMubWFpbi5oc3Z9PC9IU1Y+XG5cdFx0XHRcdFx0PExBQj4ke3BhbGV0dGUubWV0YWRhdGEuY3VzdG9tQ29sb3IuY29sb3JzLm1haW4ubGFifTwvTEFCPlxuXHRcdFx0XHRcdDxSR0I+JHtwYWxldHRlLm1ldGFkYXRhLmN1c3RvbUNvbG9yLmNvbG9ycy5tYWluLnJnYn08L1JHQj5cblx0XHRcdFx0XHQ8WFlaPiR7cGFsZXR0ZS5tZXRhZGF0YS5jdXN0b21Db2xvci5jb2xvcnMubWFpbi54eXp9PC9YWVo+XG5cdFx0XHRcdDwvQ3VzdG9tQ29sb3I+YC50cmltKClcblx0XHRcdFx0OiAnPEN1c3RvbUNvbG9yPmZhbHNlPC9DdXN0b21Db2xvcj4nO1xuXG5cdFx0XHRjb25zdCBtZXRhZGF0YSA9IGBcblx0XHRcdFx0PE1ldGFkYXRhPlxuXHRcdFx0XHRcdDxOYW1lPiR7cGFsZXR0ZS5tZXRhZGF0YS5uYW1lID8/ICdVbm5hbWVkIFBhbGV0dGUnfTwvTmFtZT5cblx0XHRcdFx0XHQ8VGltZXN0YW1wPiR7cGFsZXR0ZS5tZXRhZGF0YS50aW1lc3RhbXB9PC9UaW1lc3RhbXA+XG5cdFx0XHRcdFx0PFN3YXRjaGVzPiR7cGFsZXR0ZS5tZXRhZGF0YS5zd2F0Y2hlc308L1N3YXRjaGVzPlxuXHRcdFx0XHRcdDxUeXBlPiR7cGFsZXR0ZS5tZXRhZGF0YS50eXBlfTwvVHlwZT5cblx0XHRcdFx0XHQke2N1c3RvbUNvbG9yWE1MfVxuXHRcdFx0XHRcdDxGbGFncz5cblx0XHRcdFx0XHRcdDxFbmFibGVBbHBoYT4ke3BhbGV0dGUubWV0YWRhdGEuZmxhZ3MuZW5hYmxlQWxwaGF9PC9FbmFibGVBbHBoYT5cblx0XHRcdFx0XHRcdDxMaW1pdERhcmtuZXNzPiR7cGFsZXR0ZS5tZXRhZGF0YS5mbGFncy5saW1pdERhcmtuZXNzfTwvTGltaXREYXJrbmVzcz5cblx0XHRcdFx0XHRcdDxMaW1pdEdyYXluZXNzPiR7cGFsZXR0ZS5tZXRhZGF0YS5mbGFncy5saW1pdEdyYXluZXNzfTwvTGltaXRHcmF5bmVzcz5cblx0XHRcdFx0XHRcdDxMaW1pdExpZ2h0bmVzcz4ke3BhbGV0dGUubWV0YWRhdGEuZmxhZ3MubGltaXRMaWdodG5lc3N9PC9MaW1pdExpZ2h0bmVzcz5cblx0XHRcdFx0XHQ8L0ZsYWdzPlxuXHRcdFx0XHQ8L01ldGFkYXRhPmAudHJpbSgpO1xuXG5cdFx0XHQvLyAyLiBzZXJpYWxpemUgcGFsZXR0ZSBpdGVtc1xuXHRcdFx0Y29uc3QgeG1sSXRlbXMgPSBwYWxldHRlLml0ZW1zXG5cdFx0XHRcdC5tYXAoKGl0ZW0sIGluZGV4KSA9PlxuXHRcdFx0XHRcdGBcblx0XHRcdFx0XHQ8UGFsZXR0ZUl0ZW0gaWQ9XCIke2luZGV4ICsgMX1cIj5cblx0XHRcdFx0XHRcdDxDb2xvcnM+XG5cdFx0XHRcdFx0XHRcdDxNYWluPlxuXHRcdFx0XHRcdFx0XHRcdDxDTVlLPiR7aXRlbS5jb2xvcnMubWFpbi5jbXlrfTwvQ01ZSz5cblx0XHRcdFx0XHRcdFx0XHQ8SGV4PiR7aXRlbS5jb2xvcnMubWFpbi5oZXh9PC9IZXg+XG5cdFx0XHRcdFx0XHRcdFx0PEhTTD4ke2l0ZW0uY29sb3JzLm1haW4uaHNsfTwvSFNMPlxuXHRcdFx0XHRcdFx0XHRcdDxIU1Y+JHtpdGVtLmNvbG9ycy5tYWluLmhzdn08L0hTVj5cblx0XHRcdFx0XHRcdFx0XHQ8TEFCPiR7aXRlbS5jb2xvcnMubWFpbi5sYWJ9PC9MQUI+XG5cdFx0XHRcdFx0XHRcdFx0PFJHQj4ke2l0ZW0uY29sb3JzLm1haW4ucmdifTwvUkdCPlxuXHRcdFx0XHRcdFx0XHRcdDxYWVo+JHtpdGVtLmNvbG9ycy5tYWluLnh5en08L1hZWj5cblx0XHRcdFx0XHRcdFx0PC9NYWluPlxuXHRcdFx0XHRcdFx0XHQ8Q1NTPlxuXHRcdFx0XHRcdFx0XHRcdDxDTVlLPiR7aXRlbS5jb2xvcnMuY3NzLmNteWt9PC9DTVlLPlxuXHRcdFx0XHRcdFx0XHRcdDxIZXg+JHtpdGVtLmNvbG9ycy5jc3MuaGV4fTwvSGV4PlxuXHRcdFx0XHRcdFx0XHRcdDxIU0w+JHtpdGVtLmNvbG9ycy5jc3MuaHNsfTwvSFNMPlxuXHRcdFx0XHRcdFx0XHRcdDxIU1Y+JHtpdGVtLmNvbG9ycy5jc3MuaHN2fTwvSFNWPlxuXHRcdFx0XHRcdFx0XHRcdDxMQUI+JHtpdGVtLmNvbG9ycy5jc3MubGFifTwvTEFCPlxuXHRcdFx0XHRcdFx0XHRcdDxSR0I+JHtpdGVtLmNvbG9ycy5jc3MucmdifTwvUkdCPlxuXHRcdFx0XHRcdFx0XHRcdDxYWVo+JHtpdGVtLmNvbG9ycy5jc3MueHl6fTwvWFlaPlxuXHRcdFx0XHRcdFx0XHQ8L0NTUz5cblx0XHRcdFx0XHRcdDwvQ29sb3JzPlxuXHRcdFx0XHRcdDwvUGFsZXR0ZUl0ZW0+YC50cmltKClcblx0XHRcdFx0KVxuXHRcdFx0XHQuam9pbignXFxuJyk7XG5cblx0XHRcdC8vIDMuIGNvbWJpbmUgbWV0YWRhdGEgYW5kIGl0ZW1zIGludG8gdGhlIHBhbGV0dGUgWE1MXG5cdFx0XHRjb25zdCB4bWxEYXRhID0gYFxuXHRcdFx0XHQ8UGFsZXR0ZSBpZD0ke3BhbGV0dGUuaWR9PlxuXHRcdFx0XHRcdCR7bWV0YWRhdGF9XG5cdFx0XHRcdFx0PEl0ZW1zPlxuXHRcdFx0XHRcdFx0JHt4bWxJdGVtc31cblx0XHRcdFx0XHQ8L0l0ZW1zPlxuXHRcdFx0XHQ8L1BhbGV0dGU+YC50cmltKCk7XG5cblx0XHRcdHJlc29sdmUoeG1sRGF0YS50cmltKCkpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRpZiAoIW1vZGUucXVpZXQgJiYgbG9nTW9kZS5lcnJvcikge1xuXHRcdFx0XHRpZiAobG9nTW9kZS52ZXJib3NpdHkgPiAxKSB7XG5cdFx0XHRcdFx0bG9nZ2VyLmVycm9yKFxuXHRcdFx0XHRcdFx0YEZhaWxlZCB0byBjb252ZXJ0IHBhbGV0dGUgdG8gWE1MOiAke2Vycm9yfWAsXG5cdFx0XHRcdFx0XHRgJHt0aGlzTW9kdWxlfSA+ICR7dGhpc01ldGhvZH1gXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRsb2dnZXIuZXJyb3IoXG5cdFx0XHRcdFx0XHQnRmFpbGVkIHRvIGNvbnZlcnQgcGFsZXR0ZSB0byBYTUwnLFxuXHRcdFx0XHRcdFx0YCR7dGhpc01vZHVsZX0gPiAke3RoaXNNZXRob2R9YFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKG1vZGUuc3RhY2tUcmFjZSkge1xuXHRcdFx0XHRjb25zb2xlLnRyYWNlKCdTdGFjayBUcmFjZTonKTtcblx0XHRcdH1cblxuXHRcdFx0cmVqZWN0KG5ldyBFcnJvcihgRmFpbGVkIHRvIGNvbnZlcnQgcGFsZXR0ZSB0byBYTUw6ICR7ZXJyb3J9YCkpO1xuXHRcdH1cblx0fSk7XG59XG5cbmV4cG9ydCBjb25zdCBzZXJpYWxpemU6IElPRm5fTWFzdGVySW50ZXJmYWNlWydzZXJpYWxpemUnXSA9IHtcblx0dG9DU1MsXG5cdHRvSlNPTixcblx0dG9YTUxcbn07XG4iXX0=