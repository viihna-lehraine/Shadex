{"version":3,"file":"LocalStorageManager.js","sources":["../../../../src/storage/LocalStorageManager.ts"],"sourcesContent":["// File: storage/LocalStorageManager.ts\n\nimport { LocalStorageManagerInterface, Services } from '../types/index.js';\n\nconst caller = 'LocalStorageManager';\n\nexport class LocalStorageManager implements LocalStorageManagerInterface {\n\tstatic #instance: LocalStorageManager | null = null;\n\n\t#errors: Services['errors'];\n\t#log: Services['log'];\n\n\tprivate constructor(services: Services) {\n\t\ttry {\n\t\t\tservices.log('Constructing LocalStorageManager instance', {\n\t\t\t\tcaller: `${caller}.constructor`\n\t\t\t});\n\n\t\t\tthis.#errors = services.errors;\n\t\t\tthis.#log = services.log;\n\t\t} catch (error) {\n\t\t\tthrow new Error(\n\t\t\t\t`[${caller} constructor]: ${error instanceof Error ? error.message : error}`\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getInstance(services: Services): LocalStorageManager {\n\t\treturn services.errors.handleSync(() => {\n\t\t\tif (!LocalStorageManager.#instance) {\n\t\t\t\tservices.log(\n\t\t\t\t\t'No LocalStorageManager instance exists yet. Creating new instance.',\n\t\t\t\t\t{\n\t\t\t\t\t\tcaller: `${caller}.getInstance`,\n\t\t\t\t\t\tlevel: 'debug'\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tLocalStorageManager.#instance = new LocalStorageManager(\n\t\t\t\t\tservices\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tservices.log('Returning existing LocalStorageManager instance.', {\n\t\t\t\tcaller: `${caller}.getInstance`,\n\t\t\t\tlevel: 'debug'\n\t\t\t});\n\n\t\t\treturn LocalStorageManager.#instance;\n\t\t}, `[${caller}]: Failed to create LocalStorageManager instance.`);\n\t}\n\n\tasync init(): Promise<boolean> {\n\t\treturn this.#errors.handleAsync(async () => {\n\t\t\tthis.#log('Using LocalStorage as storage fallback.', {\n\t\t\t\tcaller: `${caller}.init`,\n\t\t\t\tlevel: 'warn'\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}, `[${caller}.init]: Failed to initialize LocalStorage`);\n\t}\n\n\tasync clear(): Promise<void> {\n\t\treturn await this.#errors.handleAsync(\n\t\t\tasync () => localStorage.clear(),\n\t\t\t`[${caller}]: Failed to clear LocalStorage.`\n\t\t);\n\t}\n\n\tasync getItem<T>(key: string): Promise<T | null> {\n\t\treturn this.#errors.handleAsync(async () => {\n\t\t\tconst value = localStorage.getItem(key);\n\n\t\t\treturn value ? JSON.parse(value) : null;\n\t\t}, `[${caller}]: Failed to get item ${key} from LocalStorage.`);\n\t}\n\n\tasync removeItem(key: string): Promise<void> {\n\t\treturn await this.#errors.handleAsync(\n\t\t\tasync () => localStorage.removeItem(key),\n\t\t\t`[${caller}]: Failed to remove item ${key} from LocalStorage.`\n\t\t);\n\t}\n\n\tasync setItem(key: string, value: unknown): Promise<void> {\n\t\treturn await this.#errors.handleAsync(async () => {\n\t\t\tlocalStorage.setItem(key, JSON.stringify(value));\n\n\t\t\tthis.#log(`Stored item: ${key}`, {\n\t\t\t\tcaller: `${caller}.setItem`,\n\t\t\t\tlevel: 'debug'\n\t\t\t});\n\t\t}, `Failed to store item ${key} in LocalStorage`);\n\t}\n}\n"],"names":[],"mappings":"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"}