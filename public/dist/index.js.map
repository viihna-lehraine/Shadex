{"version":3,"file":"index.js","sources":["../../../src/index.ts"],"sourcesContent":["// ColorGen - version 0.6.3-dev\n\n// Author: Viihna Leraine (viihna@ViihnaTech.com / viihna.78 (Signal) / Viihna-Lehraine (Github))\n// License: GNU GPLv3 (https://www.gnu.org/licenses/gpl-3.0.html)\n\n// You may use this code for any purpose EXCEPT for the creation of proprietary derivatives. I encourage you to improve on my code or to include it in other projects if you find it helpful. Please credit me as the original author.\n\n// This application comes with ABSOLUTELY NO WARRANTY OR GUARANTEE.\n\n// File: index.ts\n\nimport { EventManager } from './dom/events/EventManager.js';\nimport { config } from './config/index.js';\n\nconst mode = config.mode;\n\nasync function initializeApp() {\n\tconst { bootstrap } = await import('./app/bootstrap.js');\n\tconst { helpers, services } = await bootstrap();\n\tconst { errors, log } = services;\n\n\tlog.info('Registering global error handlers...', 'STARTUP');\n\twindow.onerror = function (message, source, lineno, colno, error) {\n\t\tlog.info(\n\t\t\t`Unhandled error: ${message} at ${source}:${lineno}:${colno}`,\n\t\t\t'GLOBAL ERROR HANDLER'\n\t\t);\n\n\t\tif (error && error.stack) {\n\t\t\tlog.info(`Stack trace:\\n${error.stack}`, 'GLOBAL ERROR HANDLER');\n\t\t}\n\n\t\treturn false;\n\t};\n\twindow.addEventListener('unhandledrejection', function (event) {\n\t\tlog.info(\n\t\t\t`Unhandled promise rejection: ${event.reason}`,\n\t\t\t'GLOBAL ERROR HANDLER'\n\t\t);\n\t});\n\n\tconst { registerDependencies } = await import('./app/registry.js');\n\tlog.info('Registering dependencies.', 'STARTUP');\n\n\tconst deps = await registerDependencies(helpers, services);\n\tlog.info('Dependencies registered.', 'STARTUP');\n\n\tif (mode.exposeClasses) {\n\t\twindow.domStore = deps.domStore;\n\t\twindow.eventManager = deps.eventManager;\n\t\twindow.stateManager = deps.stateManager;\n\t}\n\n\tawait errors.handleAsync(async () => {\n\t\tif (mode.debugLevel >= 3) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tEventManager.listAll();\n\t\t\t}, 100);\n\t\t}\n\t}, `[initializeApp]: Application startup failed.`);\n}\n\nif (document.readyState === 'loading') {\n\tconsole.log(\n\t\t'[anon@index.ts]: DOM content not yet loaded. Adding DOMContentLoaded event listener and awaiting...'\n\t);\n\n\tdocument.addEventListener('DOMContentLoaded', initializeApp);\n} else {\n\tconsole.log(\n\t\t'[anon@index.ts]: DOM content already loaded. Initializing application immediately.'\n\t);\n\n\tinitializeApp();\n}\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;AAEA;AAEA;AAEA;AAOA,eAAe,aAAa,GAAA;IAC3B,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,OAAO,oBAAoB,CAAC;IACxD,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,MAAM,SAAS,EAAE;AAC/C,IAAA,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,QAAQ;AAEhC,IAAA,GAAG,CAAC,IAAI,CAAC,sCAAsC,EAAE,SAAS,CAAC;AAC3D,IAAA,MAAM,CAAC,OAAO,GAAG,UAAU,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAA;AAC/D,QAAA,GAAG,CAAC,IAAI,CACP,CAAA,iBAAA,EAAoB,OAAO,CAAO,IAAA,EAAA,MAAM,CAAI,CAAA,EAAA,MAAM,IAAI,KAAK,CAAA,CAAE,EAC7D,sBAAsB,CACtB;AAED,QAAA,IAAI,KAAK,IAAI,KAAK,CAAC,KAAK,EAAE;YACzB,GAAG,CAAC,IAAI,CAAC,CAAiB,cAAA,EAAA,KAAK,CAAC,KAAK,CAAE,CAAA,EAAE,sBAAsB,CAAC;;AAGjE,QAAA,OAAO,KAAK;AACb,KAAC;AACD,IAAA,MAAM,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,UAAU,KAAK,EAAA;QAC5D,GAAG,CAAC,IAAI,CACP,CAAgC,6BAAA,EAAA,KAAK,CAAC,MAAM,CAAE,CAAA,EAC9C,sBAAsB,CACtB;AACF,KAAC,CAAC;IAEF,MAAM,EAAE,oBAAoB,EAAE,GAAG,MAAM,OAAO,mBAAmB,CAAC;AAClE,IAAA,GAAG,CAAC,IAAI,CAAC,2BAA2B,EAAE,SAAS,CAAC;IAEhD,MAAM,IAAI,GAAG,MAAM,oBAAoB,CAAC,OAAO,EAAE,QAAQ,CAAC;AAC1D,IAAA,GAAG,CAAC,IAAI,CAAC,0BAA0B,EAAE,SAAS,CAAC;AAE/C,IAAwB;AACvB,QAAA,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ;AAC/B,QAAA,MAAM,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY;AACvC,QAAA,MAAM,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY;;AAGxC,IAAA,MAAM,MAAM,CAAC,WAAW,CAAC,YAAW;AACnC,QAA0B;YACzB,UAAU,CAAC,MAAK;gBACf,YAAY,CAAC,OAAO,EAAE;aACtB,EAAE,GAAG,CAAC;;KAER,EAAE,CAA8C,4CAAA,CAAA,CAAC;AACnD;AAEA,IAAI,QAAQ,CAAC,UAAU,KAAK,SAAS,EAAE;AACtC,IAAA,OAAO,CAAC,GAAG,CACV,qGAAqG,CACrG;AAED,IAAA,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,aAAa,CAAC;AAC7D;KAAO;AACN,IAAA,OAAO,CAAC,GAAG,CACV,oFAAoF,CACpF;AAED,IAAA,aAAa,EAAE;AAChB"}