{"version":3,"file":"index.js","sources":["../../../src/index.ts"],"sourcesContent":["// ColorGen - version 0.6.3-dev\n\n// Author: Viihna Leraine (viihna@ViihnaTech.com / viihna.78 (Signal) / Viihna-Lehraine (Github))\n// Licensed under GNU GPLv3 (https://www.gnu.org/licenses/gpl-3.0.html)\n\n// You may use this code for any purpose EXCEPT for the creation of proprietary derivatives. I encourage you to improve on my code or to include it in other projects if you find it helpful. Please credit me as the original author.\n\n// This application comes with ABSOLUTELY NO WARRANTY OR GUARANTEE.\n\n// File: index.ts\n\nimport { EventManager } from './events/EventManager.js';\nimport { config } from './config/index.js';\n\nconst mode = config.mode;\n\nasync function initializeApp() {\n\t// 1. Bootstrap minimal dependencies\n\tconsole.log('[STARTUP]: Importing bootstrap module...');\n\tconst { bootstrap } = await import('./app/bootstrap.js');\n\n\tconsole.log('[STARTUP]: Executing bootstrap process.');\n\tconst { helpers, services } = await bootstrap();\n\n\tconst { errors, log } = services;\n\tlog('Boostrap process complete.', { caller: '[STARTUP]' });\n\n\tlog('Registering global error handlers...', { caller: '[STARTUP]' });\n\twindow.onerror = function (message, source, lineno, colno, error) {\n\t\tlog(`Unhandled error: ${message} at ${source}:${lineno}:${colno}`, {\n\t\t\tcaller: '[GLOBAL ERROR HANDLER]'\n\t\t});\n\t\tif (error && error.stack) {\n\t\t\tlog(`Stack trace:\\n${error.stack}`, {\n\t\t\t\tcaller: '[GLOBAL ERROR HANDLER]'\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t};\n\twindow.addEventListener('unhandledrejection', function (event) {\n\t\tlog(`Unhandled promise rejection: ${event.reason}`, {\n\t\t\tcaller: '[GLOBAL ERROR HANDLER]'\n\t\t});\n\t});\n\n\tconst { registerDependencies } = await import('./app/registry.js');\n\tlog('Registering dependencies.', { caller: '[STARTUP]' });\n\tconst deps = await registerDependencies(helpers, services);\n\tlog('Dependencies registered.', { caller: '[STARTUP]' });\n\n\tconsole.log(`mode.exposeClasses ${mode.exposeClasses}`);\n\tif (mode.exposeClasses) {\n\t\tlog(`Exposing classes to console.`, { caller: '[STARTUP_OPTION]' });\n\t\tconst { exposeClasses } = await import('./app/init.js');\n\t\tawait exposeClasses(\n\t\t\tdeps.eventManager,\n\t\t\tdeps.events.palette,\n\t\t\tdeps.paletteManager,\n\t\t\tdeps.common.services,\n\t\t\tdeps.stateManager,\n\t\t\tdeps.events.ui\n\t\t);\n\t}\n\n\tawait errors.handleAsync(async () => {\n\t\tif (mode.debugLevel >= 3) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tEventManager.listAll();\n\t\t\t}, 100);\n\t\t}\n\t}, 'Application startup failed');\n}\n\nif (document.readyState === 'loading') {\n\tconsole.log(\n\t\t'[INIT]: DOM content not yet loaded. Adding DOMContentLoaded event listener and awaiting...'\n\t);\n\tdocument.addEventListener('DOMContentLoaded', initializeApp);\n} else {\n\tconsole.log(\n\t\t'[INIT]: DOM content already loaded. Initializing application immediately.'\n\t);\n\tinitializeApp();\n}\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AACA;AAEA;AAEA;AAEA;AAKA,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI;AAExB,eAAe,aAAa,GAAA;;AAE3B,IAAA,OAAO,CAAC,GAAG,CAAC,0CAA0C,CAAC;IACvD,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,OAAO,oBAAoB,CAAC;AAExD,IAAA,OAAO,CAAC,GAAG,CAAC,yCAAyC,CAAC;IACtD,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,MAAM,SAAS,EAAE;AAE/C,IAAA,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,QAAQ;IAChC,GAAG,CAAC,4BAA4B,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;IAE1D,GAAG,CAAC,sCAAsC,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;AACpE,IAAA,MAAM,CAAC,OAAO,GAAG,UAAU,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAA;QAC/D,GAAG,CAAC,CAAoB,iBAAA,EAAA,OAAO,CAAO,IAAA,EAAA,MAAM,IAAI,MAAM,CAAA,CAAA,EAAI,KAAK,CAAA,CAAE,EAAE;AAClE,YAAA,MAAM,EAAE;AACR,SAAA,CAAC;AACF,QAAA,IAAI,KAAK,IAAI,KAAK,CAAC,KAAK,EAAE;AACzB,YAAA,GAAG,CAAC,CAAiB,cAAA,EAAA,KAAK,CAAC,KAAK,EAAE,EAAE;AACnC,gBAAA,MAAM,EAAE;AACR,aAAA,CAAC;;AAEH,QAAA,OAAO,KAAK;AACb,KAAC;AACD,IAAA,MAAM,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,UAAU,KAAK,EAAA;AAC5D,QAAA,GAAG,CAAC,CAAgC,6BAAA,EAAA,KAAK,CAAC,MAAM,EAAE,EAAE;AACnD,YAAA,MAAM,EAAE;AACR,SAAA,CAAC;AACH,KAAC,CAAC;IAEF,MAAM,EAAE,oBAAoB,EAAE,GAAG,MAAM,OAAO,mBAAmB,CAAC;IAClE,GAAG,CAAC,2BAA2B,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;IACzD,MAAM,IAAI,GAAG,MAAM,oBAAoB,CAAC,OAAO,EAAE,QAAQ,CAAC;IAC1D,GAAG,CAAC,0BAA0B,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;IAExD,OAAO,CAAC,GAAG,CAAC,CAAA,mBAAA,EAAsB,IAAI,CAAC,aAAa,CAAE,CAAA,CAAC;AACvD,IAAwB;QACvB,GAAG,CAAC,8BAA8B,EAAE,EAAE,MAAM,EAAE,kBAAkB,EAAE,CAAC;QACnE,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,OAAO,eAAe,CAAC;AACvD,QAAA,MAAM,aAAa,CAClB,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,MAAM,CAAC,OAAO,EACnB,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,MAAM,CAAC,QAAQ,EACpB,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,MAAM,CAAC,EAAE,CACd;;AAGF,IAAA,MAAM,MAAM,CAAC,WAAW,CAAC,YAAW;AACnC,QAA0B;YACzB,UAAU,CAAC,MAAK;gBACf,YAAY,CAAC,OAAO,EAAE;aACtB,EAAE,GAAG,CAAC;;KAER,EAAE,4BAA4B,CAAC;AACjC;AAEA,IAAI,QAAQ,CAAC,UAAU,KAAK,SAAS,EAAE;AACtC,IAAA,OAAO,CAAC,GAAG,CACV,4FAA4F,CAC5F;AACD,IAAA,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,aAAa,CAAC;AAC7D;KAAO;AACN,IAAA,OAAO,CAAC,GAAG,CACV,2EAA2E,CAC3E;AACD,IAAA,aAAa,EAAE;AAChB"}