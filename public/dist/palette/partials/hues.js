import { paletteConfig } from '../../config/index.js';
// TODO: These definiely need refinement
function generateAnalogousHues(color, options, common) {
    const { errors, log } = common.services;
    return errors.handleSync(() => {
        if (!common.utils.validate.colorValue(color)) {
            log.error(`Invalid color value ${JSON.stringify(color)}`, `generateAnalogousHues`);
            return [];
        }
        const analogousHues = [];
        const baseHue = color.value.hue;
        const maxTotalDistance = 60;
        const minTotalDistance = Math.max(20, 10 + (options.columnCount - 2) * 12);
        const totalIncrement = Math.floor(Math.random() * (maxTotalDistance - minTotalDistance + 1)) + minTotalDistance;
        const increment = Math.floor(totalIncrement / (options.columnCount - 1));
        for (let i = 1; i < options.columnCount; i++) {
            analogousHues.push((baseHue + increment * i) % 360);
        }
        return analogousHues;
    }, 'Error generating analogous hues', {
        context: { options }
    });
}
function generateDiadicHues(color, options, common) {
    const { helpers, services: { errors } } = common;
    return errors.handleSync(() => {
        const baseHue = color.value.hue;
        const diadicHues = [];
        const { weights, values } = paletteConfig.probabilities[options.distributionType];
        const randomDistance = helpers.random.selectRandomFromWeights({
            weights,
            values
        });
        const hue1 = baseHue;
        const hue2 = (hue1 + randomDistance) % 360;
        diadicHues.push(hue1, hue2);
        return diadicHues;
    }, 'Error generating diadic hues', {
        context: { options }
    });
}
function generateHexadicHues(color, common) {
    const { utils, services: { errors } } = common;
    return errors.handleSync(() => {
        const clonedBaseHSL = utils.color.convertToHSL(color);
        const hexadicHues = [];
        const baseHue = clonedBaseHSL.value.hue;
        const hue1 = baseHue;
        const hue2 = (hue1 + 180) % 360;
        const randomDistance = Math.floor(Math.random() * 61 + 30);
        const hue3 = (hue1 + randomDistance) % 360;
        const hue4 = (hue3 + 180) % 360;
        const hue5 = (hue1 + 360 - randomDistance) % 360;
        const hue6 = (hue5 + 180) % 360;
        hexadicHues.push(hue1, hue2, hue3, hue4, hue5, hue6);
        return hexadicHues;
    }, 'Error generating hexadic hues', {
        context: { color }
    });
}
function generateSplitComplementaryHues(color, common) {
    const { errors } = common.services;
    return errors.handleSync(() => {
        const baseHue = color.value.hue;
        const modifier = Math.floor(Math.random() * 11) + 20;
        return [
            (baseHue + 180 + modifier) % 360,
            (baseHue + 180 - modifier + 360) % 360
        ];
    }, 'Error generating split-complementary hues', {
        context: { color }
    });
}
function generateTetradicHues(color, common) {
    const { errors } = common.services;
    return errors.handleSync(() => {
        const baseHue = color.value.hue;
        const randomOffset = Math.floor(Math.random() * 46) + 20;
        const distance = 90 + (Math.random() < 0.5 ? -randomOffset : randomOffset);
        return [
            baseHue,
            (baseHue + 180) % 360,
            (baseHue + distance) % 360,
            (baseHue + distance + 180) % 360
        ];
    }, 'Error generating tetradic hues', {
        context: { color }
    });
}
function generateTriadic(color, common) {
    const { errors } = common.services;
    return errors.handleSync(() => {
        const baseHue = color.value.hue;
        return [120, 240].map(increment => (baseHue + increment) % 360);
    }, 'Error generating triadic hues', {
        context: { color }
    });
}
export const generateHuesFnGroup = {
    analogous: generateAnalogousHues,
    diadic: generateDiadicHues,
    hexadic: generateHexadicHues,
    splitComplementary: generateSplitComplementaryHues,
    tetradic: generateTetradicHues,
    triadic: generateTriadic
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHVlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9wYWxldHRlL3BhcnRpYWxzL2h1ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBTUEsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRXRELHdDQUF3QztBQUV4QyxTQUFTLHFCQUFxQixDQUM3QixLQUFVLEVBQ1YsT0FBK0IsRUFDL0IsTUFBdUI7SUFFdkIsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDO0lBRXhDLE9BQU8sTUFBTSxDQUFDLFVBQVUsQ0FDdkIsR0FBRyxFQUFFO1FBQ0osSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzlDLEdBQUcsQ0FBQyxLQUFLLENBQ1IsdUJBQXVCLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFDOUMsdUJBQXVCLENBQ3ZCLENBQUM7WUFFRixPQUFPLEVBQUUsQ0FBQztRQUNYLENBQUM7UUFFRCxNQUFNLGFBQWEsR0FBYSxFQUFFLENBQUM7UUFDbkMsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7UUFDaEMsTUFBTSxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDNUIsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUNoQyxFQUFFLEVBQ0YsRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQ25DLENBQUM7UUFDRixNQUFNLGNBQWMsR0FDbkIsSUFBSSxDQUFDLEtBQUssQ0FDVCxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsR0FBRyxDQUFDLENBQUMsQ0FDekQsR0FBRyxnQkFBZ0IsQ0FBQztRQUN0QixN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QixFQUFFLDhCQUE4QjtJQUNsRCxRQUFRLEVBQUUsb0JBQW9CO0lBQzlCLE9BQU8sRUFBRSxlQUFlO0NBQ2YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG5cdENvbW1vbkZ1bmN0aW9ucyxcblx0R2VuZXJhdGVIdWVzRm5Hcm91cCxcblx0SFNMLFxuXHRTZWxlY3RlZFBhbGV0dGVPcHRpb25zXG59IGZyb20gJy4uLy4uL3R5cGVzL2luZGV4LmpzJztcbmltcG9ydCB7IHBhbGV0dGVDb25maWcgfSBmcm9tICcuLi8uLi9jb25maWcvaW5kZXguanMnO1xuXG4vLyBUT0RPOiBUaGVzZSBkZWZpbmllbHkgbmVlZCByZWZpbmVtZW50XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQW5hbG9nb3VzSHVlcyhcblx0Y29sb3I6IEhTTCxcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IG51bWJlcltdIHtcblx0Y29uc3QgeyBlcnJvcnMsIGxvZyB9ID0gY29tbW9uLnNlcnZpY2VzO1xuXG5cdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYyhcblx0XHQoKSA9PiB7XG5cdFx0XHRpZiAoIWNvbW1vbi51dGlscy52YWxpZGF0ZS5jb2xvclZhbHVlKGNvbG9yKSkge1xuXHRcdFx0XHRsb2cuZXJyb3IoXG5cdFx0XHRcdFx0YEludmFsaWQgY29sb3IgdmFsdWUgJHtKU09OLnN0cmluZ2lmeShjb2xvcil9YCxcblx0XHRcdFx0XHRgZ2VuZXJhdGVBbmFsb2dvdXNIdWVzYFxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdHJldHVybiBbXTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgYW5hbG9nb3VzSHVlczogbnVtYmVyW10gPSBbXTtcblx0XHRcdGNvbnN0IGJhc2VIdWUgPSBjb2xvci52YWx1ZS5odWU7XG5cdFx0XHRjb25zdCBtYXhUb3RhbERpc3RhbmNlID0gNjA7XG5cdFx0XHRjb25zdCBtaW5Ub3RhbERpc3RhbmNlID0gTWF0aC5tYXgoXG5cdFx0XHRcdDIwLFxuXHRcdFx0XHQxMCArIChvcHRpb25zLmNvbHVtbkNvdW50IC0gMikgKiAxMlxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IHRvdGFsSW5jcmVtZW50ID1cblx0XHRcdFx0TWF0aC5mbG9vcihcblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICogKG1heFRvdGFsRGlzdGFuY2UgLSBtaW5Ub3RhbERpc3RhbmNlICsgMSlcblx0XHRcdFx0KSArIG1pblRvdGFsRGlzdGFuY2U7XG5cdFx0XHRjb25zdCBpbmNyZW1lbnQgPSBNYXRoLmZsb29yKFxuXHRcdFx0XHR0b3RhbEluY3JlbWVudCAvIChvcHRpb25zLmNvbHVtbkNvdW50IC0gMSlcblx0XHRcdCk7XG5cblx0XHRcdGZvciAobGV0IGkgPSAxOyBpIDwgb3B0aW9ucy5jb2x1bW5Db3VudDsgaSsrKSB7XG5cdFx0XHRcdGFuYWxvZ291c0h1ZXMucHVzaCgoYmFzZUh1ZSArIGluY3JlbWVudCAqIGkpICUgMzYwKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGFuYWxvZ291c0h1ZXM7XG5cdFx0fSxcblx0XHQnRXJyb3IgZ2VuZXJhdGluZyBhbmFsb2dvdXMgaHVlcycsXG5cdFx0e1xuXHRcdFx0Y29udGV4dDogeyBvcHRpb25zIH1cblx0XHR9XG5cdCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRGlhZGljSHVlcyhcblx0Y29sb3I6IEhTTCxcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IG51bWJlcltdIHtcblx0Y29uc3Qge1xuXHRcdGhlbHBlcnMsXG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH1cblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Y29uc3QgYmFzZUh1ZSA9IGNvbG9yLnZhbHVlLmh1ZTtcblx0XHRcdGNvbnN0IGRpYWRpY0h1ZXMgPSBbXTtcblxuXHRcdFx0Y29uc3QgeyB3ZWlnaHRzLCB2YWx1ZXMgfSA9XG5cdFx0XHRcdHBhbGV0dGVDb25maWcucHJvYmFiaWxpdGllc1tvcHRpb25zLmRpc3RyaWJ1dGlvblR5cGVdO1xuXHRcdFx0Y29uc3QgcmFuZG9tRGlzdGFuY2UgPSBoZWxwZXJzLnJhbmRvbS5zZWxlY3RSYW5kb21Gcm9tV2VpZ2h0cyh7XG5cdFx0XHRcdHdlaWdodHMsXG5cdFx0XHRcdHZhbHVlc1xuXHRcdFx0fSk7XG5cdFx0XHRjb25zdCBodWUxID0gYmFzZUh1ZTtcblx0XHRcdGNvbnN0IGh1ZTIgPSAoaHVlMSArIHJhbmRvbURpc3RhbmNlKSAlIDM2MDtcblxuXHRcdFx0ZGlhZGljSHVlcy5wdXNoKGh1ZTEsIGh1ZTIpO1xuXG5cdFx0XHRyZXR1cm4gZGlhZGljSHVlcztcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIGRpYWRpYyBodWVzJyxcblx0XHR7XG5cdFx0XHRjb250ZXh0OiB7IG9wdGlvbnMgfVxuXHRcdH1cblx0KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVIZXhhZGljSHVlcyhjb2xvcjogSFNMLCBjb21tb246IENvbW1vbkZ1bmN0aW9ucyk6IG51bWJlcltdIHtcblx0Y29uc3Qge1xuXHRcdHV0aWxzLFxuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9XG5cdH0gPSBjb21tb247XG5cblx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKFxuXHRcdCgpID0+IHtcblx0XHRcdGNvbnN0IGNsb25lZEJhc2VIU0wgPSB1dGlscy5jb2xvci5jb252ZXJ0VG9IU0woY29sb3IpO1xuXG5cdFx0XHRjb25zdCBoZXhhZGljSHVlczogbnVtYmVyW10gPSBbXTtcblx0XHRcdGNvbnN0IGJhc2VIdWUgPSBjbG9uZWRCYXNlSFNMLnZhbHVlLmh1ZTtcblx0XHRcdGNvbnN0IGh1ZTEgPSBiYXNlSHVlO1xuXHRcdFx0Y29uc3QgaHVlMiA9IChodWUxICsgMTgwKSAlIDM2MDtcblx0XHRcdGNvbnN0IHJhbmRvbURpc3RhbmNlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNjEgKyAzMCk7XG5cdFx0XHRjb25zdCBodWUzID0gKGh1ZTEgKyByYW5kb21EaXN0YW5jZSkgJSAzNjA7XG5cdFx0XHRjb25zdCBodWU0ID0gKGh1ZTMgKyAxODApICUgMzYwO1xuXHRcdFx0Y29uc3QgaHVlNSA9IChodWUxICsgMzYwIC0gcmFuZG9tRGlzdGFuY2UpICUgMzYwO1xuXHRcdFx0Y29uc3QgaHVlNiA9IChodWU1ICsgMTgwKSAlIDM2MDtcblxuXHRcdFx0aGV4YWRpY0h1ZXMucHVzaChodWUxLCBodWUyLCBodWUzLCBodWU0LCBodWU1LCBodWU2KTtcblxuXHRcdFx0cmV0dXJuIGhleGFkaWNIdWVzO1xuXHRcdH0sXG5cdFx0J0Vycm9yIGdlbmVyYXRpbmcgaGV4YWRpYyBodWVzJyxcblx0XHR7XG5cdFx0XHRjb250ZXh0OiB7IGNvbG9yIH1cblx0XHR9XG5cdCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3BsaXRDb21wbGVtZW50YXJ5SHVlcyhcblx0Y29sb3I6IEhTTCxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IG51bWJlcltdIHtcblx0Y29uc3QgeyBlcnJvcnMgfSA9IGNvbW1vbi5zZXJ2aWNlcztcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Y29uc3QgYmFzZUh1ZSA9IGNvbG9yLnZhbHVlLmh1ZTtcblx0XHRcdGNvbnN0IG1vZGlmaWVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTEpICsgMjA7XG5cblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdChiYXNlSHVlICsgMTgwICsgbW9kaWZpZXIpICUgMzYwLFxuXHRcdFx0XHQoYmFzZUh1ZSArIDE4MCAtIG1vZGlmaWVyICsgMzYwKSAlIDM2MFxuXHRcdFx0XTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIHNwbGl0LWNvbXBsZW1lbnRhcnkgaHVlcycsXG5cdFx0e1xuXHRcdFx0Y29udGV4dDogeyBjb2xvciB9XG5cdFx0fVxuXHQpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVRldHJhZGljSHVlcyhjb2xvcjogSFNMLCBjb21tb246IENvbW1vbkZ1bmN0aW9ucyk6IG51bWJlcltdIHtcblx0Y29uc3QgeyBlcnJvcnMgfSA9IGNvbW1vbi5zZXJ2aWNlcztcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Y29uc3QgYmFzZUh1ZSA9IGNvbG9yLnZhbHVlLmh1ZTtcblx0XHRcdGNvbnN0IHJhbmRvbU9mZnNldCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQ2KSArIDIwO1xuXHRcdFx0Y29uc3QgZGlzdGFuY2UgPVxuXHRcdFx0XHQ5MCArIChNYXRoLnJhbmRvbSgpIDwgMC41ID8gLXJhbmRvbU9mZnNldCA6IHJhbmRvbU9mZnNldCk7XG5cblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdGJhc2VIdWUsXG5cdFx0XHRcdChiYXNlSHVlICsgMTgwKSAlIDM2MCxcblx0XHRcdFx0KGJhc2VIdWUgKyBkaXN0YW5jZSkgJSAzNjAsXG5cdFx0XHRcdChiYXNlSHVlICsgZGlzdGFuY2UgKyAxODApICUgMzYwXG5cdFx0XHRdO1xuXHRcdH0sXG5cdFx0J0Vycm9yIGdlbmVyYXRpbmcgdGV0cmFkaWMgaHVlcycsXG5cdFx0e1xuXHRcdFx0Y29udGV4dDogeyBjb2xvciB9XG5cdFx0fVxuXHQpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVRyaWFkaWMoY29sb3I6IEhTTCwgY29tbW9uOiBDb21tb25GdW5jdGlvbnMpOiBudW1iZXJbXSB7XG5cdGNvbnN0IHsgZXJyb3JzIH0gPSBjb21tb24uc2VydmljZXM7XG5cblx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKFxuXHRcdCgpID0+IHtcblx0XHRcdGNvbnN0IGJhc2VIdWUgPSBjb2xvci52YWx1ZS5odWU7XG5cblx0XHRcdHJldHVybiBbMTIwLCAyNDBdLm1hcChpbmNyZW1lbnQgPT4gKGJhc2VIdWUgKyBpbmNyZW1lbnQpICUgMzYwKTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIHRyaWFkaWMgaHVlcycsXG5cdFx0e1xuXHRcdFx0Y29udGV4dDogeyBjb2xvciB9XG5cdFx0fVxuXHQpO1xufVxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVIdWVzRm5Hcm91cDogR2VuZXJhdGVIdWVzRm5Hcm91cCA9IHtcblx0YW5hbG9nb3VzOiBnZW5lcmF0ZUFuYWxvZ291c0h1ZXMsXG5cdGRpYWRpYzogZ2VuZXJhdGVEaWFkaWNIdWVzLFxuXHRoZXhhZGljOiBnZW5lcmF0ZUhleGFkaWNIdWVzLFxuXHRzcGxpdENvbXBsZW1lbnRhcnk6IGdlbmVyYXRlU3BsaXRDb21wbGVtZW50YXJ5SHVlcyxcblx0dGV0cmFkaWM6IGdlbmVyYXRlVGV0cmFkaWNIdWVzLFxuXHR0cmlhZGljOiBnZW5lcmF0ZVRyaWFkaWNcbn0gYXMgY29uc3Q7XG4iXX0=