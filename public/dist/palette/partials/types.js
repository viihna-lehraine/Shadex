// File: palette/partials/types.js
import { paletteConfig } from '../../config/index.js';
const shiftRanges = paletteConfig.shiftRanges;
function generateAnalogousPalette(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        if (options.columnCount < 2)
            utils.dom.enforceSwatchRules(2, 6);
        const baseColor = utils.color.generateRandomHSL();
        const hues = generateHues.analogous(baseColor, options, common);
        const paletteItems = utils.palette.createPaletteItemArray(baseColor, hues);
        const analogousPalette = utils.palette.createPaletteObject(options, paletteItems);
        return analogousPalette;
    }, 'Error generating analogous palette.', { context: { options } });
}
function generateComplementaryPalette(options, common) {
    const { helpers, services: { errors }, utils } = common;
    return errors.handleSync(() => {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const baseHue = baseColor.value.hue;
        const hues = [baseHue];
        // always include the direct complement
        hues.push((baseHue + 180) % 360);
        // generate additional complementary variations if needed
        const extraColorsNeeded = columnCount - 2;
        if (extraColorsNeeded > 0) {
            for (let i = 0; i < extraColorsNeeded; i++) {
                const { weights, values } = paletteConfig.probabilities[options.distributionType];
                const variationOffset = helpers.random.selectRandomFromWeights({
                    weights,
                    values
                });
                const direction = Math.random() < 0.5 ? 1 : -1; // randomize direction
                const newHue = (baseHue + 180 + variationOffset * direction + 360) %
                    360;
                hues.push(newHue);
            }
        }
        // define lightness & saturation variation ranges
        const lightnessRange = [-10, -5, 0, 5, 10]; // possible changes in lightness
        const saturationRange = [-15, -10, 0, 10, 15]; // possible changes in saturation
        const paletteItems = hues.map((hue, index) => {
            const lightnessOffset = lightnessRange[Math.floor(Math.random() * lightnessRange.length)];
            const saturationOffset = saturationRange[Math.floor(Math.random() * saturationRange.length)];
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation +
                        saturationOffset))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessOffset)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating complementary palette.', { context: { options } });
}
function generateDiadicPalette(options, common, generateHues) {
    const { helpers, services: { errors }, utils } = common;
    return errors.handleSync(() => {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const hues = generateHues.diadic(baseColor, options, common);
        // if more swatches are needed, create slight variations
        const extraColorsNeeded = columnCount - 2;
        if (extraColorsNeeded > 0) {
            for (let i = 0; i < extraColorsNeeded; i++) {
                const { weights, values } = paletteConfig.probabilities[options.distributionType];
                const variationOffset = helpers.random.selectRandomFromWeights({
                    weights,
                    values
                });
                const direction = i % 2 === 0 ? 1 : -1;
                hues.push((baseColor.value.hue + variationOffset * direction) %
                    360);
            }
        }
        // create PaletteItem array with incrementing itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteConfig.shiftRanges.diadic.sat -
                paletteConfig.shiftRanges.diadic.sat / 2;
            const lightnessShift = Math.random() * paletteConfig.shiftRanges.diadic.light -
                paletteConfig.shiftRanges.diadic.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating diadic palette.', { context: { options } });
}
function generateHexadicPalette(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        // hexadic palettes always have 6 swatches
        const columnCount = 6;
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const hues = generateHues.hexadic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteConfig.shiftRanges.hexadic.sat -
                paletteConfig.shiftRanges.hexadic.sat / 2;
            const lightnessShift = Math.random() * paletteConfig.shiftRanges.hexadic.light -
                paletteConfig.shiftRanges.hexadic.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating hexadic palette.', { context: { options } });
}
function generateMonochromaticPalette(options, common) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const paletteItems = [];
        const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
        paletteItems.push(basePaletteItem);
        // generate monochromatic variations
        for (let i = 1; i < columnCount; i++) {
            const hueShift = Math.random() * 10 - 5; // small hue variation
            const saturationShift = Math.random() * 15 - 7.5; // slight saturation shift
            const lightnessShift = (i - 2) * 10; // creates a gradient effect
            const newColor = {
                value: {
                    hue: utils.brand.asRadial((baseColor.value.hue + hueShift + 360) % 360),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            const paletteItem = utils.palette.createPaletteItem(newColor, i + 1);
            paletteItems.push(paletteItem);
        }
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating monochromatic palette.', { context: { options } });
}
function generateRandomPalette(options, common) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        // ensure column count is between 2 and 6
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const paletteItems = [];
        const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
        paletteItems.push(basePaletteItem);
        for (let i = 1; i < columnCount; i++) {
            const randomColor = utils.color.generateRandomHSL();
            const nextPaletteItem = utils.palette.createPaletteItem(randomColor, i + 1);
            paletteItems.push(nextPaletteItem);
        }
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating random palette.', { context: { options } });
}
function generateSplitComplementaryPalette(options, common) {
    const { helpers, services: { errors }, utils } = common;
    return errors.handleSync(() => {
        // ensure column count is at least 3 and at most 6
        const columnCount = Math.max(3, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.color.generateRandomHSL();
        const baseHue = baseColor.value.hue;
        // generate split complementary hues
        const hues = [
            baseHue,
            (baseHue +
                180 +
                paletteConfig.shiftRanges.splitComplementary.hue) %
                360,
            (baseHue +
                180 -
                paletteConfig.shiftRanges.splitComplementary.hue +
                360) %
                360
        ];
        // if swatchCount > 3, introduce additional variations
        for (let i = 3; i < columnCount; i++) {
            const { weights, values } = paletteConfig.probabilities[options.distributionType];
            const variationOffset = helpers.random.selectRandomFromWeights({
                weights,
                values
            });
            const direction = i % 2 === 0 ? 1 : -1;
            hues.push((baseHue + 180 + variationOffset * direction) % 360);
        }
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() *
                paletteConfig.shiftRanges.splitComplementary.sat -
                paletteConfig.shiftRanges.splitComplementary.sat / 2;
            const lightnessShift = Math.random() *
                paletteConfig.shiftRanges.splitComplementary.light -
                paletteConfig.shiftRanges.splitComplementary.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating split-complementary palette.', { context: { options } });
}
function generateTetradicPalette(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        // tetradic palettes always have 4 swatches
        const columnCount = 4;
        utils.dom.enforceSwatchRules(columnCount, 4);
        const baseColor = utils.color.generateRandomHSL();
        // generate the 4 hues
        const hues = generateHues.tetradic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteConfig.shiftRanges.tetradic.sat -
                paletteConfig.shiftRanges.tetradic.sat / 2;
            const lightnessShift = Math.random() * paletteConfig.shiftRanges.tetradic.light -
                paletteConfig.shiftRanges.tetradic.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating tetradic palette.', { context: { options } });
}
function generateTriadicPalette(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    return errors.handleSync(() => {
        // triadic palettes always have exactly 3 colors
        const columnCount = 3;
        utils.dom.enforceSwatchRules(columnCount, 3);
        // generate the base color
        const baseColor = utils.color.generateRandomHSL();
        // generate the 3 hues needed
        const hues = generateHues.triadic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * shiftRanges.triadic.sat -
                paletteConfig.shiftRanges.triadic.sat / 2;
            const lightnessShift = Math.random() * paletteConfig.shiftRanges.triadic.light -
                paletteConfig.shiftRanges.triadic.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }, 'Error generating triadic palette.', { context: { options } });
}
export const generatePaletteFnGroup = {
    analogous: generateAnalogousPalette,
    complementary: generateComplementaryPalette,
    diadic: generateDiadicPalette,
    hexadic: generateHexadicPalette,
    monochromatic: generateMonochromaticPalette,
    random: generateRandomPalette,
    splitComplementary: generateSplitComplementaryPalette,
    tetradic: generateTetradicPalette,
    triadic: generateTriadicPalette
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGFsZXR0ZS9wYXJ0aWFscy90eXBlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrQ0FBa0M7QUFXbEMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRXRELE1BQU0sV0FBVyxHQUFHLGFBQWEsQ0FBQyxXQUFXLENBQUM7QUFFOUMsU0FBUyx3QkFBd0IsQ0FDaEMsT0FBK0IsRUFDL0IsTUFBdUIsRUFDdkIsWUFBaUM7SUFFakMsTUFBTSxFQUNMLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUNwQixLQUFLLEVBQ0wsR0FBRyxNQUFNLENBQUM7SUFFWCxPQUFPLE1BQU0sQ0FBQyxVQUFVLENBQ3ZCLEdBQUcsRUFBRTtRQUNKLElBQUksT0FBTyxDQUFDLFdBQVcsR0FBRyxDQUFDO1lBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFaEUsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ2xELE1BQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNoRSxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUN4RCxTQUFTLEVBQ1QsSUFBSSxDQUNKLENBQUM7UUFDRixNQUFNLGdCQUFnQixHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQ3pELE9BQU8sRUFDUCxZQUFZLENBQ1osQ0FBQztRQUVGLE9BQU8sZ0JBQWdCLENBQUM7SUFDekIsQ0FBQyxFQUNELHFDQUFxQyxFQUNyQyxFQUFFLE9BQU8sRUFBRSxFQUFFLE9BQU8sRUFBRSxFQUFFLENBQ3hCLENBQUM7QUFDSCxDQUFDO0FBRUQsU0FBUyw0QkFB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QUs7YUFDYixDQUFDO1lBRUYsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ2pFLENBQUMsRUFDRCxtQ0FBbUMsRUFDbkMsRUFBRSxPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxDQUN4QixDQUFDO0FBQ0gsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLHNCQUFzQixHQUEyQjtJQUM3RCxTQUFTLEVBQUUsd0JBQXdCO0lBQ25DLGFBQWEsRUFBRSw0QkFBNEI7SUFDM0MsTUFBTSxFQUFFLHFCQUFxQjtJQUM3QixPQUFPLEVBQUUsc0JBQXNCO0lBQy9CLGFBQWEsRUFBRSw0QkFBNEI7SUFDM0MsTUFBTSxFQUFFLHFCQUFxQjtJQUM3QixrQkFBa0IsRUFBRSxpQ0FBaUM7SUFDckQsUUFBUSxFQUFFLHVCQUF1QjtJQUNqQyxPQUFPLEVBQUUsc0JBQXNCO0NBQ3RCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaWxlOiBwYWxldHRlL3BhcnRpYWxzL3R5cGVzLmpzXG5cbmltcG9ydCB7XG5cdENvbW1vbkZ1bmN0aW9ucyxcblx0R2VuZXJhdGVIdWVzRm5Hcm91cCxcblx0R2VuZXJhdGVQYWxldHRlRm5Hcm91cCxcblx0SFNMLFxuXHRQYWxldHRlLFxuXHRQYWxldHRlSXRlbSxcblx0U2VsZWN0ZWRQYWxldHRlT3B0aW9uc1xufSBmcm9tICcuLi8uLi90eXBlcy9pbmRleC5qcyc7XG5pbXBvcnQgeyBwYWxldHRlQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29uZmlnL2luZGV4LmpzJztcblxuY29uc3Qgc2hpZnRSYW5nZXMgPSBwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzO1xuXG5mdW5jdGlvbiBnZW5lcmF0ZUFuYWxvZ291c1BhbGV0dGUoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0aWYgKG9wdGlvbnMuY29sdW1uQ291bnQgPCAyKSB1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKDIsIDYpO1xuXG5cdFx0XHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5jb2xvci5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRcdFx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy5hbmFsb2dvdXMoYmFzZUNvbG9yLCBvcHRpb25zLCBjb21tb24pO1xuXHRcdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbUFycmF5KFxuXHRcdFx0XHRiYXNlQ29sb3IsXG5cdFx0XHRcdGh1ZXNcblx0XHRcdCk7XG5cdFx0XHRjb25zdCBhbmFsb2dvdXNQYWxldHRlID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KFxuXHRcdFx0XHRvcHRpb25zLFxuXHRcdFx0XHRwYWxldHRlSXRlbXNcblx0XHRcdCk7XG5cblx0XHRcdHJldHVybiBhbmFsb2dvdXNQYWxldHRlO1xuXHRcdH0sXG5cdFx0J0Vycm9yIGdlbmVyYXRpbmcgYW5hbG9nb3VzIHBhbGV0dGUuJyxcblx0XHR7IGNvbnRleHQ6IHsgb3B0aW9ucyB9IH1cblx0KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVDb21wbGVtZW50YXJ5UGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0aGVscGVycyxcblx0XHRzZXJ2aWNlczogeyBlcnJvcnMgfSxcblx0XHR1dGlsc1xuXHR9ID0gY29tbW9uO1xuXG5cdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYyhcblx0XHQoKSA9PiB7XG5cdFx0XHRjb25zdCBjb2x1bW5Db3VudCA9IE1hdGgubWF4KDIsIE1hdGgubWluKDYsIG9wdGlvbnMuY29sdW1uQ291bnQpKTtcblxuXHRcdFx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgNik7XG5cblx0XHRcdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmNvbG9yLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0XHRjb25zdCBiYXNlSHVlID0gYmFzZUNvbG9yLnZhbHVlLmh1ZTtcblx0XHRcdGNvbnN0IGh1ZXM6IG51bWJlcltdID0gW2Jhc2VIdWVdO1xuXG5cdFx0XHQvLyBhbHdheXMgaW5jbHVkZSB0aGUgZGlyZWN0IGNvbXBsZW1lbnRcblx0XHRcdGh1ZXMucHVzaCgoYmFzZUh1ZSArIDE4MCkgJSAzNjApO1xuXG5cdFx0XHQvLyBnZW5lcmF0ZSBhZGRpdGlvbmFsIGNvbXBsZW1lbnRhcnkgdmFyaWF0aW9ucyBpZiBuZWVkZWRcblx0XHRcdGNvbnN0IGV4dHJhQ29sb3JzTmVlZGVkID0gY29sdW1uQ291bnQgLSAyO1xuXG5cdFx0XHRpZiAoZXh0cmFDb2xvcnNOZWVkZWQgPiAwKSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZXh0cmFDb2xvcnNOZWVkZWQ7IGkrKykge1xuXHRcdFx0XHRcdGNvbnN0IHsgd2VpZ2h0cywgdmFsdWVzIH0gPVxuXHRcdFx0XHRcdFx0cGFsZXR0ZUNvbmZpZy5wcm9iYWJpbGl0aWVzW29wdGlvbnMuZGlzdHJpYnV0aW9uVHlwZV07XG5cdFx0XHRcdFx0Y29uc3QgdmFyaWF0aW9uT2Zmc2V0ID1cblx0XHRcdFx0XHRcdGhlbHBlcnMucmFuZG9tLnNlbGVjdFJhbmRvbUZyb21XZWlnaHRzKHtcblx0XHRcdFx0XHRcdFx0d2VpZ2h0cyxcblx0XHRcdFx0XHRcdFx0dmFsdWVzXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMSA6IC0xOyAvLyByYW5kb21pemUgZGlyZWN0aW9uXG5cdFx0XHRcdFx0Y29uc3QgbmV3SHVlID1cblx0XHRcdFx0XHRcdChiYXNlSHVlICsgMTgwICsgdmFyaWF0aW9uT2Zmc2V0ICogZGlyZWN0aW9uICsgMzYwKSAlXG5cdFx0XHRcdFx0XHQzNjA7XG5cdFx0XHRcdFx0aHVlcy5wdXNoKG5ld0h1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gZGVmaW5lIGxpZ2h0bmVzcyAmIHNhdHVyYXRpb24gdmFyaWF0aW9uIHJhbmdlc1xuXHRcdFx0Y29uc3QgbGlnaHRuZXNzUmFuZ2UgPSBbLTEwLCAtNSwgMCwgNSwgMTBdOyAvLyBwb3NzaWJsZSBjaGFuZ2VzIGluIGxpZ2h0bmVzc1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvblJhbmdlID0gWy0xNSwgLTEwLCAwLCAxMCwgMTVdOyAvLyBwb3NzaWJsZSBjaGFuZ2VzIGluIHNhdHVyYXRpb25cblxuXHRcdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgbGlnaHRuZXNzT2Zmc2V0ID1cblx0XHRcdFx0XHRsaWdodG5lc3NSYW5nZVtcblx0XHRcdFx0XHRcdE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGxpZ2h0bmVzc1JhbmdlLmxlbmd0aClcblx0XHRcdFx0XHRdO1xuXHRcdFx0XHRjb25zdCBzYXR1cmF0aW9uT2Zmc2V0ID1cblx0XHRcdFx0XHRzYXR1cmF0aW9uUmFuZ2VbXG5cdFx0XHRcdFx0XHRNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzYXR1cmF0aW9uUmFuZ2UubGVuZ3RoKVxuXHRcdFx0XHRcdF07XG5cblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gK1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRzYXR1cmF0aW9uT2Zmc2V0XG5cdFx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzT2Zmc2V0XG5cdFx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xuXHRcdH0sXG5cdFx0J0Vycm9yIGdlbmVyYXRpbmcgY29tcGxlbWVudGFyeSBwYWxldHRlLicsXG5cdFx0eyBjb250ZXh0OiB7IG9wdGlvbnMgfSB9XG5cdCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRGlhZGljUGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnMsXG5cdGdlbmVyYXRlSHVlczogR2VuZXJhdGVIdWVzRm5Hcm91cFxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHtcblx0XHRoZWxwZXJzLFxuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9LFxuXHRcdHV0aWxzXG5cdH0gPSBjb21tb247XG5cblx0cmV0dXJuIGVycm9ycy5oYW5kbGVTeW5jKFxuXHRcdCgpID0+IHtcblx0XHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMiwgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXG5cdFx0XHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRcdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuY29sb3IuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0XHRcdGNvbnN0IGh1ZXMgPSBnZW5lcmF0ZUh1ZXMuZGlhZGljKGJhc2VDb2xvciwgb3B0aW9ucywgY29tbW9uKTtcblxuXHRcdFx0Ly8gaWYgbW9yZSBzd2F0Y2hlcyBhcmUgbmVlZGVkLCBjcmVhdGUgc2xpZ2h0IHZhcmlhdGlvbnNcblx0XHRcdGNvbnN0IGV4dHJhQ29sb3JzTmVlZGVkID0gY29sdW1uQ291bnQgLSAyO1xuXHRcdFx0aWYgKGV4dHJhQ29sb3JzTmVlZGVkID4gMCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGV4dHJhQ29sb3JzTmVlZGVkOyBpKyspIHtcblx0XHRcdFx0XHRjb25zdCB7IHdlaWdodHMsIHZhbHVlcyB9ID1cblx0XHRcdFx0XHRcdHBhbGV0dGVDb25maWcucHJvYmFiaWxpdGllc1tvcHRpb25zLmRpc3RyaWJ1dGlvblR5cGVdO1xuXHRcdFx0XHRcdGNvbnN0IHZhcmlhdGlvbk9mZnNldCA9XG5cdFx0XHRcdFx0XHRoZWxwZXJzLnJhbmRvbS5zZWxlY3RSYW5kb21Gcm9tV2VpZ2h0cyh7XG5cdFx0XHRcdFx0XHRcdHdlaWdodHMsXG5cdFx0XHRcdFx0XHRcdHZhbHVlc1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0Y29uc3QgZGlyZWN0aW9uID0gaSAlIDIgPT09IDAgPyAxIDogLTE7XG5cblx0XHRcdFx0XHRodWVzLnB1c2goXG5cdFx0XHRcdFx0XHQoYmFzZUNvbG9yLnZhbHVlLmh1ZSArIHZhcmlhdGlvbk9mZnNldCAqIGRpcmVjdGlvbikgJVxuXHRcdFx0XHRcdFx0XHQzNjBcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGluY3JlbWVudGluZyBpdGVtSURzXG5cdFx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdFx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPVxuXHRcdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLmRpYWRpYy5zYXQgLVxuXHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMuZGlhZGljLnNhdCAvIDI7XG5cdFx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy5kaWFkaWMubGlnaHQgLVxuXHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMuZGlhZGljLmxpZ2h0IC8gMjtcblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIGRpYWRpYyBwYWxldHRlLicsXG5cdFx0eyBjb250ZXh0OiB7IG9wdGlvbnMgfSB9XG5cdCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlSGV4YWRpY1BhbGV0dGUoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Ly8gaGV4YWRpYyBwYWxldHRlcyBhbHdheXMgaGF2ZSA2IHN3YXRjaGVzXG5cdFx0XHRjb25zdCBjb2x1bW5Db3VudCA9IDY7XG5cblx0XHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdFx0XHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5jb2xvci5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRcdFx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy5oZXhhZGljKGJhc2VDb2xvciwgY29tbW9uKTtcblxuXHRcdFx0Ly8gY3JlYXRlIFBhbGV0dGVJdGVtIGFycmF5IHdpdGggYXNzaWduZWQgaXRlbUlEc1xuXHRcdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy5oZXhhZGljLnNhdCAtXG5cdFx0XHRcdFx0cGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy5oZXhhZGljLnNhdCAvIDI7XG5cdFx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy5oZXhhZGljLmxpZ2h0IC1cblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLmhleGFkaWMubGlnaHQgLyAyO1xuXG5cdFx0XHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRcdGh1ZTogdXRpbHMuYnJhbmQuYXNSYWRpYWwoaHVlKSxcblx0XHRcdFx0XHRcdHNhdHVyYXRpb246IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvblNoaWZ0XG5cdFx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzU2hpZnRcblx0XHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgaW5kZXggKyAxKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG5cdFx0fSxcblx0XHQnRXJyb3IgZ2VuZXJhdGluZyBoZXhhZGljIHBhbGV0dGUuJyxcblx0XHR7IGNvbnRleHQ6IHsgb3B0aW9ucyB9IH1cblx0KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVNb25vY2hyb21hdGljUGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Y29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heCgyLCBNYXRoLm1pbig2LCBvcHRpb25zLmNvbHVtbkNvdW50KSk7XG5cblx0XHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdFx0XHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5jb2xvci5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRcdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW107XG5cblx0XHRcdGNvbnN0IGJhc2VQYWxldHRlSXRlbSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0oXG5cdFx0XHRcdGJhc2VDb2xvcixcblx0XHRcdFx0MVxuXHRcdFx0KTtcblx0XHRcdHBhbGV0dGVJdGVtcy5wdXNoKGJhc2VQYWxldHRlSXRlbSk7XG5cblx0XHRcdC8vIGdlbmVyYXRlIG1vbm9jaHJvbWF0aWMgdmFyaWF0aW9uc1xuXHRcdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCBjb2x1bW5Db3VudDsgaSsrKSB7XG5cdFx0XHRcdGNvbnN0IGh1ZVNoaWZ0ID0gTWF0aC5yYW5kb20oKSAqIDEwIC0gNTsgLy8gc21hbGwgaHVlIHZhcmlhdGlvblxuXHRcdFx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPSBNYXRoLnJhbmRvbSgpICogMTUgLSA3LjU7IC8vIHNsaWdodCBzYXR1cmF0aW9uIHNoaWZ0XG5cdFx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID0gKGkgLSAyKSAqIDEwOyAvLyBjcmVhdGVzIGEgZ3JhZGllbnQgZWZmZWN0XG5cblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChcblx0XHRcdFx0XHRcdFx0KGJhc2VDb2xvci52YWx1ZS5odWUgKyBodWVTaGlmdCArIDM2MCkgJSAzNjBcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0XG5cdFx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHRcdH07XG5cdFx0XHRcdGNvbnN0IHBhbGV0dGVJdGVtID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShcblx0XHRcdFx0XHRuZXdDb2xvcixcblx0XHRcdFx0XHRpICsgMVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdHBhbGV0dGVJdGVtcy5wdXNoKHBhbGV0dGVJdGVtKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xuXHRcdH0sXG5cdFx0J0Vycm9yIGdlbmVyYXRpbmcgbW9ub2Nocm9tYXRpYyBwYWxldHRlLicsXG5cdFx0eyBjb250ZXh0OiB7IG9wdGlvbnMgfSB9XG5cdCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tUGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Ly8gZW5zdXJlIGNvbHVtbiBjb3VudCBpcyBiZXR3ZWVuIDIgYW5kIDZcblx0XHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMiwgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXG5cdFx0XHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRcdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuY29sb3IuZ2VuZXJhdGVSYW5kb21IU0woKTtcblxuXHRcdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW107XG5cblx0XHRcdGNvbnN0IGJhc2VQYWxldHRlSXRlbSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0oXG5cdFx0XHRcdGJhc2VDb2xvcixcblx0XHRcdFx0MVxuXHRcdFx0KTtcblx0XHRcdHBhbGV0dGVJdGVtcy5wdXNoKGJhc2VQYWxldHRlSXRlbSk7XG5cblx0XHRcdGZvciAobGV0IGkgPSAxOyBpIDwgY29sdW1uQ291bnQ7IGkrKykge1xuXHRcdFx0XHRjb25zdCByYW5kb21Db2xvciA9IHV0aWxzLmNvbG9yLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0XHRcdGNvbnN0IG5leHRQYWxldHRlSXRlbSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0oXG5cdFx0XHRcdFx0cmFuZG9tQ29sb3IsXG5cdFx0XHRcdFx0aSArIDFcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRwYWxldHRlSXRlbXMucHVzaChuZXh0UGFsZXR0ZUl0ZW0pO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG5cdFx0fSxcblx0XHQnRXJyb3IgZ2VuZXJhdGluZyByYW5kb20gcGFsZXR0ZS4nLFxuXHRcdHsgY29udGV4dDogeyBvcHRpb25zIH0gfVxuXHQpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVNwbGl0Q29tcGxlbWVudGFyeVBhbGV0dGUoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zXG4pOiBQYWxldHRlIHtcblx0Y29uc3Qge1xuXHRcdGhlbHBlcnMsXG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHRyZXR1cm4gZXJyb3JzLmhhbmRsZVN5bmMoXG5cdFx0KCkgPT4ge1xuXHRcdFx0Ly8gZW5zdXJlIGNvbHVtbiBjb3VudCBpcyBhdCBsZWFzdCAzIGFuZCBhdCBtb3N0IDZcblx0XHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMywgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXHRcdFx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgNik7XG5cblx0XHRcdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmNvbG9yLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0XHRjb25zdCBiYXNlSHVlID0gYmFzZUNvbG9yLnZhbHVlLmh1ZTtcblxuXHRcdFx0Ly8gZ2VuZXJhdGUgc3BsaXQgY29tcGxlbWVudGFyeSBodWVzXG5cdFx0XHRjb25zdCBodWVzID0gW1xuXHRcdFx0XHRiYXNlSHVlLFxuXHRcdFx0XHQoYmFzZUh1ZSArXG5cdFx0XHRcdFx0MTgwICtcblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnNwbGl0Q29tcGxlbWVudGFyeS5odWUpICVcblx0XHRcdFx0XHQzNjAsXG5cdFx0XHRcdChiYXNlSHVlICtcblx0XHRcdFx0XHQxODAgLVxuXHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMuc3BsaXRDb21wbGVtZW50YXJ5Lmh1ZSArXG5cdFx0XHRcdFx0MzYwKSAlXG5cdFx0XHRcdFx0MzYwXG5cdFx0XHRdO1xuXG5cdFx0XHQvLyBpZiBzd2F0Y2hDb3VudCA+IDMsIGludHJvZHVjZSBhZGRpdGlvbmFsIHZhcmlhdGlvbnNcblx0XHRcdGZvciAobGV0IGkgPSAzOyBpIDwgY29sdW1uQ291bnQ7IGkrKykge1xuXHRcdFx0XHRjb25zdCB7IHdlaWdodHMsIHZhbHVlcyB9ID1cblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnByb2JhYmlsaXRpZXNbb3B0aW9ucy5kaXN0cmlidXRpb25UeXBlXTtcblx0XHRcdFx0Y29uc3QgdmFyaWF0aW9uT2Zmc2V0ID0gaGVscGVycy5yYW5kb20uc2VsZWN0UmFuZG9tRnJvbVdlaWdodHMoe1xuXHRcdFx0XHRcdHdlaWdodHMsXG5cdFx0XHRcdFx0dmFsdWVzXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRjb25zdCBkaXJlY3Rpb24gPSBpICUgMiA9PT0gMCA/IDEgOiAtMTtcblx0XHRcdFx0aHVlcy5wdXNoKChiYXNlSHVlICsgMTgwICsgdmFyaWF0aW9uT2Zmc2V0ICogZGlyZWN0aW9uKSAlIDM2MCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0XHRcdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRcdFx0TWF0aC5yYW5kb20oKSAqXG5cdFx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnNwbGl0Q29tcGxlbWVudGFyeS5zYXQgLVxuXHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMuc3BsaXRDb21wbGVtZW50YXJ5LnNhdCAvIDI7XG5cdFx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICpcblx0XHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMuc3BsaXRDb21wbGVtZW50YXJ5LmxpZ2h0IC1cblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnNwbGl0Q29tcGxlbWVudGFyeS5saWdodCAvIDI7XG5cblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIHNwbGl0LWNvbXBsZW1lbnRhcnkgcGFsZXR0ZS4nLFxuXHRcdHsgY29udGV4dDogeyBvcHRpb25zIH0gfVxuXHQpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVRldHJhZGljUGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnMsXG5cdGdlbmVyYXRlSHVlczogR2VuZXJhdGVIdWVzRm5Hcm91cFxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHtcblx0XHRzZXJ2aWNlczogeyBlcnJvcnMgfSxcblx0XHR1dGlsc1xuXHR9ID0gY29tbW9uO1xuXG5cdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYyhcblx0XHQoKSA9PiB7XG5cdFx0XHQvLyB0ZXRyYWRpYyBwYWxldHRlcyBhbHdheXMgaGF2ZSA0IHN3YXRjaGVzXG5cdFx0XHRjb25zdCBjb2x1bW5Db3VudCA9IDQ7XG5cdFx0XHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA0KTtcblxuXHRcdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuY29sb3IuZ2VuZXJhdGVSYW5kb21IU0woKTtcblxuXHRcdFx0Ly8gZ2VuZXJhdGUgdGhlIDQgaHVlc1xuXHRcdFx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy50ZXRyYWRpYyhiYXNlQ29sb3IsIGNvbW1vbik7XG5cblx0XHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0XHRcdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMudGV0cmFkaWMuc2F0IC1cblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnRldHJhZGljLnNhdCAvIDI7XG5cdFx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy50ZXRyYWRpYy5saWdodCAtXG5cdFx0XHRcdFx0cGFsZXR0ZUNvbmZpZy5zaGlmdFJhbmdlcy50ZXRyYWRpYy5saWdodCAvIDI7XG5cblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIHRldHJhZGljIHBhbGV0dGUuJyxcblx0XHR7IGNvbnRleHQ6IHsgb3B0aW9ucyB9IH1cblx0KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVUcmlhZGljUGFsZXR0ZShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnMsXG5cdGdlbmVyYXRlSHVlczogR2VuZXJhdGVIdWVzRm5Hcm91cFxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHtcblx0XHRzZXJ2aWNlczogeyBlcnJvcnMgfSxcblx0XHR1dGlsc1xuXHR9ID0gY29tbW9uO1xuXG5cdHJldHVybiBlcnJvcnMuaGFuZGxlU3luYyhcblx0XHQoKSA9PiB7XG5cdFx0XHQvLyB0cmlhZGljIHBhbGV0dGVzIGFsd2F5cyBoYXZlIGV4YWN0bHkgMyBjb2xvcnNcblx0XHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gMztcblx0XHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDMpO1xuXG5cdFx0XHQvLyBnZW5lcmF0ZSB0aGUgYmFzZSBjb2xvclxuXHRcdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuY29sb3IuZ2VuZXJhdGVSYW5kb21IU0woKTtcblxuXHRcdFx0Ly8gZ2VuZXJhdGUgdGhlIDMgaHVlcyBuZWVkZWRcblx0XHRcdGNvbnN0IGh1ZXMgPSBnZW5lcmF0ZUh1ZXMudHJpYWRpYyhiYXNlQ29sb3IsIGNvbW1vbik7XG5cblx0XHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0XHRcdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHNoaWZ0UmFuZ2VzLnRyaWFkaWMuc2F0IC1cblx0XHRcdFx0XHRwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnRyaWFkaWMuc2F0IC8gMjtcblx0XHRcdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPVxuXHRcdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlQ29uZmlnLnNoaWZ0UmFuZ2VzLnRyaWFkaWMubGlnaHQgLVxuXHRcdFx0XHRcdHBhbGV0dGVDb25maWcuc2hpZnRSYW5nZXMudHJpYWRpYy5saWdodCAvIDI7XG5cblx0XHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0XHR9LFxuXHRcdCdFcnJvciBnZW5lcmF0aW5nIHRyaWFkaWMgcGFsZXR0ZS4nLFxuXHRcdHsgY29udGV4dDogeyBvcHRpb25zIH0gfVxuXHQpO1xufVxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVQYWxldHRlRm5Hcm91cDogR2VuZXJhdGVQYWxldHRlRm5Hcm91cCA9IHtcblx0YW5hbG9nb3VzOiBnZW5lcmF0ZUFuYWxvZ291c1BhbGV0dGUsXG5cdGNvbXBsZW1lbnRhcnk6IGdlbmVyYXRlQ29tcGxlbWVudGFyeVBhbGV0dGUsXG5cdGRpYWRpYzogZ2VuZXJhdGVEaWFkaWNQYWxldHRlLFxuXHRoZXhhZGljOiBnZW5lcmF0ZUhleGFkaWNQYWxldHRlLFxuXHRtb25vY2hyb21hdGljOiBnZW5lcmF0ZU1vbm9jaHJvbWF0aWNQYWxldHRlLFxuXHRyYW5kb206IGdlbmVyYXRlUmFuZG9tUGFsZXR0ZSxcblx0c3BsaXRDb21wbGVtZW50YXJ5OiBnZW5lcmF0ZVNwbGl0Q29tcGxlbWVudGFyeVBhbGV0dGUsXG5cdHRldHJhZGljOiBnZW5lcmF0ZVRldHJhZGljUGFsZXR0ZSxcblx0dHJpYWRpYzogZ2VuZXJhdGVUcmlhZGljUGFsZXR0ZVxufSBhcyBjb25zdDtcbiJdfQ==