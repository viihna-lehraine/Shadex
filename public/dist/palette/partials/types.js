// File: palette/partials/types.js
import { constsData as consts } from '../../data/consts.js';
const paletteRanges = consts.paletteRanges;
function analogous(options, common, generateHues) {
    const utils = common.utils;
    if (options.columnCount < 2)
        utils.dom.enforceSwatchRules(2, 6);
    const baseColor = utils.app.generateRandomHSL();
    const hues = generateHues.analogous(baseColor, options, common);
    const paletteItems = utils.palette.createPaletteItemArray(baseColor, hues);
    const analogousPalette = utils.palette.createPaletteObject(options, paletteItems);
    return analogousPalette;
}
function complementary(options, common) {
    const helpers = common.helpers;
    const utils = common.utils;
    const columnCount = Math.max(2, Math.min(6, options.columnCount));
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const baseHue = baseColor.value.hue;
    const hues = [baseHue];
    // always include the direct complement
    hues.push((baseHue + 180) % 360);
    // generate additional complementary variations if needed
    const extraColorsNeeded = columnCount - 2;
    if (extraColorsNeeded > 0) {
        for (let i = 0; i < extraColorsNeeded; i++) {
            const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
            const direction = Math.random() < 0.5 ? 1 : -1; // randomize direction
            const newHue = (baseHue + 180 + variationOffset * direction + 360) % 360;
            hues.push(newHue);
        }
    }
    // define lightness & saturation variation ranges
    const lightnessRange = [-10, -5, 0, 5, 10]; // possible changes in lightness
    const saturationRange = [-15, -10, 0, 10, 15]; // possible changes in saturation
    const paletteItems = hues.map((hue, index) => {
        const lightnessOffset = lightnessRange[Math.floor(Math.random() * lightnessRange.length)];
        const saturationOffset = saturationRange[Math.floor(Math.random() * saturationRange.length)];
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationOffset))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessOffset)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
function diadic(options, common, generateHues) {
    const helpers = common.helpers;
    const utils = common.utils;
    const columnCount = Math.max(2, Math.min(6, options.columnCount));
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const hues = generateHues.diadic(baseColor, options, common);
    // if more swatches are needed, create slight variations
    const extraColorsNeeded = columnCount - 2;
    if (extraColorsNeeded > 0) {
        for (let i = 0; i < extraColorsNeeded; i++) {
            const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
            const direction = i % 2 === 0 ? 1 : -1;
            hues.push((baseColor.value.hue + variationOffset * direction) % 360);
        }
    }
    // create PaletteItem array with incrementing itemIDs
    const paletteItems = hues.map((hue, index) => {
        const saturationShift = Math.random() * paletteRanges.shift.diadic.sat -
            paletteRanges.shift.diadic.sat / 2;
        const lightnessShift = Math.random() * paletteRanges.shift.diadic.light -
            paletteRanges.shift.diadic.light / 2;
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
function hexadic(options, common, generateHues) {
    const utils = common.utils;
    // hexadic palettes always have 6 swatches
    const columnCount = 6;
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const hues = generateHues.hexadic(baseColor, common);
    // create PaletteItem array with assigned itemIDs
    const paletteItems = hues.map((hue, index) => {
        const saturationShift = Math.random() * paletteRanges.shift.hexad.sat -
            paletteRanges.shift.hexad.sat / 2;
        const lightnessShift = Math.random() * paletteRanges.shift.hexad.light -
            paletteRanges.shift.hexad.light / 2;
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
function monochromatic(options, common) {
    const utils = common.utils;
    const columnCount = Math.max(2, Math.min(6, options.columnCount));
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const paletteItems = [];
    const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
    paletteItems.push(basePaletteItem);
    // generate monochromatic variations
    for (let i = 1; i < columnCount; i++) {
        const hueShift = Math.random() * 10 - 5; // small hue variation
        const saturationShift = Math.random() * 15 - 7.5; // slight saturation shift
        const lightnessShift = (i - 2) * 10; // creates a gradient effect
        const newColor = {
            value: {
                hue: utils.brand.asRadial((baseColor.value.hue + hueShift + 360) % 360),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        const paletteItem = utils.palette.createPaletteItem(newColor, i + 1);
        paletteItems.push(paletteItem);
    }
    return utils.palette.createPaletteObject(options, paletteItems);
}
function random(options, common) {
    const utils = common.utils;
    // ensure column count is between 2 and 6
    const columnCount = Math.max(2, Math.min(6, options.columnCount));
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const paletteItems = [];
    const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
    paletteItems.push(basePaletteItem);
    for (let i = 1; i < columnCount; i++) {
        const randomColor = utils.app.generateRandomHSL();
        const nextPaletteItem = utils.palette.createPaletteItem(randomColor, i + 1);
        paletteItems.push(nextPaletteItem);
    }
    return utils.palette.createPaletteObject(options, paletteItems);
}
function splitComplementary(options, common) {
    const helpers = common.helpers;
    const utils = common.utils;
    // ensure column count is at least 3 and at most 6
    const columnCount = Math.max(3, Math.min(6, options.columnCount));
    utils.dom.enforceSwatchRules(columnCount, 6);
    const baseColor = utils.app.generateRandomHSL();
    const baseHue = baseColor.value.hue;
    // generate split complementary hues
    const hues = [
        baseHue,
        (baseHue + 180 + paletteRanges.shift.splitComp.hue) % 360,
        (baseHue + 180 - paletteRanges.shift.splitComp.hue + 360) % 360
    ];
    // if swatchCount > 3, introduce additional variations
    for (let i = 3; i < columnCount; i++) {
        const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
        const direction = i % 2 === 0 ? 1 : -1;
        hues.push((baseHue + 180 + variationOffset * direction) % 360);
    }
    // create PaletteItem array with assigned itemIDs
    const paletteItems = hues.map((hue, index) => {
        const saturationShift = Math.random() * paletteRanges.shift.splitComp.sat -
            paletteRanges.shift.splitComp.sat / 2;
        const lightnessShift = Math.random() * paletteRanges.shift.splitComp.light -
            paletteRanges.shift.splitComp.light / 2;
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
function tetradic(options, common, generateHues) {
    const utils = common.utils;
    // tetradic palettes always have 4 swatches
    const columnCount = 4;
    utils.dom.enforceSwatchRules(columnCount, 4);
    const baseColor = utils.app.generateRandomHSL();
    // generate the 4 hues
    const hues = generateHues.tetradic(baseColor, common);
    // create PaletteItem array with assigned itemIDs
    const paletteItems = hues.map((hue, index) => {
        const saturationShift = Math.random() * paletteRanges.shift.tetra.sat -
            paletteRanges.shift.tetra.sat / 2;
        const lightnessShift = Math.random() * paletteRanges.shift.tetra.light -
            paletteRanges.shift.tetra.light / 2;
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
function triadic(options, common, generateHues) {
    const utils = common.utils;
    // triadic palettes always have exactly 3 colors
    const columnCount = 3;
    utils.dom.enforceSwatchRules(columnCount, 3);
    // generate the base color
    const baseColor = utils.app.generateRandomHSL();
    // generate the 3 hues needed
    const hues = generateHues.triadic(baseColor, common);
    // create PaletteItem array with assigned itemIDs
    const paletteItems = hues.map((hue, index) => {
        const saturationShift = Math.random() * paletteRanges.shift.triad.sat -
            paletteRanges.shift.triad.sat / 2;
        const lightnessShift = Math.random() * paletteRanges.shift.triad.light -
            paletteRanges.shift.triad.light / 2;
        const newColor = {
            value: {
                hue: utils.brand.asRadial(hue),
                saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
            },
            format: 'hsl'
        };
        return utils.palette.createPaletteItem(newColor, index + 1);
    });
    return utils.palette.createPaletteObject(options, paletteItems);
}
export const generatePalette = {
    analogous,
    complementary,
    diadic,
    hexadic,
    monochromatic,
    random,
    splitComplementary,
    tetradic,
    triadic
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGFsZXR0ZS9wYXJ0aWFscy90eXBlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrQ0FBa0M7QUFXbEMsT0FBTyxFQUFFLFVBQVUsSUFBSSxNQUFNLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUU1RCxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDO0FBRTNDLFNBQVMsU0FBUyxDQUNqQixPQUErQixFQUMvQixNQUFnQyxFQUNoQyxZQUFpQztJQUVqQyxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO0lBRTNCLElBQUksT0FBTyxDQUFDLFdBQVcsR0FBRyxDQUFDO1FBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFFaEUsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQ2hELE1BQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNoRSxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMzRSxNQUFNLGdCQUFnQixHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQ3pELE9BQU8sRUFDUCxZQUFZLENBQ1osQ0FBQztJQUVGLE9BQU8sZ0JBQWdCLENBQUM7QUFDekIsQ0FBQztBQUVELFNBQVMsYUFBYSxDQUNyQixPQUErQixFQUMvQixNQUFnQztJQUVoQyxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDO0lBQy9CLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDM0IsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFD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WSxDQUNuQyxJQUFJLENBQUMsR0FBRyxDQUNQLEdBQUcsRUFDSCxJQUFJLENBQUMsR0FBRyxDQUNQLENBQUMsRUFDRCxTQUFTLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxlQUFlLENBQzVDLENBQ0QsQ0FDRDtnQkFDRCxTQUFTLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQ2xDLElBQUksQ0FBQyxHQUFHLENBQ1AsR0FBRyxFQUNILElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLGNBQWMsQ0FBQyxDQUN2RCxDQUNEO2FBQ0Q7WUFDRCxNQUFNLEVBQUUsS0FBSztTQUNiLENBQUM7UUFFRixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsUUFBUSxFQUFFLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM3RCxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDakUsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBMkI7SUFDdEQsU0FBUztJQUNULGFBQWE7SUFDYixNQUFNO0lBQ04sT0FBTztJQUNQLGFBQWE7SUFDYixNQUFNO0lBQ04sa0JBQWtCO0lBQ2xCLFFBQVE7SUFDUixPQUFPO0NBQ1AsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZpbGU6IHBhbGV0dGUvcGFydGlhbHMvdHlwZXMuanNcblxuaW1wb3J0IHtcblx0Q29tbW9uRnVuY3Rpb25zSW50ZXJmYWNlLFxuXHRHZW5lcmF0ZUh1ZXNGbkdyb3VwLFxuXHRHZW5lcmF0ZVBhbGV0dGVGbkdyb3VwLFxuXHRIU0wsXG5cdFBhbGV0dGUsXG5cdFBhbGV0dGVJdGVtLFxuXHRTZWxlY3RlZFBhbGV0dGVPcHRpb25zXG59IGZyb20gJy4uLy4uL3R5cGVzL2luZGV4LmpzJztcbmltcG9ydCB7IGNvbnN0c0RhdGEgYXMgY29uc3RzIH0gZnJvbSAnLi4vLi4vZGF0YS9jb25zdHMuanMnO1xuXG5jb25zdCBwYWxldHRlUmFuZ2VzID0gY29uc3RzLnBhbGV0dGVSYW5nZXM7XG5cbmZ1bmN0aW9uIGFuYWxvZ291cyhcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNJbnRlcmZhY2UsXG5cdGdlbmVyYXRlSHVlczogR2VuZXJhdGVIdWVzRm5Hcm91cFxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHV0aWxzID0gY29tbW9uLnV0aWxzO1xuXG5cdGlmIChvcHRpb25zLmNvbHVtbkNvdW50IDwgMikgdXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcygyLCA2KTtcblxuXHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy5hbmFsb2dvdXMoYmFzZUNvbG9yLCBvcHRpb25zLCBjb21tb24pO1xuXHRjb25zdCBwYWxldHRlSXRlbXMgPSB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtQXJyYXkoYmFzZUNvbG9yLCBodWVzKTtcblx0Y29uc3QgYW5hbG9nb3VzUGFsZXR0ZSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChcblx0XHRvcHRpb25zLFxuXHRcdHBhbGV0dGVJdGVtc1xuXHQpO1xuXG5cdHJldHVybiBhbmFsb2dvdXNQYWxldHRlO1xufVxuXG5mdW5jdGlvbiBjb21wbGVtZW50YXJ5KFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9uc0ludGVyZmFjZVxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IGhlbHBlcnMgPSBjb21tb24uaGVscGVycztcblx0Y29uc3QgdXRpbHMgPSBjb21tb24udXRpbHM7XG5cdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMiwgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXG5cdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRjb25zdCBiYXNlSHVlID0gYmFzZUNvbG9yLnZhbHVlLmh1ZTtcblx0Y29uc3QgaHVlczogbnVtYmVyW10gPSBbYmFzZUh1ZV07XG5cblx0Ly8gYWx3YXlzIGluY2x1ZGUgdGhlIGRpcmVjdCBjb21wbGVtZW50XG5cdGh1ZXMucHVzaCgoYmFzZUh1ZSArIDE4MCkgJSAzNjApO1xuXG5cdC8vIGdlbmVyYXRlIGFkZGl0aW9uYWwgY29tcGxlbWVudGFyeSB2YXJpYXRpb25zIGlmIG5lZWRlZFxuXHRjb25zdCBleHRyYUNvbG9yc05lZWRlZCA9IGNvbHVtbkNvdW50IC0gMjtcblxuXHRpZiAoZXh0cmFDb2xvcnNOZWVkZWQgPiAwKSB7XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBleHRyYUNvbG9yc05lZWRlZDsgaSsrKSB7XG5cdFx0XHRjb25zdCB2YXJpYXRpb25PZmZzZXQgPSBoZWxwZXJzLnBhbGV0dGUuZ2V0V2VpZ2h0ZWRSYW5kb21JbnRlcnZhbChcblx0XHRcdFx0b3B0aW9ucy5kaXN0cmlidXRpb25UeXBlXG5cdFx0XHQpO1xuXHRcdFx0Y29uc3QgZGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IDEgOiAtMTsgLy8gcmFuZG9taXplIGRpcmVjdGlvblxuXHRcdFx0Y29uc3QgbmV3SHVlID1cblx0XHRcdFx0KGJhc2VIdWUgKyAxODAgKyB2YXJpYXRpb25PZmZzZXQgKiBkaXJlY3Rpb24gKyAzNjApICUgMzYwO1xuXHRcdFx0aHVlcy5wdXNoKG5ld0h1ZSk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gZGVmaW5lIGxpZ2h0bmVzcyAmIHNhdHVyYXRpb24gdmFyaWF0aW9uIHJhbmdlc1xuXHRjb25zdCBsaWdodG5lc3NSYW5nZSA9IFstMTAsIC01LCAwLCA1LCAxMF07IC8vIHBvc3NpYmxlIGNoYW5nZXMgaW4gbGlnaHRuZXNzXG5cdGNvbnN0IHNhdHVyYXRpb25SYW5nZSA9IFstMTUsIC0xMCwgMCwgMTAsIDE1XTsgLy8gcG9zc2libGUgY2hhbmdlcyBpbiBzYXR1cmF0aW9uXG5cblx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRjb25zdCBsaWdodG5lc3NPZmZzZXQgPVxuXHRcdFx0bGlnaHRuZXNzUmFuZ2VbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbGlnaHRuZXNzUmFuZ2UubGVuZ3RoKV07XG5cdFx0Y29uc3Qgc2F0dXJhdGlvbk9mZnNldCA9XG5cdFx0XHRzYXR1cmF0aW9uUmFuZ2VbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2F0dXJhdGlvblJhbmdlLmxlbmd0aCldO1xuXG5cdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdGh1ZTogdXRpbHMuYnJhbmQuYXNSYWRpYWwoaHVlKSxcblx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvbk9mZnNldFxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KSxcblx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heCgwLCBiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzT2Zmc2V0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KVxuXHRcdFx0fSxcblx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdH0pO1xuXG5cdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcbn1cblxuZnVuY3Rpb24gZGlhZGljKFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9uc0ludGVyZmFjZSxcblx0Z2VuZXJhdGVIdWVzOiBHZW5lcmF0ZUh1ZXNGbkdyb3VwXG4pOiBQYWxldHRlIHtcblx0Y29uc3QgaGVscGVycyA9IGNvbW1vbi5oZWxwZXJzO1xuXHRjb25zdCB1dGlscyA9IGNvbW1vbi51dGlscztcblx0Y29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heCgyLCBNYXRoLm1pbig2LCBvcHRpb25zLmNvbHVtbkNvdW50KSk7XG5cblx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgNik7XG5cblx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdGNvbnN0IGh1ZXMgPSBnZW5lcmF0ZUh1ZXMuZGlhZGljKGJhc2VDb2xvciwgb3B0aW9ucywgY29tbW9uKTtcblxuXHQvLyBpZiBtb3JlIHN3YXRjaGVzIGFyZSBuZWVkZWQsIGNyZWF0ZSBzbGlnaHQgdmFyaWF0aW9uc1xuXHRjb25zdCBleHRyYUNvbG9yc05lZWRlZCA9IGNvbHVtbkNvdW50IC0gMjtcblx0aWYgKGV4dHJhQ29sb3JzTmVlZGVkID4gMCkge1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZXh0cmFDb2xvcnNOZWVkZWQ7IGkrKykge1xuXHRcdFx0Y29uc3QgdmFyaWF0aW9uT2Zmc2V0ID0gaGVscGVycy5wYWxldHRlLmdldFdlaWdodGVkUmFuZG9tSW50ZXJ2YWwoXG5cdFx0XHRcdG9wdGlvbnMuZGlzdHJpYnV0aW9uVHlwZVxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IGRpcmVjdGlvbiA9IGkgJSAyID09PSAwID8gMSA6IC0xO1xuXG5cdFx0XHRodWVzLnB1c2goXG5cdFx0XHRcdChiYXNlQ29sb3IudmFsdWUuaHVlICsgdmFyaWF0aW9uT2Zmc2V0ICogZGlyZWN0aW9uKSAlIDM2MFxuXHRcdFx0KTtcblx0XHR9XG5cdH1cblxuXHQvLyBjcmVhdGUgUGFsZXR0ZUl0ZW0gYXJyYXkgd2l0aCBpbmNyZW1lbnRpbmcgaXRlbUlEc1xuXHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZVJhbmdlcy5zaGlmdC5kaWFkaWMuc2F0IC1cblx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLnNhdCAvIDI7XG5cdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPVxuXHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLmxpZ2h0IC1cblx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLmxpZ2h0IC8gMjtcblx0XHRjb25zdCBuZXdDb2xvcjogSFNMID0ge1xuXHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCksXG5cdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgYmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KVxuXHRcdFx0fSxcblx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdH0pO1xuXG5cdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcbn1cblxuZnVuY3Rpb24gaGV4YWRpYyhcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNJbnRlcmZhY2UsXG5cdGdlbmVyYXRlSHVlczogR2VuZXJhdGVIdWVzRm5Hcm91cFxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHV0aWxzID0gY29tbW9uLnV0aWxzO1xuXHQvLyBoZXhhZGljIHBhbGV0dGVzIGFsd2F5cyBoYXZlIDYgc3dhdGNoZXNcblx0Y29uc3QgY29sdW1uQ291bnQgPSA2O1xuXG5cdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRjb25zdCBodWVzID0gZ2VuZXJhdGVIdWVzLmhleGFkaWMoYmFzZUNvbG9yLCBjb21tb24pO1xuXG5cdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPVxuXHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuaGV4YWQuc2F0IC1cblx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuaGV4YWQuc2F0IC8gMjtcblx0XHRjb25zdCBsaWdodG5lc3NTaGlmdCA9XG5cdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZVJhbmdlcy5zaGlmdC5oZXhhZC5saWdodCAtXG5cdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LmhleGFkLmxpZ2h0IC8gMjtcblxuXHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRodWU6IHV0aWxzLmJyYW5kLmFzUmFkaWFsKGh1ZSksXG5cdFx0XHRcdHNhdHVyYXRpb246IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KSxcblx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heCgwLCBiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzU2hpZnQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHQpXG5cdFx0XHR9LFxuXHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdH07XG5cblx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgaW5kZXggKyAxKTtcblx0fSk7XG5cblx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xufVxuXG5mdW5jdGlvbiBtb25vY2hyb21hdGljKFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9uc0ludGVyZmFjZVxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHV0aWxzID0gY29tbW9uLnV0aWxzO1xuXHRjb25zdCBjb2x1bW5Db3VudCA9IE1hdGgubWF4KDIsIE1hdGgubWluKDYsIG9wdGlvbnMuY29sdW1uQ291bnQpKTtcblxuXHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW107XG5cblx0Y29uc3QgYmFzZVBhbGV0dGVJdGVtID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIDEpO1xuXHRwYWxldHRlSXRlbXMucHVzaChiYXNlUGFsZXR0ZUl0ZW0pO1xuXG5cdC8vIGdlbmVyYXRlIG1vbm9jaHJvbWF0aWMgdmFyaWF0aW9uc1xuXHRmb3IgKGxldCBpID0gMTsgaSA8IGNvbHVtbkNvdW50OyBpKyspIHtcblx0XHRjb25zdCBodWVTaGlmdCA9IE1hdGgucmFuZG9tKCkgKiAxMCAtIDU7IC8vIHNtYWxsIGh1ZSB2YXJpYXRpb25cblx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPSBNYXRoLnJhbmRvbSgpICogMTUgLSA3LjU7IC8vIHNsaWdodCBzYXR1cmF0aW9uIHNoaWZ0XG5cdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPSAoaSAtIDIpICogMTA7IC8vIGNyZWF0ZXMgYSBncmFkaWVudCBlZmZlY3RcblxuXHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRodWU6IHV0aWxzLmJyYW5kLmFzUmFkaWFsKFxuXHRcdFx0XHRcdChiYXNlQ29sb3IudmFsdWUuaHVlICsgaHVlU2hpZnQgKyAzNjApICUgMzYwXG5cdFx0XHRcdCksXG5cdFx0XHRcdHNhdHVyYXRpb246IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KSxcblx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heCgwLCBiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzU2hpZnQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHQpXG5cdFx0XHR9LFxuXHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdH07XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW0gPSB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpICsgMSk7XG5cblx0XHRwYWxldHRlSXRlbXMucHVzaChwYWxldHRlSXRlbSk7XG5cdH1cblxuXHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG59XG5cbmZ1bmN0aW9uIHJhbmRvbShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNJbnRlcmZhY2Vcbik6IFBhbGV0dGUge1xuXHRjb25zdCB1dGlscyA9IGNvbW1vbi51dGlscztcblx0Ly8gZW5zdXJlIGNvbHVtbiBjb3VudCBpcyBiZXR3ZWVuIDIgYW5kIDZcblx0Y29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heCgyLCBNYXRoLm1pbig2LCBvcHRpb25zLmNvbHVtbkNvdW50KSk7XG5cblx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgNik7XG5cblx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cblx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW107XG5cblx0Y29uc3QgYmFzZVBhbGV0dGVJdGVtID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShiYXNlQ29sb3IsIDEpO1xuXHRwYWxldHRlSXRlbXMucHVzaChiYXNlUGFsZXR0ZUl0ZW0pO1xuXG5cdGZvciAobGV0IGkgPSAxOyBpIDwgY29sdW1uQ291bnQ7IGkrKykge1xuXHRcdGNvbnN0IHJhbmRvbUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0Y29uc3QgbmV4dFBhbGV0dGVJdGVtID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShcblx0XHRcdHJhbmRvbUNvbG9yLFxuXHRcdFx0aSArIDFcblx0XHQpO1xuXG5cdFx0cGFsZXR0ZUl0ZW1zLnB1c2gobmV4dFBhbGV0dGVJdGVtKTtcblx0fVxuXG5cdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcbn1cblxuZnVuY3Rpb24gc3BsaXRDb21wbGVtZW50YXJ5KFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9uc0ludGVyZmFjZVxuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IGhlbHBlcnMgPSBjb21tb24uaGVscGVycztcblx0Y29uc3QgdXRpbHMgPSBjb21tb24udXRpbHM7XG5cdC8vIGVuc3VyZSBjb2x1bW4gY291bnQgaXMgYXQgbGVhc3QgMyBhbmQgYXQgbW9zdCA2XG5cdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMywgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0Y29uc3QgYmFzZUh1ZSA9IGJhc2VDb2xvci52YWx1ZS5odWU7XG5cblx0Ly8gZ2VuZXJhdGUgc3BsaXQgY29tcGxlbWVudGFyeSBodWVzXG5cdGNvbnN0IGh1ZXMgPSBbXG5cdFx0YmFzZUh1ZSxcblx0XHQoYmFzZUh1ZSArIDE4MCArIHBhbGV0dGVSYW5nZXMuc2hpZnQuc3BsaXRDb21wLmh1ZSkgJSAzNjAsXG5cdFx0KGJhc2VIdWUgKyAxODAgLSBwYWxldHRlUmFuZ2VzLnNoaWZ0LnNwbGl0Q29tcC5odWUgKyAzNjApICUgMzYwXG5cdF07XG5cblx0Ly8gaWYgc3dhdGNoQ291bnQgPiAzLCBpbnRyb2R1Y2UgYWRkaXRpb25hbCB2YXJpYXRpb25zXG5cdGZvciAobGV0IGkgPSAzOyBpIDwgY29sdW1uQ291bnQ7IGkrKykge1xuXHRcdGNvbnN0IHZhcmlhdGlvbk9mZnNldCA9IGhlbHBlcnMucGFsZXR0ZS5nZXRXZWlnaHRlZFJhbmRvbUludGVydmFsKFxuXHRcdFx0b3B0aW9ucy5kaXN0cmlidXRpb25UeXBlXG5cdFx0KTtcblx0XHRjb25zdCBkaXJlY3Rpb24gPSBpICUgMiA9PT0gMCA/IDEgOiAtMTtcblx0XHRodWVzLnB1c2goKGJhc2VIdWUgKyAxODAgKyB2YXJpYXRpb25PZmZzZXQgKiBkaXJlY3Rpb24pICUgMzYwKTtcblx0fVxuXG5cdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPVxuXHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuc3BsaXRDb21wLnNhdCAtXG5cdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LnNwbGl0Q29tcC5zYXQgLyAyO1xuXHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnNwbGl0Q29tcC5saWdodCAtXG5cdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LnNwbGl0Q29tcC5saWdodCAvIDI7XG5cblx0XHRjb25zdCBuZXdDb2xvcjogSFNMID0ge1xuXHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCksXG5cdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgYmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KVxuXHRcdFx0fSxcblx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdH0pO1xuXG5cdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcbn1cblxuZnVuY3Rpb24gdGV0cmFkaWMoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zSW50ZXJmYWNlLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB1dGlscyA9IGNvbW1vbi51dGlscztcblx0Ly8gdGV0cmFkaWMgcGFsZXR0ZXMgYWx3YXlzIGhhdmUgNCBzd2F0Y2hlc1xuXHRjb25zdCBjb2x1bW5Db3VudCA9IDQ7XG5cdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDQpO1xuXG5cdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXG5cdC8vIGdlbmVyYXRlIHRoZSA0IGh1ZXNcblx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy50ZXRyYWRpYyhiYXNlQ29sb3IsIGNvbW1vbik7XG5cblx0Ly8gY3JlYXRlIFBhbGV0dGVJdGVtIGFycmF5IHdpdGggYXNzaWduZWQgaXRlbUlEc1xuXHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZVJhbmdlcy5zaGlmdC50ZXRyYS5zYXQgLVxuXHRcdFx0cGFsZXR0ZVJhbmdlcy5zaGlmdC50ZXRyYS5zYXQgLyAyO1xuXHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnRldHJhLmxpZ2h0IC1cblx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQudGV0cmEubGlnaHQgLyAyO1xuXG5cdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdGh1ZTogdXRpbHMuYnJhbmQuYXNSYWRpYWwoaHVlKSxcblx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvblNoaWZ0XG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHQpLFxuXHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdClcblx0XHRcdH0sXG5cdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0fTtcblxuXHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHR9KTtcblxuXHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG59XG5cbmZ1bmN0aW9uIHRyaWFkaWMoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zSW50ZXJmYWNlLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB1dGlscyA9IGNvbW1vbi51dGlscztcblx0Ly8gdHJpYWRpYyBwYWxldHRlcyBhbHdheXMgaGF2ZSBleGFjdGx5IDMgY29sb3JzXG5cdGNvbnN0IGNvbHVtbkNvdW50ID0gMztcblx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgMyk7XG5cblx0Ly8gZ2VuZXJhdGUgdGhlIGJhc2UgY29sb3Jcblx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cblx0Ly8gZ2VuZXJhdGUgdGhlIDMgaHVlcyBuZWVkZWRcblx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy50cmlhZGljKGJhc2VDb2xvciwgY29tbW9uKTtcblxuXHQvLyBjcmVhdGUgUGFsZXR0ZUl0ZW0gYXJyYXkgd2l0aCBhc3NpZ25lZCBpdGVtSURzXG5cdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnRyaWFkLnNhdCAtXG5cdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LnRyaWFkLnNhdCAvIDI7XG5cdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPVxuXHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQudHJpYWQubGlnaHQgLVxuXHRcdFx0cGFsZXR0ZVJhbmdlcy5zaGlmdC50cmlhZC5saWdodCAvIDI7XG5cblx0XHRjb25zdCBuZXdDb2xvcjogSFNMID0ge1xuXHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCksXG5cdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgYmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KVxuXHRcdFx0fSxcblx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdH0pO1xuXG5cdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcbn1cblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUGFsZXR0ZTogR2VuZXJhdGVQYWxldHRlRm5Hcm91cCA9IHtcblx0YW5hbG9nb3VzLFxuXHRjb21wbGVtZW50YXJ5LFxuXHRkaWFkaWMsXG5cdGhleGFkaWMsXG5cdG1vbm9jaHJvbWF0aWMsXG5cdHJhbmRvbSxcblx0c3BsaXRDb21wbGVtZW50YXJ5LFxuXHR0ZXRyYWRpYyxcblx0dHJpYWRpY1xufTtcbiJdfQ==