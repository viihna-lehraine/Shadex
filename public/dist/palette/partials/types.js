// File: palette/partials/types.js
import { data } from '../../config/index.js';
const paletteRanges = data.config.paletteRanges;
function analogous(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    try {
        if (options.columnCount < 2)
            utils.dom.enforceSwatchRules(2, 6);
        const baseColor = utils.app.generateRandomHSL();
        const hues = generateHues.analogous(baseColor, options, common);
        const paletteItems = utils.palette.createPaletteItemArray(baseColor, hues);
        const analogousPalette = utils.palette.createPaletteObject(options, paletteItems);
        return analogousPalette;
    }
    catch (error) {
        errors.handle(error, 'Error generating analogous palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function complementary(options, common) {
    const { helpers, services: { errors }, utils } = common;
    try {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const baseHue = baseColor.value.hue;
        const hues = [baseHue];
        // always include the direct complement
        hues.push((baseHue + 180) % 360);
        // generate additional complementary variations if needed
        const extraColorsNeeded = columnCount - 2;
        if (extraColorsNeeded > 0) {
            for (let i = 0; i < extraColorsNeeded; i++) {
                const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
                const direction = Math.random() < 0.5 ? 1 : -1; // randomize direction
                const newHue = (baseHue + 180 + variationOffset * direction + 360) % 360;
                hues.push(newHue);
            }
        }
        // define lightness & saturation variation ranges
        const lightnessRange = [-10, -5, 0, 5, 10]; // possible changes in lightness
        const saturationRange = [-15, -10, 0, 10, 15]; // possible changes in saturation
        const paletteItems = hues.map((hue, index) => {
            const lightnessOffset = lightnessRange[Math.floor(Math.random() * lightnessRange.length)];
            const saturationOffset = saturationRange[Math.floor(Math.random() * saturationRange.length)];
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationOffset))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessOffset)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating complementary palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function diadic(options, common, generateHues) {
    const { helpers, services: { errors }, utils } = common;
    try {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const hues = generateHues.diadic(baseColor, options, common);
        // if more swatches are needed, create slight variations
        const extraColorsNeeded = columnCount - 2;
        if (extraColorsNeeded > 0) {
            for (let i = 0; i < extraColorsNeeded; i++) {
                const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
                const direction = i % 2 === 0 ? 1 : -1;
                hues.push((baseColor.value.hue + variationOffset * direction) % 360);
            }
        }
        // create PaletteItem array with incrementing itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteRanges.shift.diadic.sat -
                paletteRanges.shift.diadic.sat / 2;
            const lightnessShift = Math.random() * paletteRanges.shift.diadic.light -
                paletteRanges.shift.diadic.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating diadic palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function hexadic(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    try {
        // hexadic palettes always have 6 swatches
        const columnCount = 6;
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const hues = generateHues.hexadic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteRanges.shift.hexad.sat -
                paletteRanges.shift.hexad.sat / 2;
            const lightnessShift = Math.random() * paletteRanges.shift.hexad.light -
                paletteRanges.shift.hexad.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating hexadic palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function monochromatic(options, common) {
    const { services: { errors }, utils } = common;
    try {
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const paletteItems = [];
        const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
        paletteItems.push(basePaletteItem);
        // generate monochromatic variations
        for (let i = 1; i < columnCount; i++) {
            const hueShift = Math.random() * 10 - 5; // small hue variation
            const saturationShift = Math.random() * 15 - 7.5; // slight saturation shift
            const lightnessShift = (i - 2) * 10; // creates a gradient effect
            const newColor = {
                value: {
                    hue: utils.brand.asRadial((baseColor.value.hue + hueShift + 360) % 360),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            const paletteItem = utils.palette.createPaletteItem(newColor, i + 1);
            paletteItems.push(paletteItem);
        }
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating monochromatic palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function random(options, common) {
    const { services: { errors }, utils } = common;
    try {
        // ensure column count is between 2 and 6
        const columnCount = Math.max(2, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const paletteItems = [];
        const basePaletteItem = utils.palette.createPaletteItem(baseColor, 1);
        paletteItems.push(basePaletteItem);
        for (let i = 1; i < columnCount; i++) {
            const randomColor = utils.app.generateRandomHSL();
            const nextPaletteItem = utils.palette.createPaletteItem(randomColor, i + 1);
            paletteItems.push(nextPaletteItem);
        }
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating random palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function splitComplementary(options, common) {
    const { helpers, services: { errors }, utils } = common;
    try {
        // ensure column count is at least 3 and at most 6
        const columnCount = Math.max(3, Math.min(6, options.columnCount));
        utils.dom.enforceSwatchRules(columnCount, 6);
        const baseColor = utils.app.generateRandomHSL();
        const baseHue = baseColor.value.hue;
        // generate split complementary hues
        const hues = [
            baseHue,
            (baseHue + 180 + paletteRanges.shift.splitComp.hue) % 360,
            (baseHue + 180 - paletteRanges.shift.splitComp.hue + 360) % 360
        ];
        // if swatchCount > 3, introduce additional variations
        for (let i = 3; i < columnCount; i++) {
            const variationOffset = helpers.palette.getWeightedRandomInterval(options.distributionType);
            const direction = i % 2 === 0 ? 1 : -1;
            hues.push((baseHue + 180 + variationOffset * direction) % 360);
        }
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteRanges.shift.splitComp.sat -
                paletteRanges.shift.splitComp.sat / 2;
            const lightnessShift = Math.random() * paletteRanges.shift.splitComp.light -
                paletteRanges.shift.splitComp.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating split-complementary palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function tetradic(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    try {
        // tetradic palettes always have 4 swatches
        const columnCount = 4;
        utils.dom.enforceSwatchRules(columnCount, 4);
        const baseColor = utils.app.generateRandomHSL();
        // generate the 4 hues
        const hues = generateHues.tetradic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteRanges.shift.tetra.sat -
                paletteRanges.shift.tetra.sat / 2;
            const lightnessShift = Math.random() * paletteRanges.shift.tetra.light -
                paletteRanges.shift.tetra.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating tetradic palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
function triadic(options, common, generateHues) {
    const { services: { errors }, utils } = common;
    try {
        // triadic palettes always have exactly 3 colors
        const columnCount = 3;
        utils.dom.enforceSwatchRules(columnCount, 3);
        // generate the base color
        const baseColor = utils.app.generateRandomHSL();
        // generate the 3 hues needed
        const hues = generateHues.triadic(baseColor, common);
        // create PaletteItem array with assigned itemIDs
        const paletteItems = hues.map((hue, index) => {
            const saturationShift = Math.random() * paletteRanges.shift.triad.sat -
                paletteRanges.shift.triad.sat / 2;
            const lightnessShift = Math.random() * paletteRanges.shift.triad.light -
                paletteRanges.shift.triad.light / 2;
            const newColor = {
                value: {
                    hue: utils.brand.asRadial(hue),
                    saturation: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.saturation + saturationShift))),
                    lightness: utils.brand.asPercentile(Math.min(100, Math.max(0, baseColor.value.lightness + lightnessShift)))
                },
                format: 'hsl'
            };
            return utils.palette.createPaletteItem(newColor, index + 1);
        });
        return utils.palette.createPaletteObject(options, paletteItems);
    }
    catch (error) {
        errors.handle(error, 'Error generating triadic palette. Returning default.', { options: options });
        return data.defaults.palette;
    }
}
export const generatePaletteFnGroup = {
    analogous,
    complementary,
    diadic,
    hexadic,
    monochromatic,
    random,
    splitComplementary,
    tetradic,
    triadic
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGFsZXR0ZS9wYXJ0aWFscy90eXBlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrQ0FBa0M7QUFXbEMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRTdDLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDO0FBRWhELFNBQVMsU0FBUyxDQUNqQixPQUErQixFQUMvQixNQUF1QixFQUN2QixZQUFpQztJQUVqQyxNQUFNLEVBQ0wsUUFBUSxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQ3BCLEtBQUssRUFDTCxHQUFHLE1BQU0sQ0FBQztJQUVYLElBQUksQ0FBQztRQUNKLElBQUksT0FBTyxDQUFDLFdBQVcsR0FBRyxDQUFDO1lBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFaEUsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ2hELE1BQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNoRSxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUN4RCxTQUFTLEVBQ1QsSUFBSSxDQUNKLENBQUM7UUFDRixNQUFNLGdCQUFnQixHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQ3pELE9BQU8sRUFDUCxZQUFZLENBQ1osQ0FBQztRQUVGLE9BQU8sZ0JBQWdCLENBQUM7SUFDekIsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDaEIsTUFBTSxDQUFDLE1BQU0sQ0FDWixLQUFLLEVBQ0wsd0RBQXdELEVBQ3hELEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUNwQixD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LENBQUMsVUFBVSxHQUFHLGVBQWUsQ0FDNUMsQ0FDRCxDQUNEO29CQUNELFNBQVMsRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FDbEMsSUFBSSxDQUFDLEdBQUcsQ0FDUCxHQUFHLEVBQ0gsSUFBSSxDQUFDLEdBQUcsQ0FDUCxDQUFDLEVBQ0QsU0FBUyxDQUFDLEtBQUssQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUMxQyxDQUNELENBQ0Q7aUJBQ0Q7Z0JBQ0QsTUFBTSxFQUFFLEtBQUs7YUFDYixDQUFDO1lBRUYsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2hCLE1BQU0sQ0FBQyxNQUFNLENBQ1osS0FBSyxFQUNMLHNEQUFzRCxFQUN0RCxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FDcEIsQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7SUFDOUIsQ0FBQztBQUNGLENBQUM7QUFFRCxNQUFNLENBQUMsTUFBTSxzQkFBc0IsR0FBMkI7SUFDN0QsU0FBUztJQUNULGFBQWE7SUFDYixNQUFNO0lBQ04sT0FBTztJQUNQLGFBQWE7SUFDYixNQUFNO0lBQ04sa0JBQWtCO0lBQ2xCLFFBQVE7SUFDUixPQUFPO0NBQ1AsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZpbGU6IHBhbGV0dGUvcGFydGlhbHMvdHlwZXMuanNcblxuaW1wb3J0IHtcblx0Q29tbW9uRnVuY3Rpb25zLFxuXHRHZW5lcmF0ZUh1ZXNGbkdyb3VwLFxuXHRHZW5lcmF0ZVBhbGV0dGVGbkdyb3VwLFxuXHRIU0wsXG5cdFBhbGV0dGUsXG5cdFBhbGV0dGVJdGVtLFxuXHRTZWxlY3RlZFBhbGV0dGVPcHRpb25zXG59IGZyb20gJy4uLy4uL3R5cGVzL2luZGV4LmpzJztcbmltcG9ydCB7IGRhdGEgfSBmcm9tICcuLi8uLi9jb25maWcvaW5kZXguanMnO1xuXG5jb25zdCBwYWxldHRlUmFuZ2VzID0gZGF0YS5jb25maWcucGFsZXR0ZVJhbmdlcztcblxuZnVuY3Rpb24gYW5hbG9nb3VzKFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9ucyxcblx0Z2VuZXJhdGVIdWVzOiBHZW5lcmF0ZUh1ZXNGbkdyb3VwXG4pOiBQYWxldHRlIHtcblx0Y29uc3Qge1xuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9LFxuXHRcdHV0aWxzXG5cdH0gPSBjb21tb247XG5cblx0dHJ5IHtcblx0XHRpZiAob3B0aW9ucy5jb2x1bW5Db3VudCA8IDIpIHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoMiwgNik7XG5cblx0XHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0XHRjb25zdCBodWVzID0gZ2VuZXJhdGVIdWVzLmFuYWxvZ291cyhiYXNlQ29sb3IsIG9wdGlvbnMsIGNvbW1vbik7XG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbUFycmF5KFxuXHRcdFx0YmFzZUNvbG9yLFxuXHRcdFx0aHVlc1xuXHRcdCk7XG5cdFx0Y29uc3QgYW5hbG9nb3VzUGFsZXR0ZSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChcblx0XHRcdG9wdGlvbnMsXG5cdFx0XHRwYWxldHRlSXRlbXNcblx0XHQpO1xuXG5cdFx0cmV0dXJuIGFuYWxvZ291c1BhbGV0dGU7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0ZXJyb3JzLmhhbmRsZShcblx0XHRcdGVycm9yLFxuXHRcdFx0J0Vycm9yIGdlbmVyYXRpbmcgYW5hbG9nb3VzIHBhbGV0dGUuIFJldHVybmluZyBkZWZhdWx0LicsXG5cdFx0XHR7IG9wdGlvbnM6IG9wdGlvbnMgfVxuXHRcdCk7XG5cdFx0cmV0dXJuIGRhdGEuZGVmYXVsdHMucGFsZXR0ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBjb21wbGVtZW50YXJ5KFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9uc1xuKTogUGFsZXR0ZSB7XG5cdGNvbnN0IHtcblx0XHRoZWxwZXJzLFxuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9LFxuXHRcdHV0aWxzXG5cdH0gPSBjb21tb247XG5cblx0dHJ5IHtcblx0XHRjb25zdCBjb2x1bW5Db3VudCA9IE1hdGgubWF4KDIsIE1hdGgubWluKDYsIG9wdGlvbnMuY29sdW1uQ291bnQpKTtcblxuXHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0Y29uc3QgYmFzZUh1ZSA9IGJhc2VDb2xvci52YWx1ZS5odWU7XG5cdFx0Y29uc3QgaHVlczogbnVtYmVyW10gPSBbYmFzZUh1ZV07XG5cblx0XHQvLyBhbHdheXMgaW5jbHVkZSB0aGUgZGlyZWN0IGNvbXBsZW1lbnRcblx0XHRodWVzLnB1c2goKGJhc2VIdWUgKyAxODApICUgMzYwKTtcblxuXHRcdC8vIGdlbmVyYXRlIGFkZGl0aW9uYWwgY29tcGxlbWVudGFyeSB2YXJpYXRpb25zIGlmIG5lZWRlZFxuXHRcdGNvbnN0IGV4dHJhQ29sb3JzTmVlZGVkID0gY29sdW1uQ291bnQgLSAyO1xuXG5cdFx0aWYgKGV4dHJhQ29sb3JzTmVlZGVkID4gMCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBleHRyYUNvbG9yc05lZWRlZDsgaSsrKSB7XG5cdFx0XHRcdGNvbnN0IHZhcmlhdGlvbk9mZnNldCA9XG5cdFx0XHRcdFx0aGVscGVycy5wYWxldHRlLmdldFdlaWdodGVkUmFuZG9tSW50ZXJ2YWwoXG5cdFx0XHRcdFx0XHRvcHRpb25zLmRpc3RyaWJ1dGlvblR5cGVcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMSA6IC0xOyAvLyByYW5kb21pemUgZGlyZWN0aW9uXG5cdFx0XHRcdGNvbnN0IG5ld0h1ZSA9XG5cdFx0XHRcdFx0KGJhc2VIdWUgKyAxODAgKyB2YXJpYXRpb25PZmZzZXQgKiBkaXJlY3Rpb24gKyAzNjApICUgMzYwO1xuXHRcdFx0XHRodWVzLnB1c2gobmV3SHVlKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBkZWZpbmUgbGlnaHRuZXNzICYgc2F0dXJhdGlvbiB2YXJpYXRpb24gcmFuZ2VzXG5cdFx0Y29uc3QgbGlnaHRuZXNzUmFuZ2UgPSBbLTEwLCAtNSwgMCwgNSwgMTBdOyAvLyBwb3NzaWJsZSBjaGFuZ2VzIGluIGxpZ2h0bmVzc1xuXHRcdGNvbnN0IHNhdHVyYXRpb25SYW5nZSA9IFstMTUsIC0xMCwgMCwgMTAsIDE1XTsgLy8gcG9zc2libGUgY2hhbmdlcyBpbiBzYXR1cmF0aW9uXG5cblx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgbGlnaHRuZXNzT2Zmc2V0ID1cblx0XHRcdFx0bGlnaHRuZXNzUmFuZ2VbXG5cdFx0XHRcdFx0TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbGlnaHRuZXNzUmFuZ2UubGVuZ3RoKVxuXHRcdFx0XHRdO1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvbk9mZnNldCA9XG5cdFx0XHRcdHNhdHVyYXRpb25SYW5nZVtcblx0XHRcdFx0XHRNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzYXR1cmF0aW9uUmFuZ2UubGVuZ3RoKVxuXHRcdFx0XHRdO1xuXG5cdFx0XHRjb25zdCBuZXdDb2xvcjogSFNMID0ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZTogdXRpbHMuYnJhbmQuYXNSYWRpYWwoaHVlKSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvbk9mZnNldFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc09mZnNldFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgaW5kZXggKyAxKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRlcnJvcnMuaGFuZGxlKFxuXHRcdFx0ZXJyb3IsXG5cdFx0XHQnRXJyb3IgZ2VuZXJhdGluZyBjb21wbGVtZW50YXJ5IHBhbGV0dGUuIFJldHVybmluZyBkZWZhdWx0LicsXG5cdFx0XHR7IG9wdGlvbnM6IG9wdGlvbnMgfVxuXHRcdCk7XG5cdFx0cmV0dXJuIGRhdGEuZGVmYXVsdHMucGFsZXR0ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBkaWFkaWMoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0aGVscGVycyxcblx0XHRzZXJ2aWNlczogeyBlcnJvcnMgfSxcblx0XHR1dGlsc1xuXHR9ID0gY29tbW9uO1xuXG5cdHRyeSB7XG5cdFx0Y29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heCgyLCBNYXRoLm1pbig2LCBvcHRpb25zLmNvbHVtbkNvdW50KSk7XG5cblx0XHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXHRcdGNvbnN0IGh1ZXMgPSBnZW5lcmF0ZUh1ZXMuZGlhZGljKGJhc2VDb2xvciwgb3B0aW9ucywgY29tbW9uKTtcblxuXHRcdC8vIGlmIG1vcmUgc3dhdGNoZXMgYXJlIG5lZWRlZCwgY3JlYXRlIHNsaWdodCB2YXJpYXRpb25zXG5cdFx0Y29uc3QgZXh0cmFDb2xvcnNOZWVkZWQgPSBjb2x1bW5Db3VudCAtIDI7XG5cdFx0aWYgKGV4dHJhQ29sb3JzTmVlZGVkID4gMCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBleHRyYUNvbG9yc05lZWRlZDsgaSsrKSB7XG5cdFx0XHRcdGNvbnN0IHZhcmlhdGlvbk9mZnNldCA9XG5cdFx0XHRcdFx0aGVscGVycy5wYWxldHRlLmdldFdlaWdodGVkUmFuZG9tSW50ZXJ2YWwoXG5cdFx0XHRcdFx0XHRvcHRpb25zLmRpc3RyaWJ1dGlvblR5cGVcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRjb25zdCBkaXJlY3Rpb24gPSBpICUgMiA9PT0gMCA/IDEgOiAtMTtcblxuXHRcdFx0XHRodWVzLnB1c2goXG5cdFx0XHRcdFx0KGJhc2VDb2xvci52YWx1ZS5odWUgKyB2YXJpYXRpb25PZmZzZXQgKiBkaXJlY3Rpb24pICUgMzYwXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gY3JlYXRlIFBhbGV0dGVJdGVtIGFycmF5IHdpdGggaW5jcmVtZW50aW5nIGl0ZW1JRHNcblx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLnNhdCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLnNhdCAvIDI7XG5cdFx0XHRjb25zdCBsaWdodG5lc3NTaGlmdCA9XG5cdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LmRpYWRpYy5saWdodCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuZGlhZGljLmxpZ2h0IC8gMjtcblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdHNhdHVyYXRpb246IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgaW5kZXggKyAxKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRlcnJvcnMuaGFuZGxlKFxuXHRcdFx0ZXJyb3IsXG5cdFx0XHQnRXJyb3IgZ2VuZXJhdGluZyBkaWFkaWMgcGFsZXR0ZS4gUmV0dXJuaW5nIGRlZmF1bHQuJyxcblx0XHRcdHsgb3B0aW9uczogb3B0aW9ucyB9XG5cdFx0KTtcblx0XHRyZXR1cm4gZGF0YS5kZWZhdWx0cy5wYWxldHRlO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGhleGFkaWMoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zLFxuXHRnZW5lcmF0ZUh1ZXM6IEdlbmVyYXRlSHVlc0ZuR3JvdXBcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHR0cnkge1xuXHRcdC8vIGhleGFkaWMgcGFsZXR0ZXMgYWx3YXlzIGhhdmUgNiBzd2F0Y2hlc1xuXHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gNjtcblxuXHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy5oZXhhZGljKGJhc2VDb2xvciwgY29tbW9uKTtcblxuXHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuaGV4YWQuc2F0IC1cblx0XHRcdFx0cGFsZXR0ZVJhbmdlcy5zaGlmdC5oZXhhZC5zYXQgLyAyO1xuXHRcdFx0Y29uc3QgbGlnaHRuZXNzU2hpZnQgPVxuXHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZVJhbmdlcy5zaGlmdC5oZXhhZC5saWdodCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuaGV4YWQubGlnaHQgLyAyO1xuXG5cdFx0XHRjb25zdCBuZXdDb2xvcjogSFNMID0ge1xuXHRcdFx0XHR2YWx1ZToge1xuXHRcdFx0XHRcdGh1ZTogdXRpbHMuYnJhbmQuYXNSYWRpYWwoaHVlKSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvblNoaWZ0XG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzU2hpZnRcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0fTtcblxuXHRcdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0obmV3Q29sb3IsIGluZGV4ICsgMSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0ZXJyb3JzLmhhbmRsZShcblx0XHRcdGVycm9yLFxuXHRcdFx0J0Vycm9yIGdlbmVyYXRpbmcgaGV4YWRpYyBwYWxldHRlLiBSZXR1cm5pbmcgZGVmYXVsdC4nLFxuXHRcdFx0eyBvcHRpb25zOiBvcHRpb25zIH1cblx0XHQpO1xuXHRcdHJldHVybiBkYXRhLmRlZmF1bHRzLnBhbGV0dGU7XG5cdH1cbn1cblxuZnVuY3Rpb24gbW9ub2Nocm9tYXRpYyhcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHR0cnkge1xuXHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMiwgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXG5cdFx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgNik7XG5cblx0XHRjb25zdCBiYXNlQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0XHRjb25zdCBwYWxldHRlSXRlbXM6IFBhbGV0dGVJdGVtW10gPSBbXTtcblxuXHRcdGNvbnN0IGJhc2VQYWxldHRlSXRlbSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0oYmFzZUNvbG9yLCAxKTtcblx0XHRwYWxldHRlSXRlbXMucHVzaChiYXNlUGFsZXR0ZUl0ZW0pO1xuXG5cdFx0Ly8gZ2VuZXJhdGUgbW9ub2Nocm9tYXRpYyB2YXJpYXRpb25zXG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCBjb2x1bW5Db3VudDsgaSsrKSB7XG5cdFx0XHRjb25zdCBodWVTaGlmdCA9IE1hdGgucmFuZG9tKCkgKiAxMCAtIDU7IC8vIHNtYWxsIGh1ZSB2YXJpYXRpb25cblx0XHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9IE1hdGgucmFuZG9tKCkgKiAxNSAtIDcuNTsgLy8gc2xpZ2h0IHNhdHVyYXRpb24gc2hpZnRcblx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID0gKGkgLSAyKSAqIDEwOyAvLyBjcmVhdGVzIGEgZ3JhZGllbnQgZWZmZWN0XG5cblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChcblx0XHRcdFx0XHRcdChiYXNlQ29sb3IudmFsdWUuaHVlICsgaHVlU2hpZnQgKyAzNjApICUgMzYwXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRzYXR1cmF0aW9uOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5zYXR1cmF0aW9uICsgc2F0dXJhdGlvblNoaWZ0XG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdGxpZ2h0bmVzczogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUubGlnaHRuZXNzICsgbGlnaHRuZXNzU2hpZnRcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdClcblx0XHRcdFx0fSxcblx0XHRcdFx0Zm9ybWF0OiAnaHNsJ1xuXHRcdFx0fTtcblx0XHRcdGNvbnN0IHBhbGV0dGVJdGVtID0gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShcblx0XHRcdFx0bmV3Q29sb3IsXG5cdFx0XHRcdGkgKyAxXG5cdFx0XHQpO1xuXG5cdFx0XHRwYWxldHRlSXRlbXMucHVzaChwYWxldHRlSXRlbSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGVycm9ycy5oYW5kbGUoXG5cdFx0XHRlcnJvcixcblx0XHRcdCdFcnJvciBnZW5lcmF0aW5nIG1vbm9jaHJvbWF0aWMgcGFsZXR0ZS4gUmV0dXJuaW5nIGRlZmF1bHQuJyxcblx0XHRcdHsgb3B0aW9uczogb3B0aW9ucyB9XG5cdFx0KTtcblx0XHRyZXR1cm4gZGF0YS5kZWZhdWx0cy5wYWxldHRlO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHJhbmRvbShcblx0b3B0aW9uczogU2VsZWN0ZWRQYWxldHRlT3B0aW9ucyxcblx0Y29tbW9uOiBDb21tb25GdW5jdGlvbnNcbik6IFBhbGV0dGUge1xuXHRjb25zdCB7XG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblxuXHR0cnkge1xuXHRcdC8vIGVuc3VyZSBjb2x1bW4gY291bnQgaXMgYmV0d2VlbiAyIGFuZCA2XG5cdFx0Y29uc3QgY29sdW1uQ291bnQgPSBNYXRoLm1heCgyLCBNYXRoLm1pbig2LCBvcHRpb25zLmNvbHVtbkNvdW50KSk7XG5cblx0XHR1dGlscy5kb20uZW5mb3JjZVN3YXRjaFJ1bGVzKGNvbHVtbkNvdW50LCA2KTtcblxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zOiBQYWxldHRlSXRlbVtdID0gW107XG5cblx0XHRjb25zdCBiYXNlUGFsZXR0ZUl0ZW0gPSB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKGJhc2VDb2xvciwgMSk7XG5cdFx0cGFsZXR0ZUl0ZW1zLnB1c2goYmFzZVBhbGV0dGVJdGVtKTtcblxuXHRcdGZvciAobGV0IGkgPSAxOyBpIDwgY29sdW1uQ291bnQ7IGkrKykge1xuXHRcdFx0Y29uc3QgcmFuZG9tQ29sb3IgPSB1dGlscy5hcHAuZ2VuZXJhdGVSYW5kb21IU0woKTtcblx0XHRcdGNvbnN0IG5leHRQYWxldHRlSXRlbSA9IHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZUl0ZW0oXG5cdFx0XHRcdHJhbmRvbUNvbG9yLFxuXHRcdFx0XHRpICsgMVxuXHRcdFx0KTtcblxuXHRcdFx0cGFsZXR0ZUl0ZW1zLnB1c2gobmV4dFBhbGV0dGVJdGVtKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlT2JqZWN0KG9wdGlvbnMsIHBhbGV0dGVJdGVtcyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0ZXJyb3JzLmhhbmRsZShcblx0XHRcdGVycm9yLFxuXHRcdFx0J0Vycm9yIGdlbmVyYXRpbmcgcmFuZG9tIHBhbGV0dGUuIFJldHVybmluZyBkZWZhdWx0LicsXG5cdFx0XHR7IG9wdGlvbnM6IG9wdGlvbnMgfVxuXHRcdCk7XG5cdFx0cmV0dXJuIGRhdGEuZGVmYXVsdHMucGFsZXR0ZTtcblx0fVxufVxuXG5mdW5jdGlvbiBzcGxpdENvbXBsZW1lbnRhcnkoXG5cdG9wdGlvbnM6IFNlbGVjdGVkUGFsZXR0ZU9wdGlvbnMsXG5cdGNvbW1vbjogQ29tbW9uRnVuY3Rpb25zXG4pOiBQYWxldHRlIHtcblx0Y29uc3Qge1xuXHRcdGhlbHBlcnMsXG5cdFx0c2VydmljZXM6IHsgZXJyb3JzIH0sXG5cdFx0dXRpbHNcblx0fSA9IGNvbW1vbjtcblx0dHJ5IHtcblx0XHQvLyBlbnN1cmUgY29sdW1uIGNvdW50IGlzIGF0IGxlYXN0IDMgYW5kIGF0IG1vc3QgNlxuXHRcdGNvbnN0IGNvbHVtbkNvdW50ID0gTWF0aC5tYXgoMywgTWF0aC5taW4oNiwgb3B0aW9ucy5jb2x1bW5Db3VudCkpO1xuXHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDYpO1xuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cdFx0Y29uc3QgYmFzZUh1ZSA9IGJhc2VDb2xvci52YWx1ZS5odWU7XG5cblx0XHQvLyBnZW5lcmF0ZSBzcGxpdCBjb21wbGVtZW50YXJ5IGh1ZXNcblx0XHRjb25zdCBodWVzID0gW1xuXHRcdFx0YmFzZUh1ZSxcblx0XHRcdChiYXNlSHVlICsgMTgwICsgcGFsZXR0ZVJhbmdlcy5zaGlmdC5zcGxpdENvbXAuaHVlKSAlIDM2MCxcblx0XHRcdChiYXNlSHVlICsgMTgwIC0gcGFsZXR0ZVJhbmdlcy5zaGlmdC5zcGxpdENvbXAuaHVlICsgMzYwKSAlIDM2MFxuXHRcdF07XG5cblx0XHQvLyBpZiBzd2F0Y2hDb3VudCA+IDMsIGludHJvZHVjZSBhZGRpdGlvbmFsIHZhcmlhdGlvbnNcblx0XHRmb3IgKGxldCBpID0gMzsgaSA8IGNvbHVtbkNvdW50OyBpKyspIHtcblx0XHRcdGNvbnN0IHZhcmlhdGlvbk9mZnNldCA9IGhlbHBlcnMucGFsZXR0ZS5nZXRXZWlnaHRlZFJhbmRvbUludGVydmFsKFxuXHRcdFx0XHRvcHRpb25zLmRpc3RyaWJ1dGlvblR5cGVcblx0XHRcdCk7XG5cdFx0XHRjb25zdCBkaXJlY3Rpb24gPSBpICUgMiA9PT0gMCA/IDEgOiAtMTtcblx0XHRcdGh1ZXMucHVzaCgoYmFzZUh1ZSArIDE4MCArIHZhcmlhdGlvbk9mZnNldCAqIGRpcmVjdGlvbikgJSAzNjApO1xuXHRcdH1cblxuXHRcdC8vIGNyZWF0ZSBQYWxldHRlSXRlbSBhcnJheSB3aXRoIGFzc2lnbmVkIGl0ZW1JRHNcblx0XHRjb25zdCBwYWxldHRlSXRlbXMgPSBodWVzLm1hcCgoaHVlLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3Qgc2F0dXJhdGlvblNoaWZ0ID1cblx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQuc3BsaXRDb21wLnNhdCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuc3BsaXRDb21wLnNhdCAvIDI7XG5cdFx0XHRjb25zdCBsaWdodG5lc3NTaGlmdCA9XG5cdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnNwbGl0Q29tcC5saWdodCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQuc3BsaXRDb21wLmxpZ2h0IC8gMjtcblxuXHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRodWU6IHV0aWxzLmJyYW5kLmFzUmFkaWFsKGh1ZSksXG5cdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0XG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdH07XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGVycm9ycy5oYW5kbGUoXG5cdFx0XHRlcnJvcixcblx0XHRcdCdFcnJvciBnZW5lcmF0aW5nIHNwbGl0LWNvbXBsZW1lbnRhcnkgcGFsZXR0ZS4gUmV0dXJuaW5nIGRlZmF1bHQuJyxcblx0XHRcdHsgb3B0aW9uczogb3B0aW9ucyB9XG5cdFx0KTtcblx0XHRyZXR1cm4gZGF0YS5kZWZhdWx0cy5wYWxldHRlO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHRldHJhZGljKFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9ucyxcblx0Z2VuZXJhdGVIdWVzOiBHZW5lcmF0ZUh1ZXNGbkdyb3VwXG4pOiBQYWxldHRlIHtcblx0Y29uc3Qge1xuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9LFxuXHRcdHV0aWxzXG5cdH0gPSBjb21tb247XG5cblx0dHJ5IHtcblx0XHQvLyB0ZXRyYWRpYyBwYWxldHRlcyBhbHdheXMgaGF2ZSA0IHN3YXRjaGVzXG5cdFx0Y29uc3QgY29sdW1uQ291bnQgPSA0O1xuXHRcdHV0aWxzLmRvbS5lbmZvcmNlU3dhdGNoUnVsZXMoY29sdW1uQ291bnQsIDQpO1xuXG5cdFx0Y29uc3QgYmFzZUNvbG9yID0gdXRpbHMuYXBwLmdlbmVyYXRlUmFuZG9tSFNMKCk7XG5cblx0XHQvLyBnZW5lcmF0ZSB0aGUgNCBodWVzXG5cdFx0Y29uc3QgaHVlcyA9IGdlbmVyYXRlSHVlcy50ZXRyYWRpYyhiYXNlQ29sb3IsIGNvbW1vbik7XG5cblx0XHQvLyBjcmVhdGUgUGFsZXR0ZUl0ZW0gYXJyYXkgd2l0aCBhc3NpZ25lZCBpdGVtSURzXG5cdFx0Y29uc3QgcGFsZXR0ZUl0ZW1zID0gaHVlcy5tYXAoKGh1ZSwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IHNhdHVyYXRpb25TaGlmdCA9XG5cdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnRldHJhLnNhdCAtXG5cdFx0XHRcdHBhbGV0dGVSYW5nZXMuc2hpZnQudGV0cmEuc2F0IC8gMjtcblx0XHRcdGNvbnN0IGxpZ2h0bmVzc1NoaWZ0ID1cblx0XHRcdFx0TWF0aC5yYW5kb20oKSAqIHBhbGV0dGVSYW5nZXMuc2hpZnQudGV0cmEubGlnaHQgLVxuXHRcdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LnRldHJhLmxpZ2h0IC8gMjtcblxuXHRcdFx0Y29uc3QgbmV3Q29sb3I6IEhTTCA9IHtcblx0XHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0XHRodWU6IHV0aWxzLmJyYW5kLmFzUmFkaWFsKGh1ZSksXG5cdFx0XHRcdFx0c2F0dXJhdGlvbjogdXRpbHMuYnJhbmQuYXNQZXJjZW50aWxlKFxuXHRcdFx0XHRcdFx0TWF0aC5taW4oXG5cdFx0XHRcdFx0XHRcdDEwMCxcblx0XHRcdFx0XHRcdFx0TWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0XHRcdFx0XHRiYXNlQ29sb3IudmFsdWUuc2F0dXJhdGlvbiArIHNhdHVyYXRpb25TaGlmdFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRsaWdodG5lc3M6IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLmxpZ2h0bmVzcyArIGxpZ2h0bmVzc1NoaWZ0XG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZvcm1hdDogJ2hzbCdcblx0XHRcdH07XG5cblx0XHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVJdGVtKG5ld0NvbG9yLCBpbmRleCArIDEpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHV0aWxzLnBhbGV0dGUuY3JlYXRlUGFsZXR0ZU9iamVjdChvcHRpb25zLCBwYWxldHRlSXRlbXMpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGVycm9ycy5oYW5kbGUoXG5cdFx0XHRlcnJvcixcblx0XHRcdCdFcnJvciBnZW5lcmF0aW5nIHRldHJhZGljIHBhbGV0dGUuIFJldHVybmluZyBkZWZhdWx0LicsXG5cdFx0XHR7IG9wdGlvbnM6IG9wdGlvbnMgfVxuXHRcdCk7XG5cdFx0cmV0dXJuIGRhdGEuZGVmYXVsdHMucGFsZXR0ZTtcblx0fVxufVxuXG5mdW5jdGlvbiB0cmlhZGljKFxuXHRvcHRpb25zOiBTZWxlY3RlZFBhbGV0dGVPcHRpb25zLFxuXHRjb21tb246IENvbW1vbkZ1bmN0aW9ucyxcblx0Z2VuZXJhdGVIdWVzOiBHZW5lcmF0ZUh1ZXNGbkdyb3VwXG4pOiBQYWxldHRlIHtcblx0Y29uc3Qge1xuXHRcdHNlcnZpY2VzOiB7IGVycm9ycyB9LFxuXHRcdHV0aWxzXG5cdH0gPSBjb21tb247XG5cblx0dHJ5IHtcblx0XHQvLyB0cmlhZGljIHBhbGV0dGVzIGFsd2F5cyBoYXZlIGV4YWN0bHkgMyBjb2xvcnNcblx0XHRjb25zdCBjb2x1bW5Db3VudCA9IDM7XG5cdFx0dXRpbHMuZG9tLmVuZm9yY2VTd2F0Y2hSdWxlcyhjb2x1bW5Db3VudCwgMyk7XG5cblx0XHQvLyBnZW5lcmF0ZSB0aGUgYmFzZSBjb2xvclxuXHRcdGNvbnN0IGJhc2VDb2xvciA9IHV0aWxzLmFwcC5nZW5lcmF0ZVJhbmRvbUhTTCgpO1xuXG5cdFx0Ly8gZ2VuZXJhdGUgdGhlIDMgaHVlcyBuZWVkZWRcblx0XHRjb25zdCBodWVzID0gZ2VuZXJhdGVIdWVzLnRyaWFkaWMoYmFzZUNvbG9yLCBjb21tb24pO1xuXG5cdFx0Ly8gY3JlYXRlIFBhbGV0dGVJdGVtIGFycmF5IHdpdGggYXNzaWduZWQgaXRlbUlEc1xuXHRcdGNvbnN0IHBhbGV0dGVJdGVtcyA9IGh1ZXMubWFwKChodWUsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBzYXR1cmF0aW9uU2hpZnQgPVxuXHRcdFx0XHRNYXRoLnJhbmRvbSgpICogcGFsZXR0ZVJhbmdlcy5zaGlmdC50cmlhZC5zYXQgLVxuXHRcdFx0XHRwYWxldHRlUmFuZ2VzLnNoaWZ0LnRyaWFkLnNhdCAvIDI7XG5cdFx0XHRjb25zdCBsaWdodG5lc3NTaGlmdCA9XG5cdFx0XHRcdE1hdGgucmFuZG9tKCkgKiBwYWxldHRlUmFuZ2VzLnNoaWZ0LnRyaWFkLmxpZ2h0IC1cblx0XHRcdFx0cGFsZXR0ZVJhbmdlcy5zaGlmdC50cmlhZC5saWdodCAvIDI7XG5cblx0XHRcdGNvbnN0IG5ld0NvbG9yOiBIU0wgPSB7XG5cdFx0XHRcdHZhbHVlOiB7XG5cdFx0XHRcdFx0aHVlOiB1dGlscy5icmFuZC5hc1JhZGlhbChodWUpLFxuXHRcdFx0XHRcdHNhdHVyYXRpb246IHV0aWxzLmJyYW5kLmFzUGVyY2VudGlsZShcblx0XHRcdFx0XHRcdE1hdGgubWluKFxuXHRcdFx0XHRcdFx0XHQxMDAsXG5cdFx0XHRcdFx0XHRcdE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdFx0XHRcdFx0YmFzZUNvbG9yLnZhbHVlLnNhdHVyYXRpb24gKyBzYXR1cmF0aW9uU2hpZnRcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0bGlnaHRuZXNzOiB1dGlscy5icmFuZC5hc1BlcmNlbnRpbGUoXG5cdFx0XHRcdFx0XHRNYXRoLm1pbihcblx0XHRcdFx0XHRcdFx0MTAwLFxuXHRcdFx0XHRcdFx0XHRNYXRoLm1heChcblx0XHRcdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRcdFx0XHRcdGJhc2VDb2xvci52YWx1ZS5saWdodG5lc3MgKyBsaWdodG5lc3NTaGlmdFxuXHRcdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmb3JtYXQ6ICdoc2wnXG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gdXRpbHMucGFsZXR0ZS5jcmVhdGVQYWxldHRlSXRlbShuZXdDb2xvciwgaW5kZXggKyAxKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiB1dGlscy5wYWxldHRlLmNyZWF0ZVBhbGV0dGVPYmplY3Qob3B0aW9ucywgcGFsZXR0ZUl0ZW1zKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRlcnJvcnMuaGFuZGxlKFxuXHRcdFx0ZXJyb3IsXG5cdFx0XHQnRXJyb3IgZ2VuZXJhdGluZyB0cmlhZGljIHBhbGV0dGUuIFJldHVybmluZyBkZWZhdWx0LicsXG5cdFx0XHR7IG9wdGlvbnM6IG9wdGlvbnMgfVxuXHRcdCk7XG5cdFx0cmV0dXJuIGRhdGEuZGVmYXVsdHMucGFsZXR0ZTtcblx0fVxufVxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVQYWxldHRlRm5Hcm91cDogR2VuZXJhdGVQYWxldHRlRm5Hcm91cCA9IHtcblx0YW5hbG9nb3VzLFxuXHRjb21wbGVtZW50YXJ5LFxuXHRkaWFkaWMsXG5cdGhleGFkaWMsXG5cdG1vbm9jaHJvbWF0aWMsXG5cdHJhbmRvbSxcblx0c3BsaXRDb21wbGVtZW50YXJ5LFxuXHR0ZXRyYWRpYyxcblx0dHJpYWRpY1xufTtcbiJdfQ==