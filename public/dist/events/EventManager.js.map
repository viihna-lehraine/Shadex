{"version":3,"file":"EventManager.js","sources":["../../../../src/events/EventManager.ts"],"sourcesContent":["// File: events/EventManager.js\n\nimport { Services } from '../types/index.js';\n\nexport class EventManager {\n\tstatic #instance: EventManager | null = null;\n\tstatic #listeners: Map<\n\t\tstring,\n\t\t{\n\t\t\telement: Element | Document;\n\t\t\thandler: EventListenerOrEventListenerObject;\n\t\t}\n\t> = new Map();\n\tstatic #errors: Services['errors'];\n\tstatic #log: Services['log'];\n\n\tprivate constructor(services: Services) {\n\t\tEventManager.#errors = services.errors;\n\t\tEventManager.#log = services.log;\n\t}\n\n\tstatic getInstance(services: Services): EventManager {\n\t\tif (!EventManager.#instance) {\n\t\t\tEventManager.#instance = new EventManager(services);\n\t\t}\n\n\t\treturn EventManager.#instance;\n\t}\n\n\tstatic add(\n\t\telement: Element | Document,\n\t\teventType: string,\n\t\thandler: EventListenerOrEventListenerObject\n\t): void {\n\t\tEventManager.#errors.handleSync(() => {\n\t\t\telement.addEventListener(eventType, handler);\n\t\t\tEventManager.#listeners.set(`${eventType}_${handler}`, {\n\t\t\t\telement,\n\t\t\t\thandler\n\t\t\t});\n\t\t}, `Failed to add event listener for ${eventType}`);\n\t}\n\n\tstatic async listAll(): Promise<void> {\n\t\tawait EventManager.#errors.handleAsync(async () => {\n\t\t\tif (!EventManager.#listeners.size) {\n\t\t\t\tEventManager.#log('No active listeners found.', 'info');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconsole.groupCollapsed('üõ†Ô∏è Active Listeners:');\n\t\t\tEventManager.#listeners.forEach(({ element, handler }, key) => {\n\t\t\t\tEventManager.#log(`üõ†Ô∏è Event: ${key.split('_')[0]}`, 'debug');\n\t\t\t\tconsole.log({ element, handler });\n\t\t\t});\n\t\t\tconsole.groupEnd();\n\t\t}, 'Failed to list all event listeners');\n\t}\n\n\tstatic async listByType(eventType: string): Promise<void> {\n\t\tawait EventManager.#errors.handleAsync(async () => {\n\t\t\tconst listeners = Array.from(\n\t\t\t\tEventManager.#listeners.entries()\n\t\t\t).filter(([key]) => key.startsWith(`${eventType}_`));\n\n\t\t\tif (listeners.length === 0) {\n\t\t\t\tEventManager.#log(\n\t\t\t\t\t`No listeners found for event type \"${eventType}\".`,\n\t\t\t\t\t'info'\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconsole.groupCollapsed(`üõ†Ô∏è Event Listeners for: ${eventType}`);\n\t\t\tlisteners.forEach(([_, { element, handler }]) => {\n\t\t\t\tEventManager.#log(`Listener for ${eventType}`, 'debug');\n\t\t\t\tconsole.log({ element, handler });\n\t\t\t});\n\t\t\tconsole.groupEnd();\n\t\t}, `Failed to list event listeners for ${eventType}`);\n\t}\n\n\tstatic async remove(\n\t\telement: Element | Document,\n\t\teventType: string,\n\t\thandler: EventListenerOrEventListenerObject\n\t): Promise<void> {\n\t\tawait EventManager.#errors.handleAsync(async () => {\n\t\t\telement.removeEventListener(eventType, handler);\n\n\t\t\tconst listenerKey = `${eventType}_${handler}`;\n\t\t\tconst wasRemoved = EventManager.#listeners.delete(listenerKey);\n\n\t\t\tif (wasRemoved) {\n\t\t\t\tEventManager.#log(`Removed listener for ${eventType}`, 'info');\n\t\t\t} else {\n\t\t\t\tEventManager.#log(\n\t\t\t\t\t`No matching listener found for ${eventType}`,\n\t\t\t\t\t'warn'\n\t\t\t\t);\n\t\t\t}\n\t\t}, `Failed to remove event listener for ${eventType}`);\n\t}\n\n\tstatic async removeAll(): Promise<void> {\n\t\tawait EventManager.#errors.handleAsync(async () => {\n\t\t\tif (EventManager.#listeners.size === 0) {\n\t\t\t\tEventManager.#log('No active listeners to remove.', 'info');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventManager.#listeners.forEach(({ element, handler }, key) => {\n\t\t\t\tconst [eventType] = key.split('_');\n\t\t\t\telement.removeEventListener(eventType, handler);\n\t\t\t\tEventManager.#log(`Removed listener: ${eventType}`, 'debug');\n\t\t\t});\n\n\t\t\tEventManager.#listeners.clear();\n\t\t\tEventManager.#log('All listeners have been removed.', 'info');\n\t\t}, 'Failed to remove all event listeners');\n\t}\n}\n"],"names":[],"mappings":"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"}