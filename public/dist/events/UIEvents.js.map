{"version":3,"file":"UIEvents.js","sources":["../../../../src/events/UIEvents.ts"],"sourcesContent":["// File: events/UIEvents.js\n\nimport {\n\tDOMElements,\n\tServicesInterface,\n\tUtilitiesInterface\n} from '../types/index.js';\nimport { EventManager } from './EventManager.js';\nimport { PaletteManager } from '../palette/PaletteManager.js';\nimport { data } from '../data/index.js';\n\nconst classes = data.dom.classes;\nconst ids = data.dom.ids;\n\nexport class UIEvents {\n\tprivate log: ServicesInterface['log'];\n\tprivate errors: ServicesInterface['errors'];\n\tprivate elements: DOMElements;\n\n\tconstructor(\n\t\tprivate paletteManager: PaletteManager,\n\t\tprivate services: ServicesInterface,\n\t\tprivate utils: UtilitiesInterface\n\t) {\n\t\tthis.services = services;\n\t\tthis.errors = services.errors;\n\t\tthis.utils = utils;\n\t\tthis.log = this.services.log;\n\t\tthis.paletteManager = paletteManager;\n\n\t\tconst validatedElements = this.utils.dom.getValidatedDOMElements(ids);\n\t\tif (!validatedElements) {\n\t\t\tthrow new Error(\n\t\t\t\t`Critical UI elements not found. Application cannot start`\n\t\t\t);\n\t\t}\n\t\tthis.elements = validatedElements;\n\t}\n\n\tpublic init(): void {\n\t\tthis.errors.handle(\n\t\t\t() => {\n\t\t\t\tEventManager.add(document, 'click', event => {\n\t\t\t\t\tconst target = event.target as HTMLElement;\n\n\t\t\t\t\t// open modal\n\t\t\t\t\tif (target.matches(classes.modalTrigger)) {\n\t\t\t\t\t\tconst modal = this.utils.core.getElement(\n\t\t\t\t\t\t\ttarget.dataset.modalID!\n\t\t\t\t\t\t);\n\t\t\t\t\t\tmodal?.classList.remove(classes.hidden);\n\t\t\t\t\t}\n\n\t\t\t\t\t// close modal when clicking outside\n\t\t\t\t\tif (target.matches(classes.modal)) {\n\t\t\t\t\t\ttarget.classList.add(classes.hidden);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// handle 'Esc' key press to close modals\n\t\t\t\tEventManager.add(document, 'keydown', ((\n\t\t\t\t\tevent: KeyboardEvent\n\t\t\t\t) => {\n\t\t\t\t\tif (event.key === 'Escape') {\n\t\t\t\t\t\tthis.utils.core\n\t\t\t\t\t\t\t.getAllElements(classes.modal)\n\t\t\t\t\t\t\t.forEach(modal =>\n\t\t\t\t\t\t\t\tmodal.classList.add(classes.hidden)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}) as EventListener);\n\t\t\t},\n\t\t\t'Failed to initialize UI events',\n\t\t\t'UIEvents.init'\n\t\t);\n\t}\n\n\tpublic initButtons(): void {\n\t\tthis.errors.handle(\n\t\t\t() => {\n\t\t\t\tconst addButtonEvent = (\n\t\t\t\t\tbutton: HTMLElement | null,\n\t\t\t\t\tlogMessage: string,\n\t\t\t\t\taction?: () => void\n\t\t\t\t) => {\n\t\t\t\t\tif (!button) return;\n\n\t\t\t\t\tEventManager.add(button, 'click', (e: Event) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.log(\n\t\t\t\t\t\t\t'debug',\n\t\t\t\t\t\t\tlogMessage,\n\t\t\t\t\t\t\t'UIEvents.initButtons()',\n\t\t\t\t\t\t\t5\n\t\t\t\t\t\t);\n\t\t\t\t\t\taction?.();\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\taddButtonEvent(\n\t\t\t\t\tthis.elements.btns.desaturate,\n\t\t\t\t\t'Desaturate button clicked',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.log(\n\t\t\t\t\t\t\t'debug',\n\t\t\t\t\t\t\t'Desaturation logic not implemented!',\n\t\t\t\t\t\t\t'UIEvents.initButtons()',\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\taddButtonEvent(\n\t\t\t\t\tthis.elements.btns.export,\n\t\t\t\t\t'Export button clicked',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.log(\n\t\t\t\t\t\t\t'debug',\n\t\t\t\t\t\t\t'Export logic not implemented!',\n\t\t\t\t\t\t\t'UIEvents.initButtons()',\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\taddButtonEvent(\n\t\t\t\t\tthis.elements.btns.generate,\n\t\t\t\t\t'Generate button clicked',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.paletteManager.renderNewPalette();\n\t\t\t\t\t\tthis.log(\n\t\t\t\t\t\t\t'debug',\n\t\t\t\t\t\t\t'New palette generated and rendered',\n\t\t\t\t\t\t\t'UIEvents.initButtons()',\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tEventManager.add(\n\t\t\t\t\tdocument,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.handleWindowClick.bind(this)\n\t\t\t\t);\n\t\t\t},\n\t\t\t'Failed to initialize buttons',\n\t\t\t'UIEvents.initButtons'\n\t\t);\n\t}\n\n\tpublic attachTooltipListener(id: string, tooltipText: string): void {\n\t\tthis.errors.handle(\n\t\t\t() => {\n\t\t\t\tconst element = this.utils.core.getElement(id);\n\t\t\t\tif (!element) return;\n\n\t\t\t\tEventManager.add(element, 'mouseenter', () =>\n\t\t\t\t\tthis.utils.dom.createTooltip(element, tooltipText)\n\t\t\t\t);\n\t\t\t\tEventManager.add(element, 'mouseleave', () =>\n\t\t\t\t\tthis.utils.dom.removeTooltip(element)\n\t\t\t\t);\n\t\t\t},\n\t\t\t`Failed to attach tooltip listener for ${id}`,\n\t\t\t'UIEvents.attachTooltipListener'\n\t\t);\n\t}\n\n\tprivate handleWindowClick(event: Event): void {\n\t\tthis.errors.handle(\n\t\t\t() => {\n\t\t\t\tconst target = event.target as HTMLElement;\n\n\t\t\t\tif (target === this.elements.divs.helpMenu) {\n\t\t\t\t\tthis.elements.divs.helpMenu.classList.add(classes.hidden);\n\t\t\t\t}\n\n\t\t\t\tif (target === this.elements.divs.historyMenu) {\n\t\t\t\t\tthis.elements.divs.historyMenu.classList.add(\n\t\t\t\t\t\tclasses.hidden\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\t'Failed to handle window click',\n\t\t\t'UIEvents.handleWindowClick'\n\t\t);\n\t}\n}\n"],"names":[],"mappings":"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"}