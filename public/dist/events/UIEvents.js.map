{"version":3,"file":"UIEvents.js","sources":["../../../../src/events/UIEvents.ts"],"sourcesContent":["// File: events/UIEvents.ts\n\nimport { DOMElements, Helpers, Services, Utilities } from '../types/index.js';\nimport { EventManager } from './EventManager.js';\nimport { PaletteManager } from '../palette/PaletteManager.js';\nimport { domIndex } from '../config/index.js';\n\nconst classes = domIndex.classes;\n\nexport class UIEvents {\n\t#domStore: Services['domStore'];\n\t#elements: DOMElements;\n\t#errors: Services['errors'];\n\t#helpers: Helpers;\n\t#log: Services['log'];\n\t#utils: Utilities;\n\n\tconstructor(\n\t\thelpers: Helpers,\n\t\tprivate paletteManager: PaletteManager,\n\t\tprivate services: Services,\n\t\tutils: Utilities\n\t) {\n\t\tthis.services = services;\n\t\tthis.#domStore = services.domStore;\n\t\tthis.#errors = services.errors;\n\t\tthis.#helpers = helpers;\n\t\tthis.#log = this.services.log;\n\t\tthis.paletteManager = paletteManager;\n\t\tthis.#utils = utils;\n\n\t\tconst validatedElements = this.#domStore.getElements();\n\t\tif (!validatedElements) {\n\t\t\tthrow new Error(\n\t\t\t\t`Critical UI elements not found. Application cannot start`\n\t\t\t);\n\t\t}\n\t\tthis.#elements = validatedElements;\n\t}\n\n\tinit(): void {\n\t\treturn this.#errors.handleSync(() => {\n\t\t\tEventManager.add(document, 'click', event => {\n\t\t\t\tconst target = event.target as HTMLElement;\n\n\t\t\t\t// open modal\n\t\t\t\tif (target.matches(classes.modalTrigger)) {\n\t\t\t\t\tconst modal = this.#helpers.dom.getElement(\n\t\t\t\t\t\ttarget.dataset.modalID!\n\t\t\t\t\t);\n\t\t\t\t\tmodal?.classList.remove(classes.hidden);\n\t\t\t\t}\n\n\t\t\t\t// close modal when clicking outside\n\t\t\t\tif (target.matches(classes.modal)) {\n\t\t\t\t\ttarget.classList.add(classes.hidden);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// handle 'Esc' key press to close modals\n\t\t\tEventManager.add(document, 'keydown', ((event: KeyboardEvent) => {\n\t\t\t\tif (event.key === 'Escape') {\n\t\t\t\t\tthis.#helpers.dom\n\t\t\t\t\t\t.getAllElements(classes.modal)\n\t\t\t\t\t\t.forEach(modal => modal.classList.add(classes.hidden));\n\t\t\t\t}\n\t\t\t}) as EventListener);\n\t\t}, 'Failed to initialize UI events.');\n\t}\n\n\tinitButtons(): void {\n\t\treturn this.#errors.handleSync(() => {\n\t\t\tconst addButtonEvent = (\n\t\t\t\tbutton: HTMLElement | null,\n\t\t\t\tlogMessage: string,\n\t\t\t\taction?: () => void\n\t\t\t) => {\n\t\t\t\tif (!button) return;\n\n\t\t\t\tEventManager.add(button, 'click', (e: Event) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.#log(logMessage, {\n\t\t\t\t\t\tcaller: '[UIEvents.initButtons]',\n\t\t\t\t\t\tlevel: 'debug'\n\t\t\t\t\t});\n\t\t\t\t\taction?.();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\taddButtonEvent(\n\t\t\t\tthis.#elements.btns.desaturate,\n\t\t\t\t'Desaturate button clicked',\n\t\t\t\t() => {\n\t\t\t\t\tthis.#log('Desaturation logic not implemented!', {\n\t\t\t\t\t\tcaller: '[UIEvents.initButtons]',\n\t\t\t\t\t\tlevel: 'warn'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\n\t\t\taddButtonEvent(\n\t\t\t\tthis.#elements.btns.export,\n\t\t\t\t'Export button clicked',\n\t\t\t\t() => {\n\t\t\t\t\tthis.#log('Export logic not implemented!', {\n\t\t\t\t\t\tcaller: '[UIEvents.initButtons]',\n\t\t\t\t\t\tlevel: 'warn'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\n\t\t\taddButtonEvent(\n\t\t\t\tthis.#elements.btns.generate,\n\t\t\t\t'Generate button clicked',\n\t\t\t\t() => {\n\t\t\t\t\tthis.paletteManager.renderNewPalette();\n\t\t\t\t\tthis.#log('New palette generated and rendered', {\n\t\t\t\t\t\tcaller: '[UIEvents.initButtons]',\n\t\t\t\t\t\tlevel: 'debug'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tEventManager.add(\n\t\t\t\tdocument,\n\t\t\t\t'click',\n\t\t\t\tthis.handleWindowClick.bind(this)\n\t\t\t);\n\t\t}, 'Failed to initialize buttons.');\n\t}\n\n\tattachTooltipListener(id: string, tooltipText: string): void {\n\t\treturn this.#errors.handleSync(() => {\n\t\t\tconst element = this.#helpers.dom.getElement(id);\n\t\t\tif (!element) return;\n\n\t\t\tEventManager.add(element, 'mouseenter', () =>\n\t\t\t\tthis.#utils.dom.createTooltip(element, tooltipText)\n\t\t\t);\n\t\t\tEventManager.add(element, 'mouseleave', () =>\n\t\t\t\tthis.#utils.dom.removeTooltip(element)\n\t\t\t);\n\t\t}, `Failed to attach tooltip listener for ${id}.`);\n\t}\n\n\tprivate handleWindowClick(event: Event): void {\n\t\treturn this.#errors.handleSync(() => {\n\t\t\tconst target = event.target as HTMLElement;\n\n\t\t\tif (target === this.#elements.divs.helpMenu) {\n\t\t\t\tthis.#elements.divs.helpMenu.classList.add(classes.hidden);\n\t\t\t}\n\n\t\t\tif (target === this.#elements.divs.historyMenu) {\n\t\t\t\tthis.#elements.divs.historyMenu.classList.add(classes.hidden);\n\t\t\t}\n\t\t}, 'Failed to handle window click.');\n\t}\n}\n"],"names":[],"mappings":"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"}